/*! 
 * Seed CSS (seed-css) 
 * A light-weight and mobile first CSS boilerplate. 
 * @author Rogerio Taques (hello@abtz.co) 
 * @copyright 2016-2019, Rogerio Taques (hello@abtz.co) 
 * @license MIT 
 * @version 2.2.1 
 */ 

 "use strict";!function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}return"function"!=typeof window.CustomEvent&&(t.prototype=window.Event.prototype,void(window.CustomEvent=t))}();
"use strict";var seedFileUpload=function(){var e=function(e){e&&e.preventDefault();var t,i=!1,n=this,l=n.nextElementSibling;n.files&&n.files.length>1?i=(n.getAttribute("data-multiple")||"{count} files").replace("{count}",n.files.length):n.value.trim().length>0&&(i=n.value.split("\\").pop()),i&&(l.querySelector(".input").innerHTML=i),""!==n.value&&(t=new CustomEvent("file.chosen"),n.parentNode.classList.add("chosen"),n.dispatchEvent(t))},t=document.querySelectorAll('.seed-file > [type="file"]');null!==t&&t.forEach(function(t,i){var n=t.nextElementSibling,l=n.querySelector(".cancel"),r=t.getAttribute("data-empty")||"No file chosen";n&&(t.getAttribute("id")&&t.getAttribute("id")!==n.getAttribute("for")?n.setAttribute("for",t.getAttribute("id")):n.getAttribute("for")&&!t.getAttribute("id")?t.setAttribute("id",n.getAttribute("for")):(t.setAttribute("id","file-input-"+i),n.setAttribute("for","file-input-"+i)),l&&l.addEventListener("click",function(e){e&&e.preventDefault();var i=t.getAttribute("data-empty")||"No file chosen";t.value="",t.parentNode.classList.remove("chosen"),n.querySelector(".input").innerHTML=i,seedCustomEvent=new CustomEvent("file.removed"),t.dispatchEvent(seedCustomEvent)}),n.querySelector(".input").innerHTML=r,t.addEventListener("change",e))})};"undefined"!=typeof module?module.exports.fileUpload=fileUpload:("undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.fileUpload=seedFileUpload);
"use strict";var fnOpen,fnClose,fnEsc,seedModal=function(e){var n={trigger:'[role="modal"]',classAnimation:{open:"bounceInDown",close:"bounceOutUp"}};e=Object.assign({},n,e);var o=document.querySelectorAll(".modal"),t=document.querySelectorAll(e.trigger);return fnClose=function(n){if(n){var o,t=document.querySelector("html"),s=n.querySelector(".modal-window");s&&(document.removeEventListener("keydown",fnEsc),s.classList.replace(e.classAnimation.open,e.classAnimation.close),n.classList.add("delay-1s"),n.classList.replace("fadeIn","fadeOut"),setTimeout(function(){o=new CustomEvent("modal.closed"),n.dispatchEvent(o),n.classList.add("hide"),t.style.overflow="",n.classList.remove("delay-1s","fadeOut"),s.classList.replace(e.classAnimation.close,e.classAnimation.open)},600))}},fnOpen=function(n){if(n){var o,t=document.querySelector("html"),s=n.querySelector(".modal-window");fnEsc=function(e){var o=e.keyCode||e.which;27===o&&fnClose(n)},s&&(document.addEventListener("keydown",fnEsc),n.style.display="",n.classList.add("animated","fadeIn","fast"),s.classList.add("animated",e.classAnimation.open),n.classList.remove("hide"),t.style.overflow="hidden",setTimeout(function(){o=new CustomEvent("modal.opened"),n.dispatchEvent(o)},100))}},null!==o&&o.forEach(function(e,n){var o=e.querySelectorAll('[role="modal-dismiss"]');e.addEventListener("click",function(){fnClose(e)}),e.show=function(){fnOpen(e)},e.hide=function(){fnClose(e)},null!==o&&o.forEach(function(n,o){n.addEventListener("click",function(n){n&&(n.preventDefault(),n.stopPropagation()),fnClose(e)})})}),null!==t&&t.forEach(function(e,n){e.addEventListener("click",function(n){n&&n.preventDefault();var o=e.getAttribute("data-modal-id");if(null!==o){var t=document.querySelector("#".concat(o));fnOpen(t)}})}),t=void 0,{get:function(e){if("string"==typeof e){var n=!1;return o.forEach(function(o){if(o.id===e.replace(/^#/,""))return void(n=o)}),n}return"undefined"!=typeof o[e]&&o[e]}}};"undefined"!=typeof module?module.exports.seedModal=seedModal:("undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.modal=seedModal);
"use strict";var seedOffCanvas=function(){var e=function(e,n){var t,o=document.querySelector("#".concat(e.replace(/^#/,""))),a=n||document.querySelector('[role="offcanvas"][data-id="'.concat(e.replace(/^#/,""),'"]'));null!==o&&(o.classList.toggle("open"),o.classList.contains("open")?(null!==a&&a.classList.add("triggered"),document.querySelector("html").style.overflow="hidden"):(document.querySelectorAll('[role="offcanvas"][data-id="'.concat(e.replace(/^#/,""),'"]')).forEach(function(e){e.classList.remove("triggered")}),document.querySelector("html").style.overflow=""),setTimeout(function(){t=o.classList.contains("open")?new CustomEvent("canvas.opened"):new CustomEvent("canvas.closed"),o.dispatchEvent(t)},300))},n=function(n){n&&n.preventDefault(),e(n.currentTarget.getAttribute("data-id")||"offcanvas",n.currentTarget)},t=document.querySelectorAll('[role="offcanvas"]'),o=document.querySelectorAll(".offcanvas");return null!==t&&t.forEach(function(e,t){e.addEventListener("click",n)}),null!==o&&o.forEach(function(n,t){n.open=function(){e(n.getAttribute("id")||"offcanvas")},n.close=function(){}}),{get:function(e){if("string"==typeof e){var n=!1;return o.forEach(function(t){if(t.id===e.replace(/^#/,""))return void(n=t)}),n}return"undefined"!=typeof canvas[e]&&canvas[e]}}};"undefined"!=typeof module?module.exports.seedOffCanvas=seedOffCanvas:("undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.offCanvas=seedOffCanvas);
"use strict";var seedScroll=function(e){var t=null,n=null,o=0,i={spyScrollSelector:"nav a.smooth",revealElementSelector:".reveal",revealSpaceOffset:.2,revealWhenVisible:"visible",revealSingleAnimation:"visible-once",revealWhenHidden:"hidden",gutter:50},l=function(e){t.forEach(function(e){e.classList.remove("active")}),e&&e.classList.add("active")},r=function(e){var t=document.body.getBoundingClientRect(),n=e.getBoundingClientRect();return{top:Math.ceil(n.top-t.top),left:Math.ceil(n.left-t.left)}},c=function(n){if(window.scrollY===o){var i=new CustomEvent("scroll.complete");document.dispatchEvent(i)}if(t){var c=r(t[0]);window.scrollY<c.top&&l(),t.forEach(function(t,n){try{var o=t.getAttribute("href")||t.getAttribute("data-target"),i=document.querySelector(o),c=r(i);if(c.top-e.gutter<=window.scrollY)return void l(t)}catch(d){}})}"function"==typeof window.oldOnscroll&&window.oldOnscroll(n)},d=function(t){t&&t.preventDefault();var n=t.currentTarget.getAttribute("href")||t.currentTarget.getAttribute("data-target");if(n){var i=document.querySelector(n);o=r(i).top-e.gutter,window.scrollTo({behavior:"smooth",left:0,top:o})}},a=function(){var t=function(){return{width:window.document.documentElement.clientWidth,height:window.document.documentElement.clientHeight}},o=function(){return{x:window.pageXOffset,y:window.pageYOffset}},i=function(e){var t=e,n=0,o=0,i=t.offsetWidth,l=t.offsetHeight;do isNaN(t.offsetTop)||(n+=t.offsetTop),isNaN(t.offsetLeft)||(o+=t.offsetLeft);while(null!==(t=t.offsetParent));return{top:n,left:o,height:l,width:i}},l=function(n){var l=t(),r=o(),c=i(n),d=e.revealSpaceOffset,a=function(){var e=c.top+c.height*d,t=c.left+c.width*d,n=c.left+c.width-c.width*d,o=c.top+c.height-c.height*d,i=r.y+0,a=r.x+0,s=r.y-0+l.height,f=r.x-0+l.width;return e<s&&o>i&&t>a&&n<f};return a()},r=function(){if(n)for(var t=0;t<n.length;t+=1)l(n[t])?(e.revealWhenVisible&&n[t].classList.add(e.revealWhenVisible),e.revealWhenHidden&&n[t].classList.remove(e.revealWhenHidden)):n[t].classList.contains(e.revealSingleAnimation)===!1&&(e.revealWhenHidden&&n[t].classList.add(e.revealWhenHidden),e.revealWhenVisible&&n[t].classList.remove(e.revealWhenVisible))},c=function(e){r()};window.addEventListener("scroll",c,!1),window.addEventListener("resize",c,!1)};return window.oldOnscroll=window.onscroll,window.onscroll=c,e=Object.assign({},i,e),t=document.querySelectorAll(e.spyScrollSelector),n=document.querySelectorAll(e.revealElementSelector),null!==t&&t.forEach(function(e,t){e.addEventListener("click",d)}),n&&a(),{}};"undefined"!=typeof module?module.exports.seedScroll=seedScroll:("undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.scroll=seedScroll);
"use strict";var seedTextarea=function(){var e=document.querySelectorAll(".field > textarea");null!==e&&e.forEach(function(e,t){var a=0,r=e.parentNode,n=r.querySelector('[role="counter"]'),o=n.getAttribute("data-template")||"Typed %a out of %b. Remaining %c.",d=function(){var t=e.value.replace(/[\n\r]/g,"").length,r=a-t,d=Math.floor(.1*a);n.innerHTML=o.replace("%a",t).replace("%b",a).replace("%c",r<=d?'<span class="red" >'.concat(r,"</span>"):r)};a=e.getAttribute("maxlength"),a&&(a=parseInt(a),"keypress keydown keyup".split(" ").forEach(function(t){e.addEventListener(t,d,!0)}),d())})};"undefined"!=typeof module?module.exports.seedTextarea=seedTextarea:("undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.textArea=seedTextarea);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbUV2ZW50UG9seWZpbGwuanMiLCJzZWVkRmlsZVVwbG9hZC5qcyIsInNlZWRNb2RhbC5qcyIsInNlZWRPZmZDYW52YXMuanMiLCJzZWVkU2Nyb2xsLmpzIiwic2VlZFRleHRhcmVhLmpzIl0sIm5hbWVzIjpbIkN1c3RvbUV2ZW50IiwiZXZlbnQiLCJwYXJhbXMiLCJidWJibGVzIiwiY2FuY2VsYWJsZSIsImRldGFpbCIsInVuZGVmaW5lZCIsImV2dCIsImRvY3VtZW50IiwiY3JlYXRlRXZlbnQiLCJpbml0Q3VzdG9tRXZlbnQiLCJ3aW5kb3ciLCJwcm90b3R5cGUiLCJFdmVudCIsInNlZWRGaWxlVXBsb2FkIiwiZm5DaGFuZ2UiLCJwcmV2ZW50RGVmYXVsdCIsInNlZWRDdXN0b21FdmVudCIsImZpbGVOYW1lIiwiaW5wdXQiLCJ0aGlzIiwibGFiZWwiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJmaWxlcyIsImxlbmd0aCIsImdldEF0dHJpYnV0ZSIsInJlcGxhY2UiLCJ2YWx1ZSIsInRyaW0iLCJzcGxpdCIsInBvcCIsInF1ZXJ5U2VsZWN0b3IiLCJpbm5lckhUTUwiLCJwYXJlbnROb2RlIiwiY2xhc3NMaXN0IiwiYWRkIiwiZGlzcGF0Y2hFdmVudCIsImlucHV0cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiaSIsImNhbmNlbCIsImVtcHR5VGV4dCIsInNldEF0dHJpYnV0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmUiLCJtb2R1bGUiLCJleHBvcnRzIiwiZmlsZVVwbG9hZCIsIlNlZWRDU1MiLCJmbk9wZW4iLCJmbkNsb3NlIiwiZm5Fc2MiLCJzZWVkTW9kYWwiLCJvcHRpb25zIiwiZGVmYXVsdE9wdGlvbnMiLCJ0cmlnZ2VyIiwiY2xhc3NBbmltYXRpb24iLCJvcGVuIiwiY2xvc2UiLCJPYmplY3QiLCJhc3NpZ24iLCJtb2RhbHMiLCJtb2RhbFRyaWdnZXJzIiwibW9kYWxPYmplY3QiLCJjdXN0b21FdmVudCIsImh0bWwiLCJtV2luIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldFRpbWVvdXQiLCJzdHlsZSIsIm92ZXJmbG93IiwiZSIsImtleSIsImtleUNvZGUiLCJ3aGljaCIsImRpc3BsYXkiLCJtb2RhbCIsImRpc21pc3NhbHMiLCJzaG93IiwiaGlkZSIsImRpc21pc3MiLCJqIiwic3RvcFByb3BhZ2F0aW9uIiwicmVmIiwiY29uY2F0IiwiZ2V0IiwiaWR4Iiwibm9kZSIsImlkIiwic2VlZE9mZkNhbnZhcyIsImZuVG9nZ2xlIiwiY2FudmFzSUQiLCJ0cmlnZ2VyRWxlbWVudCIsImNhbnZhcyIsInRvZ2dsZSIsImNvbnRhaW5zIiwidGdyIiwiZm5UcmlnZ2VyQ2xpY2siLCJjdXJyZW50VGFyZ2V0IiwidHJpZ2dlcnMiLCJjYW52YXNlcyIsIm9mZkNhbnZhcyIsInNlZWRTY3JvbGwiLCJyZXZlYWxlcnMiLCJzY3JvbGxUYXJnZXQiLCJzcHlTY3JvbGxTZWxlY3RvciIsInJldmVhbEVsZW1lbnRTZWxlY3RvciIsInJldmVhbFNwYWNlT2Zmc2V0IiwicmV2ZWFsV2hlblZpc2libGUiLCJyZXZlYWxTaW5nbGVBbmltYXRpb24iLCJyZXZlYWxXaGVuSGlkZGVuIiwiZ3V0dGVyIiwiZm5VcGRhdGVBY3RpdmVUcmlnZ2VyIiwiZWxlbSIsImVsIiwiZm5HZXRPZmZzZXQiLCJib2R5T2Zmc2V0IiwiYm9keSIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsIm9mZnNldCIsInRvcCIsIk1hdGgiLCJjZWlsIiwibGVmdCIsImZuU2Nyb2xsQ29tcGxldGUiLCJzY3JvbGxZIiwiZmlyc3RFbGVtZW50T2Zmc2V0IiwidGFyZ2V0SUQiLCJ0YXJnZXQiLCJvbGRPbnNjcm9sbCIsInNjcm9sbFRvIiwiYmVoYXZpb3IiLCJmbldhdGNoRWxlbWVudHMiLCJnZXRWaWV3cG9ydFNpemUiLCJ3aWR0aCIsImRvY3VtZW50RWxlbWVudCIsImNsaWVudFdpZHRoIiwiaGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwiZ2V0Q3VycmVudFNjcm9sbCIsIngiLCJwYWdlWE9mZnNldCIsInkiLCJwYWdlWU9mZnNldCIsImdldEVsZW1JbmZvIiwib2Zmc2V0VG9wIiwib2Zmc2V0TGVmdCIsIm9mZnNldFdpZHRoIiwib2Zmc2V0SGVpZ2h0IiwiaXNOYU4iLCJvZmZzZXRQYXJlbnQiLCJpc0VsZW1lbnRWaXNpYmxlIiwidmlld3BvcnRTaXplIiwiY3VycmVudFNjcm9sbCIsImVJbmYiLCJzcGFjZU9mZnNldCIsImNoZWNrQm91bmRhcmllcyIsImVUb3AiLCJlTGVmdCIsImVSaWdodCIsImVCb3R0b20iLCJ3VG9wIiwid0xlZnQiLCJ3Qm90dG9tIiwid1JpZ2h0IiwidG9nZ2xlRWxlbWVudCIsInNjcm9sbFJlc2l6ZUhhbmRsZXIiLCJvbnNjcm9sbCIsInNjcm9sbCIsInNlZWRUZXh0YXJlYSIsIm1heExlbmd0aCIsInBhcmVudCIsImNvdW50ZXJMYWJlbCIsInRlbXBsYXRlIiwiZm5DYWxjIiwidHlwZWQiLCJyZW1haW5pbmciLCJtaW5MZW5ndGgiLCJmbG9vciIsInBhcnNlSW50IiwidGV4dEFyZWEiXSwibWFwcGluZ3MiOiJBQUFBLGNBS0EsV0FHRSxRQUFTQSxHQUFZQyxFQUFPQyxHQUMxQkEsRUFBU0EsSUFBWUMsU0FBUyxFQUFPQyxZQUFZLEVBQU9DLE9BQVFDLE9BQ2hFLElBQUlDLEdBQU1DLFNBQVNDLFlBQVksY0FPL0IsT0FOQUYsR0FBSUcsZ0JBQ0ZULEVBQ0FDLEVBQU9DLFFBQ1BELEVBQU9FLFdBQ1BGLEVBQU9HLFFBRUZFLEVBWFQsTUFBa0Msa0JBQXZCSSxRQUFPWCxjQWNsQkEsRUFBWVksVUFBWUQsT0FBT0UsTUFBTUQsZUFFckNELE9BQU9YLFlBQWNBO0FDdEJ2QixZQU1BLElBQU1jLGdCQUFpQixXQUdyQixHQUFNQyxHQUFXLFNBQWtCUixHQUM3QkEsR0FDRkEsRUFBSVMsZ0JBR04sSUFBSUMsR0FDQUMsR0FBVyxFQUVUQyxFQUFRQyxLQUNSQyxFQUFRRixFQUFNRyxrQkFHaEJILEdBQU1JLE9BQVNKLEVBQU1JLE1BQU1DLE9BQVMsRUFDdENOLEdBQ0VD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LGNBQWMsb0JBQ3BDK0ksRUFDSkQsRUFBYXBKLGFBQWEsa0JBQzFCLG9DQUVJc0osRUFBUyxXQUNiLEdBQU1DLEdBQVE3SixFQUFNUSxNQUFNRCxRQUFRLFVBQVcsSUFBSUYsT0FDM0N5SixFQUFZTixFQUFZSyxFQUN4QkUsRUFBWXhELEtBQUt5RCxNQUFrQixHQUFaUixFQUU3QkUsR0FBYTdJLFVBQVk4SSxFQUN0QnBKLFFBQVEsS0FBTXNKLEdBQ2R0SixRQUFRLEtBQU1pSixHQUNkakosUUFDQyxLQUNBdUosR0FBYUMsRUFBYixzQkFBQTdGLE9BQzBCNEYsRUFEMUIsV0FFSUEsR0FJVk4sR0FBWXhKLEVBQU1NLGFBQWEsYUFHMUJrSixJQUtMQSxFQUFZUyxTQUFTVCxHQUdyQix5QkFBeUI5SSxNQUFNLEtBQUtVLFFBQVEsU0FBQ2hDLEdBQzNDWSxFQUFNeUIsaUJBQWlCckMsRUFBS3dLLEdBQVEsS0FJdENBLE9BS2dCLG9CQUFYakksUUFDVEEsT0FBT0MsUUFBUTJILGFBQWVBLGNBRUEsbUJBQW5CL0osUUFBT3NDLFVBQ2hCdEMsT0FBT3NDLFlBR1R0QyxPQUFPc0MsUUFBUW9JLFNBQVdYIiwiZmlsZSI6InNlZWRjc3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiohXG4gKiBBIHNpbXBsZSBwb2x5ZmlsbCBmb3IgQ3VzdG9tRXZlbnRcbiAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0N1c3RvbUV2ZW50L0N1c3RvbUV2ZW50I1BvbHlmaWxsXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgaWYgKHR5cGVvZiB3aW5kb3cuQ3VzdG9tRXZlbnQgPT09ICdmdW5jdGlvbicpIHJldHVybiBmYWxzZTtcblxuICBmdW5jdGlvbiBDdXN0b21FdmVudChldmVudCwgcGFyYW1zKSB7XG4gICAgcGFyYW1zID0gcGFyYW1zIHx8IHsgYnViYmxlczogZmFsc2UsIGNhbmNlbGFibGU6IGZhbHNlLCBkZXRhaWw6IHVuZGVmaW5lZCB9O1xuICAgIHZhciBldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTtcbiAgICBldnQuaW5pdEN1c3RvbUV2ZW50KFxuICAgICAgZXZlbnQsXG4gICAgICBwYXJhbXMuYnViYmxlcyxcbiAgICAgIHBhcmFtcy5jYW5jZWxhYmxlLFxuICAgICAgcGFyYW1zLmRldGFpbFxuICAgICk7XG4gICAgcmV0dXJuIGV2dDtcbiAgfVxuXG4gIEN1c3RvbUV2ZW50LnByb3RvdHlwZSA9IHdpbmRvdy5FdmVudC5wcm90b3R5cGU7XG5cbiAgd2luZG93LkN1c3RvbUV2ZW50ID0gQ3VzdG9tRXZlbnQ7XG59KSgpO1xuIiwiLyoqIVxuICogU2VlZC1DU1MgLSBDdXN0b20gSFRNTCBJbnB1dCBGaWxlLlxuICogQGNvcHlyaWdodCAyMDE5LCBBYnR6IExhYnNcbiAqIEBsaWNlbnNlIE1JVFxuICovXG5cbmNvbnN0IHNlZWRGaWxlVXBsb2FkID0gZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBjb25zdCBmbkNoYW5nZSA9IGZ1bmN0aW9uIGZuQ2hhbmdlKGV2dCkge1xuICAgIGlmIChldnQpIHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cblxuICAgIGxldCBzZWVkQ3VzdG9tRXZlbnQ7XG4gICAgbGV0IGZpbGVOYW1lID0gZmFsc2U7XG5cbiAgICBjb25zdCBpbnB1dCA9IHRoaXM7XG4gICAgY29uc3QgbGFiZWwgPSBpbnB1dC5uZXh0RWxlbWVudFNpYmxpbmc7XG5cbiAgICAvLyBXaGVuIG11bHRpcGxlIGZpbGVzIGFyZSBzZWxlY3RlZFxuICAgIGlmIChpbnB1dC5maWxlcyAmJiBpbnB1dC5maWxlcy5sZW5ndGggPiAxKSB7XG4gICAgICBmaWxlTmFtZSA9IChcbiAgICAgICAgaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLW11bHRpcGxlJykgfHwgJ3tjb3VudH0gZmlsZXMnXG4gICAgICApLnJlcGxhY2UoJ3tjb3VudH0nLCBpbnB1dC5maWxlcy5sZW5ndGgpO1xuICAgIH1cblxuICAgIC8vIFdoZW4gb25seSBvbmUgZmlsZSBpcyBzZWxlY3RlZFxuICAgIGVsc2UgaWYgKGlucHV0LnZhbHVlLnRyaW0oKS5sZW5ndGggPiAwKSB7XG4gICAgICBmaWxlTmFtZSA9IGlucHV0LnZhbHVlLnNwbGl0KCdcXFxcJykucG9wKCk7XG4gICAgfVxuXG4gICAgaWYgKGZpbGVOYW1lKSB7XG4gICAgICBsYWJlbC5xdWVyeVNlbGVjdG9yKCcuaW5wdXQnKS5pbm5lckhUTUwgPSBmaWxlTmFtZTtcbiAgICB9XG5cbiAgICBpZiAoaW5wdXQudmFsdWUgIT09ICcnKSB7XG4gICAgICBzZWVkQ3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2ZpbGUuY2hvc2VuJyk7XG4gICAgICBpbnB1dC5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ2Nob3NlbicpO1xuICAgICAgaW5wdXQuZGlzcGF0Y2hFdmVudChzZWVkQ3VzdG9tRXZlbnQpO1xuICAgIH1cbiAgfTsgLy8gZm5DaGFuZ2VcblxuICAvLyBGaW5kIGFsbCBzZWVkLWZpbGUgaW5wdXRzLlxuICBjb25zdCBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2VlZC1maWxlID4gW3R5cGU9XCJmaWxlXCJdJyk7XG5cbiAgaWYgKGlucHV0cyAhPT0gbnVsbCkge1xuICAgIGlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uKGlucHV0LCBpKSB7XG4gICAgICAvLyBGaW5kIHRoZSBmaWVsZCBsYWJlbFxuICAgICAgY29uc3QgbGFiZWwgPSBpbnB1dC5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgICBjb25zdCBjYW5jZWwgPSBsYWJlbC5xdWVyeVNlbGVjdG9yKCcuY2FuY2VsJyk7XG4gICAgICBjb25zdCBlbXB0eVRleHQgPSBpbnB1dC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZW1wdHknKSB8fCAnTm8gZmlsZSBjaG9zZW4nO1xuXG4gICAgICAvLyBJZiBsYWJlbCBkb2VzIG5vdCBleGlzdHMsIHNpbXBseSBkbyBub3Qgc2V0IGl0IHVwXG4gICAgICBpZiAoIWxhYmVsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gTWFrZSBzdXJlIGlucHV0IGFuZCBsYWJlbCBtYXRjaGVzIGFuZCB3b3Jrcy5cbiAgICAgIGlmIChcbiAgICAgICAgaW5wdXQuZ2V0QXR0cmlidXRlKCdpZCcpICYmXG4gICAgICAgIGlucHV0LmdldEF0dHJpYnV0ZSgnaWQnKSAhPT0gbGFiZWwuZ2V0QXR0cmlidXRlKCdmb3InKVxuICAgICAgKSB7XG4gICAgICAgIGxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgaW5wdXQuZ2V0QXR0cmlidXRlKCdpZCcpKTtcbiAgICAgIH0gZWxzZSBpZiAobGFiZWwuZ2V0QXR0cmlidXRlKCdmb3InKSAmJiAhaW5wdXQuZ2V0QXR0cmlidXRlKCdpZCcpKSB7XG4gICAgICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnaWQnLCBsYWJlbC5nZXRBdHRyaWJ1dGUoJ2ZvcicpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnaWQnLCAnZmlsZS1pbnB1dC0nICsgaSk7XG4gICAgICAgIGxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgJ2ZpbGUtaW5wdXQtJyArIGkpO1xuICAgICAgfVxuXG4gICAgICAvLyBBbHdheXMgdGhlIGNhbmNlbCBidXR0b24gZXhpc3RzLCBhZGRzIGEgaGFuZGxlclxuICAgICAgaWYgKGNhbmNlbCkge1xuICAgICAgICBjYW5jZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgaWYgKGV2dCkge1xuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgZW1wdHlUZXh0ID1cbiAgICAgICAgICAgIGlucHV0LmdldEF0dHJpYnV0ZSgnZGF0YS1lbXB0eScpIHx8ICdObyBmaWxlIGNob3Nlbic7XG5cbiAgICAgICAgICBpbnB1dC52YWx1ZSA9ICcnO1xuICAgICAgICAgIGlucHV0LnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnY2hvc2VuJyk7XG4gICAgICAgICAgbGFiZWwucXVlcnlTZWxlY3RvcignLmlucHV0JykuaW5uZXJIVE1MID0gZW1wdHlUZXh0O1xuXG4gICAgICAgICAgc2VlZEN1c3RvbUV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdmaWxlLnJlbW92ZWQnKTtcbiAgICAgICAgICBpbnB1dC5kaXNwYXRjaEV2ZW50KHNlZWRDdXN0b21FdmVudCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBsYWJlbC5xdWVyeVNlbGVjdG9yKCcuaW5wdXQnKS5pbm5lckhUTUwgPSBlbXB0eVRleHQ7XG5cbiAgICAgIC8vIFN0YXJ0IGxpc3RlbmluZyB0aGUgZmllbGQgZm9yIGNoYW5nZXNcbiAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZuQ2hhbmdlKTtcbiAgICB9KTsgLy8gaW5wdXRzLmZvckVhY2goZnVuY3Rpb24oaW5wdXQsIGkpXG4gIH0gLy8gaWYgKGlucHV0cyAhPT0gbnVsbClcbn07IC8vIHNlZWRGaWxlVXBsb2FkXG5cbmlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xuICBtb2R1bGUuZXhwb3J0cy5maWxlVXBsb2FkID0gZmlsZVVwbG9hZDtcbn0gZWxzZSB7XG4gIGlmICh0eXBlb2Ygd2luZG93LlNlZWRDU1MgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgd2luZG93LlNlZWRDU1MgPSB7fTtcbiAgfVxuXG4gIHdpbmRvdy5TZWVkQ1NTLmZpbGVVcGxvYWQgPSBzZWVkRmlsZVVwbG9hZDtcbn1cbiIsIi8qKiFcbiAqIFNlZWQtQ1NTIC0gTW9kYWxcbiAqIEBjb3B5cmlnaHQgMjAxOSwgQWJ0eiBMYWJzXG4gKiBAbGljZW5zZSBNSVRcbiAqL1xuXG5sZXQgZm5PcGVuO1xuXG5sZXQgZm5DbG9zZTtcblxubGV0IGZuRXNjO1xuXG5jb25zdCBzZWVkTW9kYWwgPSAob3B0aW9ucykgPT4ge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLy8gRGVmYXVsdCBzZXR0aW5nc1xuICBjb25zdCBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAvLyB0aGUgZWxlbWVudCB0aGF0IHRyaWdnZXJzIHRoZSBtb2RhbFxuICAgIHRyaWdnZXI6ICdbcm9sZT1cIm1vZGFsXCJdJyxcblxuICAgIC8vIEBzZWU6IGh0dHBzOi8vZGFuZWRlbi5naXRodWIuaW8vYW5pbWF0ZS5jc3MvXG4gICAgLy8gYW5pbWF0ZS5jc3MgY2xhc3NlcyB0byBiZSB1c2VkXG4gICAgY2xhc3NBbmltYXRpb246IHtcbiAgICAgIG9wZW46ICdib3VuY2VJbkRvd24nLFxuICAgICAgY2xvc2U6ICdib3VuY2VPdXRVcCdcbiAgICB9XG4gIH07XG5cbiAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcblxuICAvLyBHZXQgZWxlbWVudHNcbiAgbGV0IG1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RhbCcpO1xuICBsZXQgbW9kYWxUcmlnZ2VycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwob3B0aW9ucy50cmlnZ2VyKTtcblxuICBmbkNsb3NlID0gKG1vZGFsT2JqZWN0KSA9PiB7XG4gICAgaWYgKCFtb2RhbE9iamVjdCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCBjdXN0b21FdmVudDtcbiAgICBjb25zdCBodG1sID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaHRtbCcpO1xuICAgIGNvbnN0IG1XaW4gPSBtb2RhbE9iamVjdC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtd2luZG93Jyk7XG5cbiAgICBpZiAoIW1XaW4pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBSZW1vdmVzIHRoZSBFU0MgbGlzdGVuZXJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZm5Fc2MpO1xuXG4gICAgLy8gUmVwbGFjZSBvcGVuIGFuaW1hdGlvbiB0byBjbG9zZSB0aGUgbW9kYWwgd2luZG93XG4gICAgbVdpbi5jbGFzc0xpc3QucmVwbGFjZShcbiAgICAgIG9wdGlvbnMuY2xhc3NBbmltYXRpb24ub3BlbixcbiAgICAgIG9wdGlvbnMuY2xhc3NBbmltYXRpb24uY2xvc2VcbiAgICApO1xuXG4gICAgLy8gQWRkIGFuaW1hdGlvbiB0byB0aGUgb3ZlcmxheVxuICAgIG1vZGFsT2JqZWN0LmNsYXNzTGlzdC5hZGQoJ2RlbGF5LTFzJyk7XG4gICAgbW9kYWxPYmplY3QuY2xhc3NMaXN0LnJlcGxhY2UoJ2ZhZGVJbicsICdmYWRlT3V0Jyk7XG5cbiAgICAvLyBXYWl0IDIgc2Vjb25kcyBiZWZvcmUgY29tcGxldGUgZGUgcHJvY2Vzcy5cbiAgICAvLyBUaGlzIGlzIHRoZSB0aW1lIHRvIGZpbmlzaGluZyBhbGwgYW5pbWF0ZS5jc3MgYW5pbWF0aW9uc1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgLy8gRGlzcGF0Y2ggdGhlICdtb2RhbC5jbG9zZWQnIGV2ZW50XG4gICAgICBjdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudCgnbW9kYWwuY2xvc2VkJyk7XG4gICAgICBtb2RhbE9iamVjdC5kaXNwYXRjaEV2ZW50KGN1c3RvbUV2ZW50KTtcblxuICAgICAgLy8gQ29tcGxldGVseSBoaWRlIHRoZSBjb21wb25lbnRcbiAgICAgIG1vZGFsT2JqZWN0LmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcbiAgICAgIC8vIFJlZW5hYmxlIHNjcm9sbGluZyBmcm9tIHRoZSBIVE1MXG4gICAgICBodG1sLnN0eWxlLm92ZXJmbG93ID0gJyc7XG4gICAgICAvLyBSZW1vdmUgY2xvc2luZyBjbGFzc2VzIGZyb20gb3ZlcmxheVxuICAgICAgbW9kYWxPYmplY3QuY2xhc3NMaXN0LnJlbW92ZSgnZGVsYXktMXMnLCAnZmFkZU91dCcpO1xuICAgICAgLy8gUmVtb3ZlIGNsb3NpbmcgY2xhc3NlcyBmcm9tIG1vZGFsIHdpbmRvd1xuICAgICAgbVdpbi5jbGFzc0xpc3QucmVwbGFjZShcbiAgICAgICAgb3B0aW9ucy5jbGFzc0FuaW1hdGlvbi5jbG9zZSxcbiAgICAgICAgb3B0aW9ucy5jbGFzc0FuaW1hdGlvbi5vcGVuXG4gICAgICApO1xuICAgIH0sIDYwMCk7XG4gIH07IC8vIGZuQ2xvc2VcblxuICBmbk9wZW4gPSAobW9kYWxPYmplY3QpID0+IHtcbiAgICBpZiAoIW1vZGFsT2JqZWN0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbGV0IGN1c3RvbUV2ZW50O1xuICAgIGNvbnN0IGh0bWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJyk7XG4gICAgY29uc3QgbVdpbiA9IG1vZGFsT2JqZWN0LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC13aW5kb3cnKTtcblxuICAgIC8vIEhhbmRsZSB0aGUgRVNDIGRpc21pc3NcbiAgICBmbkVzYyA9IGZ1bmN0aW9uIGVzY0hhbmRsZXIoZSkge1xuICAgICAgY29uc3Qga2V5ID0gZS5rZXlDb2RlIHx8IGUud2hpY2g7XG5cbiAgICAgIC8vIFdoZW4gdGhlIEVTQyBrZXkgaXMgcHJlc3NlZFxuICAgICAgaWYgKGtleSA9PT0gMjcpIHtcbiAgICAgICAgZm5DbG9zZShtb2RhbE9iamVjdCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGlmICghbVdpbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEFkZCAoYW5kIHJlbW92ZSkgYW4gRVNDIGhhbmRsZXIgZm9yIHRoZSBvdmVybGF5XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZuRXNjKTtcblxuICAgIC8vIENsZWFyIGlubGluZSBkaXNwbGF5IHN0eWxlLCBpZiBhbnlcbiAgICBtb2RhbE9iamVjdC5zdHlsZS5kaXNwbGF5ID0gJyc7XG4gICAgLy8gQWRkIGFuaW1hdGlvbiB0byB0aGUgb3ZlcmxheVxuICAgIG1vZGFsT2JqZWN0LmNsYXNzTGlzdC5hZGQoJ2FuaW1hdGVkJywgJ2ZhZGVJbicsICdmYXN0Jyk7XG4gICAgLy8gQWRkIGFuaW1hdGlvbiB0byB0aGUgbW9kYWwgd2luZG93XG4gICAgbVdpbi5jbGFzc0xpc3QuYWRkKCdhbmltYXRlZCcsIG9wdGlvbnMuY2xhc3NBbmltYXRpb24ub3Blbik7XG4gICAgLy8gU2hvdyB0aGUgY29tcG9uZW50XG4gICAgbW9kYWxPYmplY3QuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpO1xuICAgIC8vIEZpbmFsbHkgcHJldmVudCBzY3JvbGxpbmdcbiAgICBodG1sLnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XG5cbiAgICAvLyBXYWl0IHRoZSBhbmltYXRpb24gY29tcGxldGUgdG8gZGlzcGF0Y2ggdGhlIGV2ZW50XG4gICAgLy8gRWFjaCBhbmltYXRlLmNzcyBhbmltYXRpb24gdGFrZXMgMXNcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIC8vIERpc3BhdGNoIHRoZSAnbW9kYWwub3BlbmVkJyBldmVudFxuICAgICAgY3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ21vZGFsLm9wZW5lZCcpO1xuICAgICAgbW9kYWxPYmplY3QuZGlzcGF0Y2hFdmVudChjdXN0b21FdmVudCk7XG4gICAgfSwgMTAwKTtcbiAgfTsgLy8gZm5PcGVuXG5cbiAgaWYgKG1vZGFscyAhPT0gbnVsbCkge1xuICAgIG1vZGFscy5mb3JFYWNoKChtb2RhbCwgaSkgPT4ge1xuICAgICAgLy8gSGFuZGxlIHRoZSBkaXNtaXNzIGJ1dHRvbnNcbiAgICAgIGNvbnN0IGRpc21pc3NhbHMgPSBtb2RhbC5xdWVyeVNlbGVjdG9yQWxsKCdbcm9sZT1cIm1vZGFsLWRpc21pc3NcIl0nKTtcblxuICAgICAgLy8gQWRkIChhbmQgcmVtb3ZlKSBhIGNsaWNrIGhhbmRsZXIgb24gdGhlIG92ZXJsYXlcbiAgICAgIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBmbkNsb3NlKG1vZGFsKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBBZGQgcHJvdG90eXBlIGZvciBzaG93IChvcGVuKVxuICAgICAgbW9kYWwuc2hvdyA9ICgpID0+IHtcbiAgICAgICAgZm5PcGVuKG1vZGFsKTtcbiAgICAgIH07XG5cbiAgICAgIC8vIEFkZCBwcm90b3R5cGUgZm9yIGhpZGUgKGNsb2RlKVxuICAgICAgbW9kYWwuaGlkZSA9ICgpID0+IHtcbiAgICAgICAgZm5DbG9zZShtb2RhbCk7XG4gICAgICB9O1xuXG4gICAgICBpZiAoZGlzbWlzc2FscyAhPT0gbnVsbCkge1xuICAgICAgICBkaXNtaXNzYWxzLmZvckVhY2goKGRpc21pc3MsIGopID0+IHtcbiAgICAgICAgICBkaXNtaXNzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2dCkge1xuICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmbkNsb3NlKG1vZGFsKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9IC8vIGlmIChkaXNtaXNzYWxzICE9PSBudWxsKVxuICAgIH0pO1xuICB9IC8vIGlmIChtb2RhbHMgIT09IG51bGwpXG5cbiAgaWYgKG1vZGFsVHJpZ2dlcnMgIT09IG51bGwpIHtcbiAgICBtb2RhbFRyaWdnZXJzLmZvckVhY2goKHRyaWdnZXIsIGkpID0+IHtcbiAgICAgIHRyaWdnZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB7XG4gICAgICAgIGlmIChldnQpIHtcbiAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlZiA9IHRyaWdnZXIuZ2V0QXR0cmlidXRlKCdkYXRhLW1vZGFsLWlkJyk7XG5cbiAgICAgICAgaWYgKHJlZiAhPT0gbnVsbCkge1xuICAgICAgICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7cmVmfWApO1xuICAgICAgICAgIGZuT3Blbihtb2RhbCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9IC8vIGlmIChtb2RhbFRyaWdnZXJzICE9PSBudWxsKVxuXG4gIG1vZGFsVHJpZ2dlcnMgPSB1bmRlZmluZWQ7XG5cbiAgcmV0dXJuIHtcbiAgICBnZXQ6IChpZHgpID0+IHtcbiAgICAgIGlmICh0eXBlb2YgaWR4ID09PSAnc3RyaW5nJykge1xuICAgICAgICBsZXQgbW9kYWwgPSBmYWxzZTtcblxuICAgICAgICBtb2RhbHMuZm9yRWFjaCgobm9kZSkgPT4ge1xuICAgICAgICAgIGlmIChub2RlLmlkID09PSBpZHgucmVwbGFjZSgvXiMvLCAnJykpIHtcbiAgICAgICAgICAgIG1vZGFsID0gbm9kZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBtb2RhbDtcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiBtb2RhbHNbaWR4XSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuIG1vZGFsc1tpZHhdO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9O1xufTsgLy8gc2VlZE1vZGFsXG5cbmlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xuICBtb2R1bGUuZXhwb3J0cy5zZWVkTW9kYWwgPSBzZWVkTW9kYWw7XG59IGVsc2Uge1xuICBpZiAodHlwZW9mIHdpbmRvdy5TZWVkQ1NTID09PSAndW5kZWZpbmVkJykge1xuICAgIHdpbmRvdy5TZWVkQ1NTID0ge307XG4gIH1cblxuICB3aW5kb3cuU2VlZENTUy5tb2RhbCA9IHNlZWRNb2RhbDtcbn1cbiIsIi8qKiFcbiAqIFNlZWQtQ1NTIC0gT2ZmLUNhbnZhcy5cbiAqIEBjb3B5cmlnaHQgMjAxOSwgQWJ0eiBMYWJzXG4gKiBAbGljZW5zZSBNSVRcbiAqL1xuXG5jb25zdCBzZWVkT2ZmQ2FudmFzID0gZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBjb25zdCBmblRvZ2dsZSA9IChjYW52YXNJRCwgdHJpZ2dlckVsZW1lbnQpID0+IHtcbiAgICBsZXQgY3VzdG9tRXZlbnQ7XG5cbiAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtjYW52YXNJRC5yZXBsYWNlKC9eIy8sICcnKX1gKTtcblxuICAgIGNvbnN0IHRyaWdnZXIgPVxuICAgICAgdHJpZ2dlckVsZW1lbnQgfHxcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgIGBbcm9sZT1cIm9mZmNhbnZhc1wiXVtkYXRhLWlkPVwiJHtjYW52YXNJRC5yZXBsYWNlKC9eIy8sICcnKX1cIl1gXG4gICAgICApO1xuXG4gICAgaWYgKGNhbnZhcyAhPT0gbnVsbCkge1xuICAgICAgY2FudmFzLmNsYXNzTGlzdC50b2dnbGUoJ29wZW4nKTtcblxuICAgICAgLy8gUHJldmVudHMgc2Nyb2xsaW5nIHRoZSBIVE1MXG4gICAgICBpZiAoY2FudmFzLmNsYXNzTGlzdC5jb250YWlucygnb3BlbicpKSB7XG4gICAgICAgIGlmICh0cmlnZ2VyICE9PSBudWxsKSB7XG4gICAgICAgICAgLy8gQWRkIHRoZSAndHJpZ2dlcmVkJyBjbGFzcyB0byB0aGUgZWxlbWVudCB3aGljaCBoYXMgdHJpZ2dlcmVkIHRoZSBvZmZjYW52YXMuXG4gICAgICAgICAgdHJpZ2dlci5jbGFzc0xpc3QuYWRkKCd0cmlnZ2VyZWQnKTtcbiAgICAgICAgfSAvLyBpZiAodHJpZ2dlciAhPT0gbnVsbClcblxuICAgICAgICAvLyBQcmV2ZW50cyBtYWluIHRvIHNjcm9sbFxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJykuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIFJlbW92ZSB0aGUgJ3RyaWdnZXJlZCcgY2xhc3MgZm9yIGFueSBleGlzdGluZyB0cmlnZ2VyIHdoaWNoIHJlZmVycyBnaXZlbiBvZmZjYW52YXMuXG4gICAgICAgIGRvY3VtZW50XG4gICAgICAgICAgLnF1ZXJ5U2VsZWN0b3JBbGwoXG4gICAgICAgICAgICBgW3JvbGU9XCJvZmZjYW52YXNcIl1bZGF0YS1pZD1cIiR7Y2FudmFzSUQucmVwbGFjZSgvXiMvLCAnJyl9XCJdYFxuICAgICAgICAgIClcbiAgICAgICAgICAuZm9yRWFjaCgodGdyKSA9PiB7XG4gICAgICAgICAgICB0Z3IuY2xhc3NMaXN0LnJlbW92ZSgndHJpZ2dlcmVkJyk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gUmUtZW5hYmxlcyBtYWluIHNjcm9sbGluZ1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJykuc3R5bGUub3ZlcmZsb3cgPSAnJztcbiAgICAgIH1cblxuICAgICAgLy8gV2FpdCB1bnRpbCBhbmltYXRpb24gaXMgY29tcGxldGUgdG8gZGlzcGF0Y2ggdGhlIGV2ZW50XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaWYgKGNhbnZhcy5jbGFzc0xpc3QuY29udGFpbnMoJ29wZW4nKSkge1xuICAgICAgICAgIGN1c3RvbUV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdjYW52YXMub3BlbmVkJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2NhbnZhcy5jbG9zZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERpc3BhdGNoIHRoZSAnY2FudmFzLm9wZW5lZCcvICdjYW52YXMuY2xvc2VkJyBldmVudHNcbiAgICAgICAgY2FudmFzLmRpc3BhdGNoRXZlbnQoY3VzdG9tRXZlbnQpO1xuICAgICAgfSwgMzAwKTtcbiAgICB9IC8vIGlmIChjYW52YXMgIT09IG51bGwpXG4gIH07IC8vIGZuVG9nZ2xlXG5cbiAgY29uc3QgZm5UcmlnZ2VyQ2xpY2sgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dCkge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXG4gICAgZm5Ub2dnbGUoXG4gICAgICBldnQuY3VycmVudFRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnKSB8fCAnb2ZmY2FudmFzJyxcbiAgICAgIGV2dC5jdXJyZW50VGFyZ2V0XG4gICAgKTtcbiAgfTsgLy8gZm5UcmlnZ2VyQ2xpY2tcblxuICAvLyBGaW5kIGFsbCBleGlzdGluZyB0cmlnZ2Vyc1xuICBjb25zdCB0cmlnZ2VycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tyb2xlPVwib2ZmY2FudmFzXCJdJyk7XG5cbiAgLy8gRmluZCBhbGwgZXhpc3Rpbmcgb2ZmY2FudmFzXG4gIGNvbnN0IGNhbnZhc2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm9mZmNhbnZhcycpO1xuXG4gIGlmICh0cmlnZ2VycyAhPT0gbnVsbCkge1xuICAgIHRyaWdnZXJzLmZvckVhY2goZnVuY3Rpb24odHJpZ2dlciwgaSkge1xuICAgICAgdHJpZ2dlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZuVHJpZ2dlckNsaWNrKTtcbiAgICB9KTsgLy8gdHJpZ2dlcnMuZm9yRWFjaChmdW5jdGlvbih0cmlnZ2VyLCBpKVxuICB9IC8vIGlmICh0cmlnZ2VycyAhPT0gbnVsbClcblxuICBpZiAoY2FudmFzZXMgIT09IG51bGwpIHtcbiAgICBjYW52YXNlcy5mb3JFYWNoKChjYW52YXMsIGkpID0+IHtcbiAgICAgIC8vIEF0dGFjaCBtZXRob2QgZm9yIG9wZW5pbmdcbiAgICAgIGNhbnZhcy5vcGVuID0gKCkgPT4ge1xuICAgICAgICBmblRvZ2dsZShjYW52YXMuZ2V0QXR0cmlidXRlKCdpZCcpIHx8ICdvZmZjYW52YXMnKTtcbiAgICAgIH07IC8vIG9wZW5cblxuICAgICAgLy8gQXR0YWNoIG1ldGhvZCBmb3IgY2xvc2luZ1xuICAgICAgY2FudmFzLmNsb3NlID0gKCkgPT4ge307IC8vIGNsb3NlXG4gICAgfSk7IC8vIGNhbnZhc2VzLmZvckVhY2goKGNhbnZhcywgaSlcbiAgfSAvLyBpZiAoY2FudmFzZXMgIT09IG51bGwpXG5cbiAgcmV0dXJuIHtcbiAgICBnZXQ6IChpZHgpID0+IHtcbiAgICAgIGlmICh0eXBlb2YgaWR4ID09PSAnc3RyaW5nJykge1xuICAgICAgICBsZXQgY2FudmFzID0gZmFsc2U7XG5cbiAgICAgICAgY2FudmFzZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xuICAgICAgICAgIGlmIChub2RlLmlkID09PSBpZHgucmVwbGFjZSgvXiMvLCAnJykpIHtcbiAgICAgICAgICAgIGNhbnZhcyA9IG5vZGU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gY2FudmFzO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIGNhbnZhc1tpZHhdICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm4gY2FudmFzW2lkeF07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG59OyAvLyBzZWVkT2ZmQ2FudmFzXG5cbmlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xuICBtb2R1bGUuZXhwb3J0cy5zZWVkT2ZmQ2FudmFzID0gc2VlZE9mZkNhbnZhcztcbn0gZWxzZSB7XG4gIGlmICh0eXBlb2Ygd2luZG93LlNlZWRDU1MgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgd2luZG93LlNlZWRDU1MgPSB7fTtcbiAgfVxuXG4gIHdpbmRvdy5TZWVkQ1NTLm9mZkNhbnZhcyA9IHNlZWRPZmZDYW52YXM7XG59XG4iLCIvKiohXG4gKiBTZWVkLUNTUyAtIFNjcm9sbC5cbiAqIEBjb3B5cmlnaHQgMjAxOSwgQWJ0eiBMYWJzXG4gKiBAbGljZW5zZSBNSVRcbiAqL1xuXG5jb25zdCBzZWVkU2Nyb2xsID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAndXNlIHN0cmljdCc7XG5cbiAgbGV0IHRyaWdnZXJzID0gbnVsbDtcblxuICBsZXQgcmV2ZWFsZXJzID0gbnVsbDtcblxuICBsZXQgc2Nyb2xsVGFyZ2V0ID0gMDtcblxuICBjb25zdCBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICBzcHlTY3JvbGxTZWxlY3RvcjogJ25hdiBhLnNtb290aCcsXG4gICAgcmV2ZWFsRWxlbWVudFNlbGVjdG9yOiAnLnJldmVhbCcsXG4gICAgcmV2ZWFsU3BhY2VPZmZzZXQ6IDAuMixcbiAgICByZXZlYWxXaGVuVmlzaWJsZTogJ3Zpc2libGUnLFxuICAgIHJldmVhbFNpbmdsZUFuaW1hdGlvbjogJ3Zpc2libGUtb25jZScsXG4gICAgcmV2ZWFsV2hlbkhpZGRlbjogJ2hpZGRlbicsXG4gICAgZ3V0dGVyOiA1MFxuICB9OyAvLyBkZWZhdWx0T3B0aW9uc1xuXG4gIGNvbnN0IGZuVXBkYXRlQWN0aXZlVHJpZ2dlciA9IChlbGVtKSA9PiB7XG4gICAgdHJpZ2dlcnMuZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgIH0pO1xuXG4gICAgaWYgKGVsZW0pIHtcbiAgICAgIGVsZW0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgfVxuICB9OyAvLyBmblVwZGF0ZUFjdGl2ZVRyaWdnZXJcblxuICBjb25zdCBmbkdldE9mZnNldCA9IChlbGVtKSA9PiB7XG4gICAgY29uc3QgYm9keU9mZnNldCA9IGRvY3VtZW50LmJvZHkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgY29uc3Qgb2Zmc2V0ID0gZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgIHJldHVybiB7XG4gICAgICB0b3A6IE1hdGguY2VpbChvZmZzZXQudG9wIC0gYm9keU9mZnNldC50b3ApLFxuICAgICAgbGVmdDogTWF0aC5jZWlsKG9mZnNldC5sZWZ0IC0gYm9keU9mZnNldC5sZWZ0KVxuICAgIH07XG4gIH07IC8vIGZuR2V0T2Zmc2V0XG5cbiAgY29uc3QgZm5TY3JvbGxDb21wbGV0ZSA9IChldnQpID0+IHtcbiAgICBpZiAod2luZG93LnNjcm9sbFkgPT09IHNjcm9sbFRhcmdldCkge1xuICAgICAgY29uc3Qgc2VlZEN1c3RvbUV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdzY3JvbGwuY29tcGxldGUnKTtcbiAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoc2VlZEN1c3RvbUV2ZW50KTtcbiAgICB9XG5cbiAgICBpZiAodHJpZ2dlcnMpIHtcbiAgICAgIGNvbnN0IGZpcnN0RWxlbWVudE9mZnNldCA9IGZuR2V0T2Zmc2V0KHRyaWdnZXJzWzBdKTtcblxuICAgICAgaWYgKHdpbmRvdy5zY3JvbGxZIDwgZmlyc3RFbGVtZW50T2Zmc2V0LnRvcCkge1xuICAgICAgICBmblVwZGF0ZUFjdGl2ZVRyaWdnZXIoKTtcbiAgICAgIH1cblxuICAgICAgdHJpZ2dlcnMuZm9yRWFjaCgoZWwsIGkpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCB0YXJnZXRJRCA9XG4gICAgICAgICAgICBlbC5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSB8fCBlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFyZ2V0Jyk7XG5cbiAgICAgICAgICBjb25zdCB0YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhcmdldElEKTtcbiAgICAgICAgICBjb25zdCBvZmZzZXQgPSBmbkdldE9mZnNldCh0YXJnZXQpO1xuXG4gICAgICAgICAgaWYgKG9mZnNldC50b3AgLSBvcHRpb25zLmd1dHRlciA8PSB3aW5kb3cuc2Nyb2xsWSkge1xuICAgICAgICAgICAgZm5VcGRhdGVBY3RpdmVUcmlnZ2VyKGVsKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHdpbmRvdy5vbGRPbnNjcm9sbCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgd2luZG93Lm9sZE9uc2Nyb2xsKGV2dCk7XG4gICAgfVxuICB9OyAvLyBmblNjcm9sbENvbXBsZXRlXG5cbiAgY29uc3QgZm5UcmlnZ2VyQ2xpY2sgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dCkge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXG4gICAgY29uc3QgdGFyZ2V0ID1cbiAgICAgIGV2dC5jdXJyZW50VGFyZ2V0LmdldEF0dHJpYnV0ZSgnaHJlZicpIHx8XG4gICAgICBldnQuY3VycmVudFRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGFyZ2V0Jyk7XG5cbiAgICBpZiAodGFyZ2V0KSB7XG4gICAgICBjb25zdCBlbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0YXJnZXQpO1xuXG4gICAgICBzY3JvbGxUYXJnZXQgPSBmbkdldE9mZnNldChlbGVtKS50b3AgLSBvcHRpb25zLmd1dHRlcjsgLy8gYWRkIHNvbWUgZ3V0dGVyXG5cbiAgICAgIHdpbmRvdy5zY3JvbGxUbyh7XG4gICAgICAgIGJlaGF2aW9yOiAnc21vb3RoJyxcbiAgICAgICAgbGVmdDogMCxcbiAgICAgICAgdG9wOiBzY3JvbGxUYXJnZXRcbiAgICAgIH0pO1xuICAgIH1cbiAgfTsgLy8gZm5UcmlnZ2VyQ2xpY2tcblxuICBjb25zdCBmbldhdGNoRWxlbWVudHMgPSAoKSA9PiB7XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSB2aWV3cG9ydCAod2luZG93KSBkaW1lbnNpb25zLlxuICAgICAqIEByZXR1cm4gb2JqZWN0XG4gICAgICovXG4gICAgY29uc3QgZ2V0Vmlld3BvcnRTaXplID0gKCkgPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgd2lkdGg6IHdpbmRvdy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgsXG4gICAgICAgIGhlaWdodDogd2luZG93LmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHRcbiAgICAgIH07XG4gICAgfTsgLy8gZ2V0Vmlld3BvcnRTaXplXG5cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgc2NvbGwgcG9zaXRpb24uXG4gICAgICogQHJldHVybiBvYmplY3RcbiAgICAgKi9cbiAgICBjb25zdCBnZXRDdXJyZW50U2Nyb2xsID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB4OiB3aW5kb3cucGFnZVhPZmZzZXQsXG4gICAgICAgIHk6IHdpbmRvdy5wYWdlWU9mZnNldFxuICAgICAgfTtcbiAgICB9OyAvLyBnZXRDdXJyZW50U2Nyb2xsXG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBlbGVtZW50IGRpbWVuc2lvbiBhbmQgcG9zaXRpb24uXG4gICAgICogQHBhcmFtIEhUTUxFbGVtZW50IGVsXG4gICAgICogQHJldHVybiBvYmplY3RcbiAgICAgKi9cbiAgICBjb25zdCBnZXRFbGVtSW5mbyA9IChlbCkgPT4ge1xuICAgICAgbGV0IGVsZW0gPSBlbDtcbiAgICAgIGxldCBvZmZzZXRUb3AgPSAwO1xuICAgICAgbGV0IG9mZnNldExlZnQgPSAwO1xuICAgICAgY29uc3Qgb2Zmc2V0V2lkdGggPSBlbGVtLm9mZnNldFdpZHRoO1xuICAgICAgY29uc3Qgb2Zmc2V0SGVpZ2h0ID0gZWxlbS5vZmZzZXRIZWlnaHQ7XG5cbiAgICAgIGRvIHtcbiAgICAgICAgaWYgKCFpc05hTihlbGVtLm9mZnNldFRvcCkpIHtcbiAgICAgICAgICBvZmZzZXRUb3AgKz0gZWxlbS5vZmZzZXRUb3A7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWlzTmFOKGVsZW0ub2Zmc2V0TGVmdCkpIHtcbiAgICAgICAgICBvZmZzZXRMZWZ0ICs9IGVsZW0ub2Zmc2V0TGVmdDtcbiAgICAgICAgfVxuICAgICAgfSB3aGlsZSAoKGVsZW0gPSBlbGVtLm9mZnNldFBhcmVudCkgIT09IG51bGwpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICB0b3A6IG9mZnNldFRvcCxcbiAgICAgICAgbGVmdDogb2Zmc2V0TGVmdCxcbiAgICAgICAgaGVpZ2h0OiBvZmZzZXRIZWlnaHQsXG4gICAgICAgIHdpZHRoOiBvZmZzZXRXaWR0aFxuICAgICAgfTtcbiAgICB9OyAvLyBnZXRFbGVtSW5mb1xuXG4gICAgLyoqXG4gICAgICogSWRlbnRpZmllcyB3aGV0aGVyIHRoZSBlbGVtZW50IGlzIHZpc2libGUgaW4gdGhlIHZpZXdwb3J0LlxuICAgICAqIEBwYXJhbSBIVE1MRWxlbWVudCBlbGVtXG4gICAgICogQHJldHVybiBib29sZWFuXG4gICAgICovXG4gICAgY29uc3QgaXNFbGVtZW50VmlzaWJsZSA9IChlbGVtKSA9PiB7XG4gICAgICBjb25zdCB2aWV3cG9ydFNpemUgPSBnZXRWaWV3cG9ydFNpemUoKTtcbiAgICAgIGNvbnN0IGN1cnJlbnRTY3JvbGwgPSBnZXRDdXJyZW50U2Nyb2xsKCk7XG4gICAgICBjb25zdCBlSW5mID0gZ2V0RWxlbUluZm8oZWxlbSk7XG4gICAgICBjb25zdCBzcGFjZU9mZnNldCA9IG9wdGlvbnMucmV2ZWFsU3BhY2VPZmZzZXQ7XG5cbiAgICAgIGNvbnN0IGNoZWNrQm91bmRhcmllcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBUaGUgZWxlbWVudCBib3VuZGFyaWVzXG4gICAgICAgIGNvbnN0IGVUb3AgPSBlSW5mLnRvcCArIGVJbmYuaGVpZ2h0ICogc3BhY2VPZmZzZXQ7XG4gICAgICAgIGNvbnN0IGVMZWZ0ID0gZUluZi5sZWZ0ICsgZUluZi53aWR0aCAqIHNwYWNlT2Zmc2V0O1xuICAgICAgICBjb25zdCBlUmlnaHQgPSBlSW5mLmxlZnQgKyBlSW5mLndpZHRoIC0gZUluZi53aWR0aCAqIHNwYWNlT2Zmc2V0O1xuICAgICAgICBjb25zdCBlQm90dG9tID0gZUluZi50b3AgKyBlSW5mLmhlaWdodCAtIGVJbmYuaGVpZ2h0ICogc3BhY2VPZmZzZXQ7XG5cbiAgICAgICAgLy8gVGhlIHdpbmRvdyBib3VuZGFyaWVzXG4gICAgICAgIGNvbnN0IHdUb3AgPSBjdXJyZW50U2Nyb2xsLnkgKyAwO1xuICAgICAgICBjb25zdCB3TGVmdCA9IGN1cnJlbnRTY3JvbGwueCArIDA7XG4gICAgICAgIGNvbnN0IHdCb3R0b20gPSBjdXJyZW50U2Nyb2xsLnkgLSAwICsgdmlld3BvcnRTaXplLmhlaWdodDtcbiAgICAgICAgY29uc3Qgd1JpZ2h0ID0gY3VycmVudFNjcm9sbC54IC0gMCArIHZpZXdwb3J0U2l6ZS53aWR0aDtcblxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgZWxlbWVudCBpcyB3aXRoaW4gYm91bmRhcnlcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICBlVG9wIDwgd0JvdHRvbSAmJiBlQm90dG9tID4gd1RvcCAmJiBlTGVmdCA+IHdMZWZ0ICYmIGVSaWdodCA8IHdSaWdodFxuICAgICAgICApO1xuICAgICAgfTtcblxuICAgICAgcmV0dXJuIGNoZWNrQm91bmRhcmllcygpO1xuICAgIH07IC8vIGlzRWxlbWVudFZpc2libGVcblxuICAgIC8qKlxuICAgICAqIFdhdGNoIHRoZSB0YXJnZXQgZWxlbWVudHMgd2l0aCBhIGxvb3AgdG8gaWRlbnRpZnkgd2hpY2ggb25lIGlzIGluc2lkZSB0aGUgdmlld3BvcnQuXG4gICAgICogSWYgZm91bmQsIHRoZSBlbGVtZW50IGdldHMgYSBjbGFzcyBkZWZpbmVkIGluIHRoZSBvcHRpb25zLlxuICAgICAqIEByZXR1cm4gdm9pZFxuICAgICAqL1xuICAgIGNvbnN0IHRvZ2dsZUVsZW1lbnQgPSAoKSA9PiB7XG4gICAgICBpZiAoIXJldmVhbGVycykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmV2ZWFsZXJzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGlmIChpc0VsZW1lbnRWaXNpYmxlKHJldmVhbGVyc1tpXSkpIHtcbiAgICAgICAgICBpZiAob3B0aW9ucy5yZXZlYWxXaGVuVmlzaWJsZSkge1xuICAgICAgICAgICAgcmV2ZWFsZXJzW2ldLmNsYXNzTGlzdC5hZGQob3B0aW9ucy5yZXZlYWxXaGVuVmlzaWJsZSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKG9wdGlvbnMucmV2ZWFsV2hlbkhpZGRlbikge1xuICAgICAgICAgICAgcmV2ZWFsZXJzW2ldLmNsYXNzTGlzdC5yZW1vdmUob3B0aW9ucy5yZXZlYWxXaGVuSGlkZGVuKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgcmV2ZWFsZXJzW2ldLmNsYXNzTGlzdC5jb250YWlucyhvcHRpb25zLnJldmVhbFNpbmdsZUFuaW1hdGlvbikgPT09XG4gICAgICAgICAgICBmYWxzZVxuICAgICAgICAgICkge1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMucmV2ZWFsV2hlbkhpZGRlbikge1xuICAgICAgICAgICAgICByZXZlYWxlcnNbaV0uY2xhc3NMaXN0LmFkZChvcHRpb25zLnJldmVhbFdoZW5IaWRkZW4pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5yZXZlYWxXaGVuVmlzaWJsZSkge1xuICAgICAgICAgICAgICByZXZlYWxlcnNbaV0uY2xhc3NMaXN0LnJlbW92ZShvcHRpb25zLnJldmVhbFdoZW5WaXNpYmxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9OyAvLyB0b2dnbGVFbGVtZW50XG5cbiAgICAvKipcbiAgICAgKiBBIGhhbmRsZXIgZm9yIHNjcm9sbGluZyBhbmQgcmVzaXppbmdcbiAgICAgKiBAcGFyYW0gd2luZG93LkV2ZW50IGV2dFxuICAgICAqIEByZXR1cm4gdm9pZFxuICAgICAqL1xuICAgIGNvbnN0IHNjcm9sbFJlc2l6ZUhhbmRsZXIgPSAoZXZ0KSA9PiB7XG4gICAgICB0b2dnbGVFbGVtZW50KCk7XG4gICAgfTtcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBzY3JvbGxSZXNpemVIYW5kbGVyLCBmYWxzZSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHNjcm9sbFJlc2l6ZUhhbmRsZXIsIGZhbHNlKTtcbiAgfTsgLy8gZm5XYXRjaEVsZW1lbnRzXG5cbiAgd2luZG93Lm9sZE9uc2Nyb2xsID0gd2luZG93Lm9uc2Nyb2xsO1xuICB3aW5kb3cub25zY3JvbGwgPSBmblNjcm9sbENvbXBsZXRlO1xuXG4gIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG5cbiAgLy8gRmluZCBhbGwgZXhpc3RpbmcgdHJpZ2dlcnMgZm9yIHNtb290aCBzY3JvbGxpbmdcbiAgdHJpZ2dlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKG9wdGlvbnMuc3B5U2Nyb2xsU2VsZWN0b3IpO1xuXG4gIC8vIEZpbmQgYWxsIGV4aXN0aW5nIHRhcmdldHMgZm9yIHdhdGNoaW5nIHRoZSB2aWV3cG9ydFxuICByZXZlYWxlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKG9wdGlvbnMucmV2ZWFsRWxlbWVudFNlbGVjdG9yKTtcblxuICBpZiAodHJpZ2dlcnMgIT09IG51bGwpIHtcbiAgICB0cmlnZ2Vycy5mb3JFYWNoKGZ1bmN0aW9uKHRyaWdnZXIsIGkpIHtcbiAgICAgIHRyaWdnZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmblRyaWdnZXJDbGljayk7XG4gICAgfSk7IC8vIHRyaWdnZXJzLmZvckVhY2goZnVuY3Rpb24odHJpZ2dlciwgaSlcbiAgfSAvLyBpZiAodHJpZ2dlcnMgIT09IG51bGwpXG5cbiAgaWYgKHJldmVhbGVycykge1xuICAgIGZuV2F0Y2hFbGVtZW50cygpO1xuICB9XG5cbiAgcmV0dXJuIHt9O1xufTsgLy8gc2VlZFNjcm9sbFxuXG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgbW9kdWxlLmV4cG9ydHMuc2VlZFNjcm9sbCA9IHNlZWRTY3JvbGw7XG59IGVsc2Uge1xuICBpZiAodHlwZW9mIHdpbmRvdy5TZWVkQ1NTID09PSAndW5kZWZpbmVkJykge1xuICAgIHdpbmRvdy5TZWVkQ1NTID0ge307XG4gIH1cblxuICB3aW5kb3cuU2VlZENTUy5zY3JvbGwgPSBzZWVkU2Nyb2xsO1xufVxuIiwiLyoqIVxuICogU2VlZC1DU1MgLSBBZGRpdGlvbmFsIGZlYXR1cmVzIGZvciBIVE1MIFRleHRhcmVhcy5cbiAqIEBjb3B5cmlnaHQgMjAxOSwgQWJ0eiBMYWJzXG4gKiBAbGljZW5zZSBNSVRcbiAqL1xuXG5jb25zdCBzZWVkVGV4dGFyZWEgPSBmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8vIEZpbmQgYWxsIHNlZWQtZmlsZSBpbnB1dHMuXG4gIGNvbnN0IGlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5maWVsZCA+IHRleHRhcmVhJyk7XG5cbiAgaWYgKGlucHV0cyAhPT0gbnVsbCkge1xuICAgIGlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uKGlucHV0LCBpKSB7XG4gICAgICBsZXQgbWF4TGVuZ3RoID0gMDtcblxuICAgICAgY29uc3QgcGFyZW50ID0gaW5wdXQucGFyZW50Tm9kZTtcbiAgICAgIGNvbnN0IGNvdW50ZXJMYWJlbCA9IHBhcmVudC5xdWVyeVNlbGVjdG9yKCdbcm9sZT1cImNvdW50ZXJcIl0nKTtcbiAgICAgIGNvbnN0IHRlbXBsYXRlID1cbiAgICAgICAgY291bnRlckxhYmVsLmdldEF0dHJpYnV0ZSgnZGF0YS10ZW1wbGF0ZScpIHx8XG4gICAgICAgICdUeXBlZCAlYSBvdXQgb2YgJWIuIFJlbWFpbmluZyAlYy4nO1xuXG4gICAgICBjb25zdCBmbkNhbGMgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHR5cGVkID0gaW5wdXQudmFsdWUucmVwbGFjZSgvW1xcblxccl0vZywgJycpLmxlbmd0aDtcbiAgICAgICAgY29uc3QgcmVtYWluaW5nID0gbWF4TGVuZ3RoIC0gdHlwZWQ7XG4gICAgICAgIGNvbnN0IG1pbkxlbmd0aCA9IE1hdGguZmxvb3IobWF4TGVuZ3RoICogMC4xKTtcblxuICAgICAgICBjb3VudGVyTGFiZWwuaW5uZXJIVE1MID0gdGVtcGxhdGVcbiAgICAgICAgICAucmVwbGFjZSgnJWEnLCB0eXBlZClcbiAgICAgICAgICAucmVwbGFjZSgnJWInLCBtYXhMZW5ndGgpXG4gICAgICAgICAgLnJlcGxhY2UoXG4gICAgICAgICAgICAnJWMnLFxuICAgICAgICAgICAgcmVtYWluaW5nIDw9IG1pbkxlbmd0aFxuICAgICAgICAgICAgICA/IGA8c3BhbiBjbGFzcz1cInJlZFwiID4ke3JlbWFpbmluZ308L3NwYW4+YFxuICAgICAgICAgICAgICA6IHJlbWFpbmluZ1xuICAgICAgICAgICk7XG4gICAgICB9O1xuXG4gICAgICBtYXhMZW5ndGggPSBpbnB1dC5nZXRBdHRyaWJ1dGUoJ21heGxlbmd0aCcpO1xuXG4gICAgICAvLyBJZ25vcmUgaWYgbWF4bGVuZ3RoIGlzIG5vdCBnaXZlblxuICAgICAgaWYgKCFtYXhMZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBNYWtlIHN1cmUgdGhlIGxpbWl0IGlzIGFuIGludGVnZXJcbiAgICAgIG1heExlbmd0aCA9IHBhcnNlSW50KG1heExlbmd0aCk7XG5cbiAgICAgIC8vIEF0dGFjaCB0aGUgaGFuZGxlcnNcbiAgICAgICdrZXlwcmVzcyBrZXlkb3duIGtleXVwJy5zcGxpdCgnICcpLmZvckVhY2goKGV2dCkgPT4ge1xuICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKGV2dCwgZm5DYWxjLCB0cnVlKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBJbml0aWFsaXplIHRoZSB1dGlsaXR5IGxhYmVsXG4gICAgICBmbkNhbGMoKTtcbiAgICB9KTsgLy8gaW5wdXRzLmZvckVhY2goZnVuY3Rpb24oaW5wdXQsIGkpXG4gIH0gLy8gaWYgKGlucHV0cyAhPT0gbnVsbClcbn07IC8vIHNlZWRUZXh0YXJlYVxuXG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgbW9kdWxlLmV4cG9ydHMuc2VlZFRleHRhcmVhID0gc2VlZFRleHRhcmVhO1xufSBlbHNlIHtcbiAgaWYgKHR5cGVvZiB3aW5kb3cuU2VlZENTUyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICB3aW5kb3cuU2VlZENTUyA9IHt9O1xuICB9XG5cbiAgd2luZG93LlNlZWRDU1MudGV4dEFyZWEgPSBzZWVkVGV4dGFyZWE7XG59XG4iXX0=
