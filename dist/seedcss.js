/*! 
 * Seed CSS (seed-css) 
 * A light-weight and mobile first CSS boilerplate. 
 * @author Rogerio Taques (hello@abtz.co) 
 * @copyright 2016-2019, Rogerio Taques (hello@abtz.co) 
 * @license MIT 
 * @version 2.2.6 
 */ 

 "use strict";!function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}return"function"!=typeof window.CustomEvent&&(t.prototype=window.Event.prototype,void(window.CustomEvent=t))}();
"use strict";var seedFileUpload=function(){var e=function(e){e&&e.preventDefault();var t,i=!1,n=this,l=n.nextElementSibling;n.files&&n.files.length>1?i=(n.getAttribute("data-multiple")||"{count} files").replace("{count}",n.files.length):n.value.trim().length>0&&(i=n.value.split("\\").pop()),i&&(l.querySelector(".input").innerHTML=i),""!==n.value&&(t=new CustomEvent("file.chosen"),n.parentNode.classList.add("chosen"),n.dispatchEvent(t))},t=document.querySelectorAll('.seed-file > [type="file"]');null!==t&&t.forEach(function(t,i){var n=t.nextElementSibling,l=n.querySelector(".cancel"),r=t.getAttribute("data-empty")||"No file chosen";n&&(t.getAttribute("id")&&t.getAttribute("id")!==n.getAttribute("for")?n.setAttribute("for",t.getAttribute("id")):n.getAttribute("for")&&!t.getAttribute("id")?t.setAttribute("id",n.getAttribute("for")):(t.setAttribute("id","file-input-"+i),n.setAttribute("for","file-input-"+i)),l&&l.addEventListener("click",function(e){e&&e.preventDefault();var i=t.getAttribute("data-empty")||"No file chosen";t.value="",t.parentNode.classList.remove("chosen"),n.querySelector(".input").innerHTML=i,seedCustomEvent=new CustomEvent("file.removed"),t.dispatchEvent(seedCustomEvent)}),n.querySelector(".input").innerHTML=r,t.addEventListener("change",e))})};"undefined"!=typeof module&&(module.exports.fileUpload=fileUpload),"undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.fileUpload=seedFileUpload;
"use strict";var fnOpen,fnClose,fnEsc,seedModal=function(e){var n={trigger:'[role="modal"]',classAnimation:{open:"bounceInDown",close:"bounceOutUp"}};e=Object.assign({},n,e);var o=document.querySelectorAll(".modal"),t=document.querySelectorAll(e.trigger);return fnClose=function(n){if(n){var o,t=document.querySelector("html"),s=n.querySelector(".modal-window");s&&(document.removeEventListener("keydown",fnEsc),s.classList.replace(e.classAnimation.open,e.classAnimation.close),n.classList.add("delay-1s"),n.classList.replace("fadeIn","fadeOut"),setTimeout(function(){o=new CustomEvent("modal.closed"),n.dispatchEvent(o),n.classList.add("hide"),t.style.overflow="",n.classList.remove("delay-1s","fadeOut"),s.classList.replace(e.classAnimation.close,e.classAnimation.open)},600))}},fnOpen=function(n){if(n){var o,t=document.querySelector("html"),s=n.querySelector(".modal-window");fnEsc=function(e){var o=e.keyCode||e.which;27===o&&fnClose(n)},s&&(document.addEventListener("keydown",fnEsc),n.style.display="",n.classList.add("animated","fadeIn","fast"),s.classList.add("animated",e.classAnimation.open),n.classList.remove("hide"),t.style.overflow="hidden",setTimeout(function(){o=new CustomEvent("modal.opened"),n.dispatchEvent(o)},100))}},null!==o&&o.forEach(function(e,n){var o=e.querySelectorAll('[role="modal-dismiss"]');e.addEventListener("click",function(){fnClose(e)}),e.show=function(){fnOpen(e)},e.hide=function(){fnClose(e)},null!==o&&o.forEach(function(n,o){n.addEventListener("click",function(n){n&&(n.preventDefault(),n.stopPropagation()),fnClose(e)})})}),null!==t&&t.forEach(function(e,n){e.addEventListener("click",function(n){n&&n.preventDefault();var o=e.getAttribute("data-modal-id");if(null!==o){var t=document.querySelector("#".concat(o));fnOpen(t)}})}),t=void 0,{get:function(e){if("string"==typeof e){var n=!1;return o.forEach(function(o){if(o.id===e.replace(/^#/,""))return void(n=o)}),n}return"undefined"!=typeof o[e]&&o[e]}}};"undefined"!=typeof module&&(module.exports.seedModal=seedModal),"undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.modal=seedModal;
"use strict";var seedOffCanvas=function(){var e="canvas-opened",t=function(t){for(var a=t.target,c=!1,o=document.querySelector("html");!c&&a&&a.parentNode;)a.classList&&!a.classList.contains("offcanvas")?a=a.parentNode:a.classList&&(c=!0);!c&&o.classList.contains(e)&&n(o.getAttribute("data-canvas-id"))},n=function(n,a){var c,o=document.querySelector("#".concat(n.replace(/^#/,""))),s=a||document.querySelector('[role="offcanvas"][data-id="'.concat(n.replace(/^#/,""),'"]'));if(null!==o){var r=document.querySelector("html");r.classList.contains(e)?(o.classList.remove("open"),document.querySelectorAll('[role="offcanvas"][data-id="'.concat(n.replace(/^#/,""),'"]')).forEach(function(e){e.classList.remove("triggered")}),r.removeEventListener("click",t),r.style.overflow=""):(o.classList.add("open"),null!==s&&s.classList.add("triggered"),r.addEventListener("click",t),r.style.overflow="hidden"),setTimeout(function(){o.classList.contains("open")?(r.classList.add(e),r.setAttribute("data-canvas-id",n.replace(/^#/,"")),c=new CustomEvent("canvas.opened")):(r.classList.remove(e),c=new CustomEvent("canvas.closed")),o.dispatchEvent(c)},300)}},a=function(e){e&&e.preventDefault(),n(e.currentTarget.getAttribute("data-id")||"offcanvas",e.currentTarget)},c=document.querySelectorAll('[role="offcanvas"]'),o=document.querySelectorAll(".offcanvas");return null!==c&&c.forEach(function(e,t){e.addEventListener("click",a,!1)}),null!==o&&o.forEach(function(e,t){e.open=function(){n(e.getAttribute("id")||"offcanvas")},e.close=function(){}}),{get:function(e){if("string"==typeof e){var t=!1;return o.forEach(function(n){if(n.id===e.replace(/^#/,""))return void(t=n)}),t}return"undefined"!=typeof canvas[e]&&canvas[e]}}};"undefined"!=typeof module&&(module.exports.seedOffCanvas=seedOffCanvas),"undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.offCanvas=seedOffCanvas;
"use strict";var seedScroll=function(e){var t=null,n=null,o=0,i={spyScrollSelector:"nav a.smooth",revealElementSelector:".reveal",revealSpaceOffset:.2,revealWhenVisible:"visible",revealSingleAnimation:"visible-once",revealWhenHidden:"hidden",gutter:50},l=function(e){t.forEach(function(e){e.classList.remove("active")}),e&&e.classList.add("active")},r=function(e){var t=document.body.getBoundingClientRect(),n=e?e.getBoundingClientRect():0;return{top:Math.ceil(n.top-t.top),left:Math.ceil(n.left-t.left)}},c=function(n){if(window.scrollY===o){var i=new CustomEvent("scroll.complete");document.dispatchEvent(i)}if(t){var c=r(t[0]);window.scrollY<c.top&&l(),t.forEach(function(t,n){try{var o=t.getAttribute("href")||t.getAttribute("data-target"),i=document.querySelector(o),c=r(i);if(c.top-e.gutter<=window.scrollY)return void l(t)}catch(d){}})}"function"==typeof window.oldOnscroll&&window.oldOnscroll(n)},d=function(t){t&&t.preventDefault();var n=t.currentTarget.getAttribute("href")||t.currentTarget.getAttribute("data-target");if(n){var i=document.querySelector(n);o=r(i).top-e.gutter,window.scrollTo({behavior:"smooth",left:0,top:o})}},a=function(){var t=function(){return{width:window.document.documentElement.clientWidth,height:window.document.documentElement.clientHeight}},o=function(){return{x:window.pageXOffset,y:window.pageYOffset}},i=function(e){var t=e,n=0,o=0,i=t.offsetWidth,l=t.offsetHeight;do isNaN(t.offsetTop)||(n+=t.offsetTop),isNaN(t.offsetLeft)||(o+=t.offsetLeft);while(null!==(t=t.offsetParent));return{top:n,left:o,height:l,width:i}},l=function(n){var l=t(),r=o(),c=i(n),d=e.revealSpaceOffset,a=function(){var e=c.top+c.height*d,t=c.left+c.width*d,n=c.left+c.width-c.width*d,o=c.top+c.height-c.height*d,i=r.y+0,a=r.x+0,s=r.y-0+l.height,f=r.x-0+l.width;return e<s&&o>i&&t>a&&n<f};return a()},r=function(){if(n)for(var t=0;t<n.length;t+=1)l(n[t])?(e.revealWhenVisible&&n[t].classList.add(e.revealWhenVisible),e.revealWhenHidden&&n[t].classList.remove(e.revealWhenHidden)):n[t].classList.contains(e.revealSingleAnimation)===!1&&(e.revealWhenHidden&&n[t].classList.add(e.revealWhenHidden),e.revealWhenVisible&&n[t].classList.remove(e.revealWhenVisible))},c=function(e){r()};window.addEventListener("scroll",c,!1),window.addEventListener("resize",c,!1)};return window.oldOnscroll=window.onscroll,window.onscroll=c,e=Object.assign({},i,e),t=document.querySelectorAll(e.spyScrollSelector),n=document.querySelectorAll(e.revealElementSelector),null!==t&&t.forEach(function(e,t){e.addEventListener("click",d,!1)}),n&&a(),{}};"undefined"!=typeof module&&(module.exports.seedScroll=seedScroll),"undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.scroll=seedScroll;
"use strict";var seedTextarea=function(){var e=document.querySelectorAll(".field > textarea");null!==e&&e.forEach(function(e,t){var a=0,r=e.parentNode,n=r.querySelector('[role="counter"]'),o=n.getAttribute("data-template")||"Typed %a out of %b. Remaining %c.",d=function(){var t=e.value.replace(/[\n\r]/g,"").length,r=a-t,d=Math.floor(.1*a);n.innerHTML=o.replace("%a",t).replace("%b",a).replace("%c",r<=d?'<span class="red" >'.concat(r,"</span>"):r)};a=e.getAttribute("maxlength"),a&&(a=parseInt(a),"keypress keydown keyup".split(" ").forEach(function(t){e.addEventListener(t,d,!0)}),d())})};"undefined"!=typeof module&&(module.exports.seedTextarea=seedTextarea),"undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.textArea=seedTextarea;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbUV2ZW50UG9seWZpbGwuanMiLCJzZWVkRmlsZVVwbG9hZC5qcyIsInNlZWRNb2RhbC5qcyIsInNlZWRPZmZDYW52YXMuanMiLCJzZWVkU2Nyb2xsLmpzIiwic2VlZFRleHRhcmVhLmpzIl0sIm5hbWVzIjpbIkN1c3RvbUV2ZW50IiwiZXZlbnQiLCJwYXJhbXMiLCJidWJibGVzIiwiY2FuY2VsYWJsZSIsImRldGFpbCIsInVuZGVmaW5lZCIsImV2dCIsImRvY3VtZW50IiwiY3JlYXRlRXZlbnQiLCJpbml0Q3VzdG9tRXZlbnQiLCJ3aW5kb3ciLCJwcm90b3R5cGUiLCJFdmVudCIsInNlZWRGaWxlVXBsb2FkIiwiZm5DaGFuZ2UiLCJwcmV2ZW50RGVmYXVsdCIsInNlZWRDdXN0b21FdmVudCIsImZpbGVOYW1lIiwiaW5wdXQiLCJ0aGlzIiwibGFiZWwiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJmaWxlcyIsImxlbmd0aCIsImdldEF0dHJpYnV0ZSIsInJlcGxhY2UiLCJ2YWx1ZSIsInRyaW0iLCJzcGxpdCIsInBvcCIsInF1ZXJ5U2VsZWN0b3IiLCJpbm5lckhUTUwiLCJwYXJlbnROb2RlIiwiY2xhc3NMaXN0IiwiYWRkIiwiZGlzcGF0Y2hFdmVudCIsImlucHV0cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiaSIsImNhbmNlbCIsImVtcHR5VGV4dCIsInNldEF0dHJpYnV0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmUiLCJtb2R1bGUiLCJleHBvcnRzIiwiZmlsZVVwbG9hZCIsIlNlZWRDU1MiLCJmbk9wZW4iLCJmbkNsb3NlIiwiZm5Fc2MiLCJzZWVkTW9kYWwiLCJvcHRpb25zIiwiZGVmYXVsdE9wdGlvbnMiLCJ0cmlnZ2VyIiwiY2xhc3NBbmltYXRpb24iLCJvcGVuIiwiY2xvc2UiLCJPYmplY3QiLCJhc3NpZ24iLCJtb2RhbHMiLCJtb2RhbFRyaWdnZXJzIiwibW9kYWxPYmplY3QiLCJjdXN0b21FdmVudCIsImh0bWwiLCJtV2luIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldFRpbWVvdXQiLCJzdHlsZSIsIm92ZXJmbG93IiwiZSIsImtleSIsImtleUNvZGUiLCJ3aGljaCIsImRpc3BsYXkiLCJtb2RhbCIsImRpc21pc3NhbHMiLCJzaG93IiwiaGlkZSIsImRpc21pc3MiLCJqIiwic3RvcFByb3BhZ2F0aW9uIiwicmVmIiwiY29uY2F0IiwiZ2V0IiwiaWR4Iiwibm9kZSIsImlkIiwic2VlZE9mZkNhbnZhcyIsIm9wZW5lZE9mZmNhbnZhc0NsYXNzIiwiZm5PdXRzaWRlQ2xpY2tIYW5kbGVyIiwiZXYiLCJhIiwidGFyZ2V0IiwiZm91bmQiLCJjb250YWlucyIsImZuVG9nZ2xlIiwiY2FudmFzSUQiLCJ0cmlnZ2VyRWxlbWVudCIsImNhbnZhcyIsInRnciIsImZuVHJpZ2dlckNsaWNrIiwiY3VycmVudFRhcmdldCIsInRyaWdnZXJzIiwiY2FudmFzZXMiLCJvZmZDYW52YXMiLCJzZWVkU2Nyb2xsIiwicmV2ZWFsZXJzIiwic2Nyb2xsVGFyZ2V0Iiwic3B5U2Nyb2xsU2VsZWN0b3IiLCJyZXZlYWxFbGVtZW50U2VsZWN0b3IiLCJyZXZlYWxTcGFjZU9mZnNldCIsInJldmVhbFdoZW5WaXNpYmxlIiwicmV2ZWFsU2luZ2xlQW5pbWF0aW9uIiwicmV2ZWFsV2hlbkhpZGRlbiIsImd1dHRlciIsImZuVXBkYXRlQWN0aXZlVHJpZ2dlciIsImVsZW0iLCJlbCIsImZuR2V0T2Zmc2V0IiwiYm9keU9mZnNldCIsImJvZHkiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJvZmZzZXQiLCJ0b3AiLCJNYXRoIiwiY2VpbCIsImxlZnQiLCJmblNjcm9sbENvbXBsZXRlIiwic2Nyb2xsWSIsImZpcnN0RWxlbWVudE9mZnNldCIsInRhcmdldElEIiwib2xkT25zY3JvbGwiLCJzY3JvbGxUbyIsImJlaGF2aW9yIiwiZm5XYXRjaEVsZW1lbnRzIiwiZ2V0Vmlld3BvcnRTaXplIiwid2lkdGgiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGllbnRXaWR0aCIsImhlaWdodCIsImNsaWVudEhlaWdodCIsImdldEN1cnJlbnRTY3JvbGwiLCJ4IiwicGFnZVhPZmZzZXQiLCJ5IiwicGFnZVlPZmZzZXQiLCJnZXRFbGVtSW5mbyIsIm9mZnNldFRvcCIsIm9mZnNldExlZnQiLCJvZmZzZXRXaWR0aCIsIm9mZnNldEhlaWdodCIsImlzTmFOIiwib2Zmc2V0UGFyZW50IiwiaXNFbGVtZW50VmlzaWJsZSIsInZpZXdwb3J0U2l6ZSIsImN1cnJlbnRTY3JvbGwiLCJlSW5mIiwic3BhY2VPZmZzZXQiLCJjaGVja0JvdW5kYXJpZXMiLCJlVG9wIiwiZUxlZnQiLCJlUmlnaHQiLCJlQm90dG9tIiwid1RvcCIsIndMZWZ0Iiwid0JvdHRvbSIsIndSaWdodCIsInRvZ2dsZUVsZW1lbnQiLCJzY3JvbGxSZXNpemVIYW5kbGVyIiwib25zY3JvbGwiLCJzY3JvbGwiLCJzZWVkVGV4dGFyZWEiLCJtYXhMZW5ndGgiLCJwYXJlbnQiLCJjb3VudGVyTGFiZWwiLCJ0ZW1wbGF0ZSIsImZuQ2FsYyIsInR5cGVkIiwicmVtYWluaW5nIiwibWluTGVuZ3RoIiwiZmxvb3IiLCJwYXJzZUludCIsInRleHRBcmVhIl0sIm1hcHBpbmdzIjoiQUFBQSxjQUtBLFdBR0UsUUFBU0EsR0FBWUMsRUFBT0MsR0FDMUJBLEVBQVNBLElBQVlDLFNBQVMsRUFBT0MsWUFBWSxFQUFPQyxPQUFRQyxPQUNoRSxJQUFJQyxHQUFNQyxTQUFTQyxZQUFZLGNBTy9CLE9BTkFGLEdBQUlHLGdCQUNGVCxFQUNBQyxFQUFPQyxRQUNQRCxFQUFPRSxXQUNQRixFQUFPRyxRQUVGRSxFQVhULE1BQWtDLGtCQUF2QkksUUFBT1gsY0FjbEJBLEVBQVlZLFVBQVlELE9BQU9FLE1BQU1ELGVBRXJDRCxPQUFPWCxZQUFjQTtBQ3RCdkIsWUFNQSxJQUFNYyxnQkFBaUIsV0FHckIsR0FBTUMsR0FBVyxTQUFrQlIsR0FDN0JBLEdBQ0ZBLEVBQUlTLGdCQUdOLElBQUlDLEdBQ0FDLEdBQVcsRUFFVEMsRUFBUUMsS0FDUkMsRUFBUUYs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QUF5QmxKLE1BQU0sS0FBS1UsUUFBUSxTQUFDaEMsR0FDM0NZLEVBQU15QixpQkFBaUJyQyxFQUFLNEssR0FBUSxLQUl0Q0EsT0FLZ0Isb0JBQVhySSxVQUNUQSxPQUFPQyxRQUFRK0gsYUFBZUEsY0FJRixtQkFBbkJuSyxRQUFPc0MsVUFDaEJ0QyxPQUFPc0MsWUFJVHRDLE9BQU9zQyxRQUFRd0ksU0FBV1giLCJmaWxlIjoic2VlZGNzcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKiFcbiAqIEEgc2ltcGxlIHBvbHlmaWxsIGZvciBDdXN0b21FdmVudFxuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvQ3VzdG9tRXZlbnQvQ3VzdG9tRXZlbnQjUG9seWZpbGxcbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICBpZiAodHlwZW9mIHdpbmRvdy5DdXN0b21FdmVudCA9PT0gJ2Z1bmN0aW9uJykgcmV0dXJuIGZhbHNlO1xuXG4gIGZ1bmN0aW9uIEN1c3RvbUV2ZW50KGV2ZW50LCBwYXJhbXMpIHtcbiAgICBwYXJhbXMgPSBwYXJhbXMgfHwgeyBidWJibGVzOiBmYWxzZSwgY2FuY2VsYWJsZTogZmFsc2UsIGRldGFpbDogdW5kZWZpbmVkIH07XG4gICAgdmFyIGV2dCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuICAgIGV2dC5pbml0Q3VzdG9tRXZlbnQoXG4gICAgICBldmVudCxcbiAgICAgIHBhcmFtcy5idWJibGVzLFxuICAgICAgcGFyYW1zLmNhbmNlbGFibGUsXG4gICAgICBwYXJhbXMuZGV0YWlsXG4gICAgKTtcbiAgICByZXR1cm4gZXZ0O1xuICB9XG5cbiAgQ3VzdG9tRXZlbnQucHJvdG90eXBlID0gd2luZG93LkV2ZW50LnByb3RvdHlwZTtcblxuICB3aW5kb3cuQ3VzdG9tRXZlbnQgPSBDdXN0b21FdmVudDtcbn0pKCk7XG4iLCIvKiohXG4gKiBTZWVkLUNTUyAtIEN1c3RvbSBIVE1MIElucHV0IEZpbGUuXG4gKiBAY29weXJpZ2h0IDIwMTksIEFidHogTGFic1xuICogQGxpY2Vuc2UgTUlUXG4gKi9cblxuY29uc3Qgc2VlZEZpbGVVcGxvYWQgPSBmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGNvbnN0IGZuQ2hhbmdlID0gZnVuY3Rpb24gZm5DaGFuZ2UoZXZ0KSB7XG4gICAgaWYgKGV2dCkge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXG4gICAgbGV0IHNlZWRDdXN0b21FdmVudDtcbiAgICBsZXQgZmlsZU5hbWUgPSBmYWxzZTtcblxuICAgIGNvbnN0IGlucHV0ID0gdGhpcztcbiAgICBjb25zdCBsYWJlbCA9IGlucHV0Lm5leHRFbGVtZW50U2libGluZztcblxuICAgIC8vIFdoZW4gbXVsdGlwbGUgZmlsZXMgYXJlIHNlbGVjdGVkXG4gICAgaWYgKGlucHV0LmZpbGVzICYmIGlucHV0LmZpbGVzLmxlbmd0aCA+IDEpIHtcbiAgICAgIGZpbGVOYW1lID0gKFxuICAgICAgICBpbnB1dC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbXVsdGlwbGUnKSB8fCAne2NvdW50fSBmaWxlcydcbiAgICAgICkucmVwbGFjZSgne2NvdW50fScsIGlucHV0LmZpbGVzLmxlbmd0aCk7XG4gICAgfVxuXG4gICAgLy8gV2hlbiBvbmx5IG9uZSBmaWxlIGlzIHNlbGVjdGVkXG4gICAgZWxzZSBpZiAoaW5wdXQudmFsdWUudHJpbSgpLmxlbmd0aCA+IDApIHtcbiAgICAgIGZpbGVOYW1lID0gaW5wdXQudmFsdWUuc3BsaXQoJ1xcXFwnKS5wb3AoKTtcbiAgICB9XG5cbiAgICBpZiAoZmlsZU5hbWUpIHtcbiAgICAgIGxhYmVsLnF1ZXJ5U2VsZWN0b3IoJy5pbnB1dCcpLmlubmVySFRNTCA9IGZpbGVOYW1lO1xuICAgIH1cblxuICAgIGlmIChpbnB1dC52YWx1ZSAhPT0gJycpIHtcbiAgICAgIHNlZWRDdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudCgnZmlsZS5jaG9zZW4nKTtcbiAgICAgIGlucHV0LnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCgnY2hvc2VuJyk7XG4gICAgICBpbnB1dC5kaXNwYXRjaEV2ZW50KHNlZWRDdXN0b21FdmVudCk7XG4gICAgfVxuICB9OyAvLyBmbkNoYW5nZVxuXG4gIC8vIEZpbmQgYWxsIHNlZWQtZmlsZSBpbnB1dHMuXG4gIGNvbnN0IGlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWVkLWZpbGUgPiBbdHlwZT1cImZpbGVcIl0nKTtcblxuICBpZiAoaW5wdXRzICE9PSBudWxsKSB7XG4gICAgaW5wdXRzLmZvckVhY2goZnVuY3Rpb24oaW5wdXQsIGkpIHtcbiAgICAgIC8vIEZpbmQgdGhlIGZpZWxkIGxhYmVsXG4gICAgICBjb25zdCBsYWJlbCA9IGlucHV0Lm5leHRFbGVtZW50U2libGluZztcbiAgICAgIGNvbnN0IGNhbmNlbCA9IGxhYmVsLnF1ZXJ5U2VsZWN0b3IoJy5jYW5jZWwnKTtcbiAgICAgIGNvbnN0IGVtcHR5VGV4dCA9IGlucHV0LmdldEF0dHJpYnV0ZSgnZGF0YS1lbXB0eScpIHx8ICdObyBmaWxlIGNob3Nlbic7XG5cbiAgICAgIC8vIElmIGxhYmVsIGRvZXMgbm90IGV4aXN0cywgc2ltcGx5IGRvIG5vdCBzZXQgaXQgdXBcbiAgICAgIGlmICghbGFiZWwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBNYWtlIHN1cmUgaW5wdXQgYW5kIGxhYmVsIG1hdGNoZXMgYW5kIHdvcmtzLlxuICAgICAgaWYgKFxuICAgICAgICBpbnB1dC5nZXRBdHRyaWJ1dGUoJ2lkJykgJiZcbiAgICAgICAgaW5wdXQuZ2V0QXR0cmlidXRlKCdpZCcpICE9PSBsYWJlbC5nZXRBdHRyaWJ1dGUoJ2ZvcicpXG4gICAgICApIHtcbiAgICAgICAgbGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCBpbnB1dC5nZXRBdHRyaWJ1dGUoJ2lkJykpO1xuICAgICAgfSBlbHNlIGlmIChsYWJlbC5nZXRBdHRyaWJ1dGUoJ2ZvcicpICYmICFpbnB1dC5nZXRBdHRyaWJ1dGUoJ2lkJykpIHtcbiAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKCdpZCcsIGxhYmVsLmdldEF0dHJpYnV0ZSgnZm9yJykpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKCdpZCcsICdmaWxlLWlucHV0LScgKyBpKTtcbiAgICAgICAgbGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCAnZmlsZS1pbnB1dC0nICsgaSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFsd2F5cyB0aGUgY2FuY2VsIGJ1dHRvbiBleGlzdHMsIGFkZHMgYSBoYW5kbGVyXG4gICAgICBpZiAoY2FuY2VsKSB7XG4gICAgICAgIGNhbmNlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldnQpID0+IHtcbiAgICAgICAgICBpZiAoZXZ0KSB7XG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBlbXB0eVRleHQgPVxuICAgICAgICAgICAgaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLWVtcHR5JykgfHwgJ05vIGZpbGUgY2hvc2VuJztcblxuICAgICAgICAgIGlucHV0LnZhbHVlID0gJyc7XG4gICAgICAgICAgaW5wdXQucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdjaG9zZW4nKTtcbiAgICAgICAgICBsYWJlbC5xdWVyeVNlbGVjdG9yKCcuaW5wdXQnKS5pbm5lckhUTUwgPSBlbXB0eVRleHQ7XG5cbiAgICAgICAgICBzZWVkQ3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2ZpbGUucmVtb3ZlZCcpO1xuICAgICAgICAgIGlucHV0LmRpc3BhdGNoRXZlbnQoc2VlZEN1c3RvbUV2ZW50KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGxhYmVsLnF1ZXJ5U2VsZWN0b3IoJy5pbnB1dCcpLmlubmVySFRNTCA9IGVtcHR5VGV4dDtcblxuICAgICAgLy8gU3RhcnQgbGlzdGVuaW5nIHRoZSBmaWVsZCBmb3IgY2hhbmdlc1xuICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZm5DaGFuZ2UpO1xuICAgIH0pOyAvLyBpbnB1dHMuZm9yRWFjaChmdW5jdGlvbihpbnB1dCwgaSlcbiAgfSAvLyBpZiAoaW5wdXRzICE9PSBudWxsKVxufTsgLy8gc2VlZEZpbGVVcGxvYWRcblxuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gIG1vZHVsZS5leHBvcnRzLmZpbGVVcGxvYWQgPSBmaWxlVXBsb2FkO1xufVxuXG4vLyBFeHBvc2UgU2VlZENTUyBpbiB0aGUgZ2xvYmFsIHNjb3BlXG5pZiAodHlwZW9mIHdpbmRvdy5TZWVkQ1NTID09PSAndW5kZWZpbmVkJykge1xuICB3aW5kb3cuU2VlZENTUyA9IHt9O1xufVxuXG4vLyBFeHBvc2UgZmlsZVVwbG9hZCBtZW51IGluIHRoZSBnbG9iYWwgc2NvcGVcbndpbmRvdy5TZWVkQ1NTLmZpbGVVcGxvYWQgPSBzZWVkRmlsZVVwbG9hZDtcbiIsIi8qKiFcbiAqIFNlZWQtQ1NTIC0gTW9kYWxcbiAqIEBjb3B5cmlnaHQgMjAxOSwgQWJ0eiBMYWJzXG4gKiBAbGljZW5zZSBNSVRcbiAqL1xuXG5sZXQgZm5PcGVuO1xuXG5sZXQgZm5DbG9zZTtcblxubGV0IGZuRXNjO1xuXG5jb25zdCBzZWVkTW9kYWwgPSAob3B0aW9ucykgPT4ge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLy8gRGVmYXVsdCBzZXR0aW5nc1xuICBjb25zdCBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAvLyB0aGUgZWxlbWVudCB0aGF0IHRyaWdnZXJzIHRoZSBtb2RhbFxuICAgIHRyaWdnZXI6ICdbcm9sZT1cIm1vZGFsXCJdJyxcblxuICAgIC8vIEBzZWU6IGh0dHBzOi8vZGFuZWRlbi5naXRodWIuaW8vYW5pbWF0ZS5jc3MvXG4gICAgLy8gYW5pbWF0ZS5jc3MgY2xhc3NlcyB0byBiZSB1c2VkXG4gICAgY2xhc3NBbmltYXRpb246IHtcbiAgICAgIG9wZW46ICdib3VuY2VJbkRvd24nLFxuICAgICAgY2xvc2U6ICdib3VuY2VPdXRVcCdcbiAgICB9XG4gIH07XG5cbiAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcblxuICAvLyBHZXQgZWxlbWVudHNcbiAgbGV0IG1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RhbCcpO1xuICBsZXQgbW9kYWxUcmlnZ2VycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwob3B0aW9ucy50cmlnZ2VyKTtcblxuICBmbkNsb3NlID0gKG1vZGFsT2JqZWN0KSA9PiB7XG4gICAgaWYgKCFtb2RhbE9iamVjdCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCBjdXN0b21FdmVudDtcbiAgICBjb25zdCBodG1sID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaHRtbCcpO1xuICAgIGNvbnN0IG1XaW4gPSBtb2RhbE9iamVjdC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtd2luZG93Jyk7XG5cbiAgICBpZiAoIW1XaW4pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBSZW1vdmVzIHRoZSBFU0MgbGlzdGVuZXJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZm5Fc2MpO1xuXG4gICAgLy8gUmVwbGFjZSBvcGVuIGFuaW1hdGlvbiB0byBjbG9zZSB0aGUgbW9kYWwgd2luZG93XG4gICAgbVdpbi5jbGFzc0xpc3QucmVwbGFjZShcbiAgICAgIG9wdGlvbnMuY2xhc3NBbmltYXRpb24ub3BlbixcbiAgICAgIG9wdGlvbnMuY2xhc3NBbmltYXRpb24uY2xvc2VcbiAgICApO1xuXG4gICAgLy8gQWRkIGFuaW1hdGlvbiB0byB0aGUgb3ZlcmxheVxuICAgIG1vZGFsT2JqZWN0LmNsYXNzTGlzdC5hZGQoJ2RlbGF5LTFzJyk7XG4gICAgbW9kYWxPYmplY3QuY2xhc3NMaXN0LnJlcGxhY2UoJ2ZhZGVJbicsICdmYWRlT3V0Jyk7XG5cbiAgICAvLyBXYWl0IDIgc2Vjb25kcyBiZWZvcmUgY29tcGxldGUgZGUgcHJvY2Vzcy5cbiAgICAvLyBUaGlzIGlzIHRoZSB0aW1lIHRvIGZpbmlzaGluZyBhbGwgYW5pbWF0ZS5jc3MgYW5pbWF0aW9uc1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgLy8gRGlzcGF0Y2ggdGhlICdtb2RhbC5jbG9zZWQnIGV2ZW50XG4gICAgICBjdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudCgnbW9kYWwuY2xvc2VkJyk7XG4gICAgICBtb2RhbE9iamVjdC5kaXNwYXRjaEV2ZW50KGN1c3RvbUV2ZW50KTtcblxuICAgICAgLy8gQ29tcGxldGVseSBoaWRlIHRoZSBjb21wb25lbnRcbiAgICAgIG1vZGFsT2JqZWN0LmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcbiAgICAgIC8vIFJlZW5hYmxlIHNjcm9sbGluZyBmcm9tIHRoZSBIVE1MXG4gICAgICBodG1sLnN0eWxlLm92ZXJmbG93ID0gJyc7XG4gICAgICAvLyBSZW1vdmUgY2xvc2luZyBjbGFzc2VzIGZyb20gb3ZlcmxheVxuICAgICAgbW9kYWxPYmplY3QuY2xhc3NMaXN0LnJlbW92ZSgnZGVsYXktMXMnLCAnZmFkZU91dCcpO1xuICAgICAgLy8gUmVtb3ZlIGNsb3NpbmcgY2xhc3NlcyBmcm9tIG1vZGFsIHdpbmRvd1xuICAgICAgbVdpbi5jbGFzc0xpc3QucmVwbGFjZShcbiAgICAgICAgb3B0aW9ucy5jbGFzc0FuaW1hdGlvbi5jbG9zZSxcbiAgICAgICAgb3B0aW9ucy5jbGFzc0FuaW1hdGlvbi5vcGVuXG4gICAgICApO1xuICAgIH0sIDYwMCk7XG4gIH07IC8vIGZuQ2xvc2VcblxuICBmbk9wZW4gPSAobW9kYWxPYmplY3QpID0+IHtcbiAgICBpZiAoIW1vZGFsT2JqZWN0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbGV0IGN1c3RvbUV2ZW50O1xuICAgIGNvbnN0IGh0bWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJyk7XG4gICAgY29uc3QgbVdpbiA9IG1vZGFsT2JqZWN0LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC13aW5kb3cnKTtcblxuICAgIC8vIEhhbmRsZSB0aGUgRVNDIGRpc21pc3NcbiAgICBmbkVzYyA9IGZ1bmN0aW9uIGVzY0hhbmRsZXIoZSkge1xuICAgICAgY29uc3Qga2V5ID0gZS5rZXlDb2RlIHx8IGUud2hpY2g7XG5cbiAgICAgIC8vIFdoZW4gdGhlIEVTQyBrZXkgaXMgcHJlc3NlZFxuICAgICAgaWYgKGtleSA9PT0gMjcpIHtcbiAgICAgICAgZm5DbG9zZShtb2RhbE9iamVjdCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGlmICghbVdpbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEFkZCAoYW5kIHJlbW92ZSkgYW4gRVNDIGhhbmRsZXIgZm9yIHRoZSBvdmVybGF5XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZuRXNjKTtcblxuICAgIC8vIENsZWFyIGlubGluZSBkaXNwbGF5IHN0eWxlLCBpZiBhbnlcbiAgICBtb2RhbE9iamVjdC5zdHlsZS5kaXNwbGF5ID0gJyc7XG4gICAgLy8gQWRkIGFuaW1hdGlvbiB0byB0aGUgb3ZlcmxheVxuICAgIG1vZGFsT2JqZWN0LmNsYXNzTGlzdC5hZGQoJ2FuaW1hdGVkJywgJ2ZhZGVJbicsICdmYXN0Jyk7XG4gICAgLy8gQWRkIGFuaW1hdGlvbiB0byB0aGUgbW9kYWwgd2luZG93XG4gICAgbVdpbi5jbGFzc0xpc3QuYWRkKCdhbmltYXRlZCcsIG9wdGlvbnMuY2xhc3NBbmltYXRpb24ub3Blbik7XG4gICAgLy8gU2hvdyB0aGUgY29tcG9uZW50XG4gICAgbW9kYWxPYmplY3QuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpO1xuICAgIC8vIEZpbmFsbHkgcHJldmVudCBzY3JvbGxpbmdcbiAgICBodG1sLnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XG5cbiAgICAvLyBXYWl0IHRoZSBhbmltYXRpb24gY29tcGxldGUgdG8gZGlzcGF0Y2ggdGhlIGV2ZW50XG4gICAgLy8gRWFjaCBhbmltYXRlLmNzcyBhbmltYXRpb24gdGFrZXMgMXNcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIC8vIERpc3BhdGNoIHRoZSAnbW9kYWwub3BlbmVkJyBldmVudFxuICAgICAgY3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ21vZGFsLm9wZW5lZCcpO1xuICAgICAgbW9kYWxPYmplY3QuZGlzcGF0Y2hFdmVudChjdXN0b21FdmVudCk7XG4gICAgfSwgMTAwKTtcbiAgfTsgLy8gZm5PcGVuXG5cbiAgaWYgKG1vZGFscyAhPT0gbnVsbCkge1xuICAgIG1vZGFscy5mb3JFYWNoKChtb2RhbCwgaSkgPT4ge1xuICAgICAgLy8gSGFuZGxlIHRoZSBkaXNtaXNzIGJ1dHRvbnNcbiAgICAgIGNvbnN0IGRpc21pc3NhbHMgPSBtb2RhbC5xdWVyeVNlbGVjdG9yQWxsKCdbcm9sZT1cIm1vZGFsLWRpc21pc3NcIl0nKTtcblxuICAgICAgLy8gQWRkIChhbmQgcmVtb3ZlKSBhIGNsaWNrIGhhbmRsZXIgb24gdGhlIG92ZXJsYXlcbiAgICAgIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBmbkNsb3NlKG1vZGFsKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBBZGQgcHJvdG90eXBlIGZvciBzaG93IChvcGVuKVxuICAgICAgbW9kYWwuc2hvdyA9ICgpID0+IHtcbiAgICAgICAgZm5PcGVuKG1vZGFsKTtcbiAgICAgIH07XG5cbiAgICAgIC8vIEFkZCBwcm90b3R5cGUgZm9yIGhpZGUgKGNsb2RlKVxuICAgICAgbW9kYWwuaGlkZSA9ICgpID0+IHtcbiAgICAgICAgZm5DbG9zZShtb2RhbCk7XG4gICAgICB9O1xuXG4gICAgICBpZiAoZGlzbWlzc2FscyAhPT0gbnVsbCkge1xuICAgICAgICBkaXNtaXNzYWxzLmZvckVhY2goKGRpc21pc3MsIGopID0+IHtcbiAgICAgICAgICBkaXNtaXNzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2dCkge1xuICAgICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmbkNsb3NlKG1vZGFsKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9IC8vIGlmIChkaXNtaXNzYWxzICE9PSBudWxsKVxuICAgIH0pO1xuICB9IC8vIGlmIChtb2RhbHMgIT09IG51bGwpXG5cbiAgaWYgKG1vZGFsVHJpZ2dlcnMgIT09IG51bGwpIHtcbiAgICBtb2RhbFRyaWdnZXJzLmZvckVhY2goKHRyaWdnZXIsIGkpID0+IHtcbiAgICAgIHRyaWdnZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB7XG4gICAgICAgIGlmIChldnQpIHtcbiAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlZiA9IHRyaWdnZXIuZ2V0QXR0cmlidXRlKCdkYXRhLW1vZGFsLWlkJyk7XG5cbiAgICAgICAgaWYgKHJlZiAhPT0gbnVsbCkge1xuICAgICAgICAgIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7cmVmfWApO1xuICAgICAgICAgIGZuT3Blbihtb2RhbCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9IC8vIGlmIChtb2RhbFRyaWdnZXJzICE9PSBudWxsKVxuXG4gIG1vZGFsVHJpZ2dlcnMgPSB1bmRlZmluZWQ7XG5cbiAgcmV0dXJuIHtcbiAgICBnZXQ6IChpZHgpID0+IHtcbiAgICAgIGlmICh0eXBlb2YgaWR4ID09PSAnc3RyaW5nJykge1xuICAgICAgICBsZXQgbW9kYWwgPSBmYWxzZTtcblxuICAgICAgICBtb2RhbHMuZm9yRWFjaCgobm9kZSkgPT4ge1xuICAgICAgICAgIGlmIChub2RlLmlkID09PSBpZHgucmVwbGFjZSgvXiMvLCAnJykpIHtcbiAgICAgICAgICAgIG1vZGFsID0gbm9kZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBtb2RhbDtcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiBtb2RhbHNbaWR4XSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuIG1vZGFsc1tpZHhdO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9O1xufTsgLy8gc2VlZE1vZGFsXG5cbmlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xuICBtb2R1bGUuZXhwb3J0cy5zZWVkTW9kYWwgPSBzZWVkTW9kYWw7XG59XG5cbi8vIEV4cG9zZSBTZWVkQ1NTIGluIHRoZSBnbG9iYWwgc2NvcGVcbmlmICh0eXBlb2Ygd2luZG93LlNlZWRDU1MgPT09ICd1bmRlZmluZWQnKSB7XG4gIHdpbmRvdy5TZWVkQ1NTID0ge307XG59XG5cbi8vIEV4cG9zZSBtb2RhbCBtZW51IGluIHRoZSBnbG9iYWwgc2NvcGVcbndpbmRvdy5TZWVkQ1NTLm1vZGFsID0gc2VlZE1vZGFsO1xuIiwiLyoqIVxuICogU2VlZC1DU1MgLSBPZmYtQ2FudmFzLlxuICogQGNvcHlyaWdodCAyMDE5LCBBYnR6IExhYnNcbiAqIEBsaWNlbnNlIE1JVFxuICovXG5cbmNvbnN0IHNlZWRPZmZDYW52YXMgPSBmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICBjb25zdCBvcGVuZWRPZmZjYW52YXNDbGFzcyA9ICdjYW52YXMtb3BlbmVkJztcblxuICBjb25zdCBmbk91dHNpZGVDbGlja0hhbmRsZXIgPSBmdW5jdGlvbihldikge1xuICAgIGxldCBhID0gZXYudGFyZ2V0O1xuICAgIGxldCBmb3VuZCA9IGZhbHNlO1xuXG4gICAgY29uc3QgaHRtbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKTtcblxuICAgIHdoaWxlICghZm91bmQpIHtcbiAgICAgIGlmICghYSB8fCAhYS5wYXJlbnROb2RlKSB7XG4gICAgICAgIC8vIEl0IHNlZW1zIHdlJ3ZlIHJlYWNoZWQgdGhlIHJvb3QgKGh0bWwpXG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICBpZiAoYS5jbGFzc0xpc3QgJiYgIWEuY2xhc3NMaXN0LmNvbnRhaW5zKCdvZmZjYW52YXMnKSkge1xuICAgICAgICAvLyBOZWl0aGVyIGZvdW5kIC5jYW52YXMgbm9yIHRoZSByb290IGxldmVsXG4gICAgICAgIGEgPSBhLnBhcmVudE5vZGU7XG4gICAgICB9IGVsc2UgaWYgKGEuY2xhc3NMaXN0KSB7XG4gICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIWZvdW5kICYmIGh0bWwuY2xhc3NMaXN0LmNvbnRhaW5zKG9wZW5lZE9mZmNhbnZhc0NsYXNzKSkge1xuICAgICAgLy8gSXQgc2VlbXMgaGFzIGhhcHBlbmVkIGFuIG91dHNpZGVyIGNsaWNrXG4gICAgICBmblRvZ2dsZShodG1sLmdldEF0dHJpYnV0ZSgnZGF0YS1jYW52YXMtaWQnKSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IGZuVG9nZ2xlID0gKGNhbnZhc0lELCB0cmlnZ2VyRWxlbWVudCkgPT4ge1xuICAgIGxldCBjdXN0b21FdmVudDtcblxuICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2NhbnZhc0lELnJlcGxhY2UoL14jLywgJycpfWApO1xuXG4gICAgY29uc3QgdHJpZ2dlciA9XG4gICAgICB0cmlnZ2VyRWxlbWVudCB8fFxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgYFtyb2xlPVwib2ZmY2FudmFzXCJdW2RhdGEtaWQ9XCIke2NhbnZhc0lELnJlcGxhY2UoL14jLywgJycpfVwiXWBcbiAgICAgICk7XG5cbiAgICBpZiAoY2FudmFzICE9PSBudWxsKSB7XG4gICAgICBjb25zdCBodG1sID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaHRtbCcpO1xuXG4gICAgICBpZiAoIWh0bWwuY2xhc3NMaXN0LmNvbnRhaW5zKG9wZW5lZE9mZmNhbnZhc0NsYXNzKSkge1xuICAgICAgICBjYW52YXMuY2xhc3NMaXN0LmFkZCgnb3BlbicpO1xuXG4gICAgICAgIGlmICh0cmlnZ2VyICE9PSBudWxsKSB7XG4gICAgICAgICAgLy8gQWRkIHRoZSAndHJpZ2dlcmVkJyBjbGFzcyB0byB0aGUgZWxlbWVudCB3aGljaCBoYXMgdHJpZ2dlcmVkIHRoZSBvZmZjYW52YXMuXG4gICAgICAgICAgdHJpZ2dlci5jbGFzc0xpc3QuYWRkKCd0cmlnZ2VyZWQnKTtcbiAgICAgICAgfSAvLyBpZiAodHJpZ2dlciAhPT0gbnVsbClcblxuICAgICAgICAvLyBQcmV2ZW50cyBtYWluIHRvIHNjcm9sbFxuICAgICAgICBodG1sLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZm5PdXRzaWRlQ2xpY2tIYW5kbGVyKTtcbiAgICAgICAgaHRtbC5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY2FudmFzLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW4nKTtcblxuICAgICAgICAvLyBSZW1vdmUgdGhlICd0cmlnZ2VyZWQnIGNsYXNzIGZvciBhbnkgZXhpc3RpbmcgdHJpZ2dlciB3aGljaCByZWZlcnMgZ2l2ZW4gb2ZmY2FudmFzLlxuICAgICAgICBkb2N1bWVudFxuICAgICAgICAgIC5xdWVyeVNlbGVjdG9yQWxsKFxuICAgICAgICAgICAgYFtyb2xlPVwib2ZmY2FudmFzXCJdW2RhdGEtaWQ9XCIke2NhbnZhc0lELnJlcGxhY2UoL14jLywgJycpfVwiXWBcbiAgICAgICAgICApXG4gICAgICAgICAgLmZvckVhY2goKHRncikgPT4ge1xuICAgICAgICAgICAgdGdyLmNsYXNzTGlzdC5yZW1vdmUoJ3RyaWdnZXJlZCcpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgIC8vIFJlLWVuYWJsZXMgbWFpbiBzY3JvbGxpbmdcbiAgICAgICAgaHRtbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGZuT3V0c2lkZUNsaWNrSGFuZGxlcik7XG4gICAgICAgIGh0bWwuc3R5bGUub3ZlcmZsb3cgPSAnJztcbiAgICAgIH1cblxuICAgICAgLy8gV2FpdCB1bnRpbCBhbmltYXRpb24gaXMgY29tcGxldGUgdG8gZGlzcGF0Y2ggdGhlIGV2ZW50XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgaWYgKGNhbnZhcy5jbGFzc0xpc3QuY29udGFpbnMoJ29wZW4nKSkge1xuICAgICAgICAgIGh0bWwuY2xhc3NMaXN0LmFkZChvcGVuZWRPZmZjYW52YXNDbGFzcyk7XG4gICAgICAgICAgaHRtbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtY2FudmFzLWlkJywgY2FudmFzSUQucmVwbGFjZSgvXiMvLCAnJykpO1xuICAgICAgICAgIGN1c3RvbUV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdjYW52YXMub3BlbmVkJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaHRtbC5jbGFzc0xpc3QucmVtb3ZlKG9wZW5lZE9mZmNhbnZhc0NsYXNzKTtcbiAgICAgICAgICBjdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudCgnY2FudmFzLmNsb3NlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGlzcGF0Y2ggdGhlICdjYW52YXMub3BlbmVkJy8gJ2NhbnZhcy5jbG9zZWQnIGV2ZW50c1xuICAgICAgICBjYW52YXMuZGlzcGF0Y2hFdmVudChjdXN0b21FdmVudCk7XG4gICAgICB9LCAzMDApO1xuICAgIH0gLy8gaWYgKGNhbnZhcyAhPT0gbnVsbClcbiAgfTsgLy8gZm5Ub2dnbGVcblxuICBjb25zdCBmblRyaWdnZXJDbGljayA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0KSB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG5cbiAgICBmblRvZ2dsZShcbiAgICAgIGV2dC5jdXJyZW50VGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1pZCcpIHx8ICdvZmZjYW52YXMnLFxuICAgICAgZXZ0LmN1cnJlbnRUYXJnZXRcbiAgICApO1xuICB9OyAvLyBmblRyaWdnZXJDbGlja1xuXG4gIC8vIEZpbmQgYWxsIGV4aXN0aW5nIHRyaWdnZXJzXG4gIGNvbnN0IHRyaWdnZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW3JvbGU9XCJvZmZjYW52YXNcIl0nKTtcblxuICAvLyBGaW5kIGFsbCBleGlzdGluZyBvZmZjYW52YXNcbiAgY29uc3QgY2FudmFzZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcub2ZmY2FudmFzJyk7XG5cbiAgaWYgKHRyaWdnZXJzICE9PSBudWxsKSB7XG4gICAgdHJpZ2dlcnMuZm9yRWFjaChmdW5jdGlvbih0cmlnZ2VyLCBpKSB7XG4gICAgICB0cmlnZ2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZm5UcmlnZ2VyQ2xpY2ssIGZhbHNlKTtcbiAgICB9KTsgLy8gdHJpZ2dlcnMuZm9yRWFjaChmdW5jdGlvbih0cmlnZ2VyLCBpKVxuICB9IC8vIGlmICh0cmlnZ2VycyAhPT0gbnVsbClcblxuICBpZiAoY2FudmFzZXMgIT09IG51bGwpIHtcbiAgICBjYW52YXNlcy5mb3JFYWNoKChjYW52YXMsIGkpID0+IHtcbiAgICAgIC8vIEF0dGFjaCBtZXRob2QgZm9yIG9wZW5pbmdcbiAgICAgIGNhbnZhcy5vcGVuID0gKCkgPT4ge1xuICAgICAgICBmblRvZ2dsZShjYW52YXMuZ2V0QXR0cmlidXRlKCdpZCcpIHx8ICdvZmZjYW52YXMnKTtcbiAgICAgIH07IC8vIG9wZW5cblxuICAgICAgLy8gQXR0YWNoIG1ldGhvZCBmb3IgY2xvc2luZ1xuICAgICAgY2FudmFzLmNsb3NlID0gKCkgPT4ge307IC8vIGNsb3NlXG4gICAgfSk7IC8vIGNhbnZhc2VzLmZvckVhY2goKGNhbnZhcywgaSlcbiAgfSAvLyBpZiAoY2FudmFzZXMgIT09IG51bGwpXG5cbiAgcmV0dXJuIHtcbiAgICBnZXQ6IChpZHgpID0+IHtcbiAgICAgIGlmICh0eXBlb2YgaWR4ID09PSAnc3RyaW5nJykge1xuICAgICAgICBsZXQgY2FudmFzID0gZmFsc2U7XG5cbiAgICAgICAgY2FudmFzZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xuICAgICAgICAgIGlmIChub2RlLmlkID09PSBpZHgucmVwbGFjZSgvXiMvLCAnJykpIHtcbiAgICAgICAgICAgIGNhbnZhcyA9IG5vZGU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gY2FudmFzO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIGNhbnZhc1tpZHhdICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm4gY2FudmFzW2lkeF07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG59OyAvLyBzZWVkT2ZmQ2FudmFzXG5cbmlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xuICBtb2R1bGUuZXhwb3J0cy5zZWVkT2ZmQ2FudmFzID0gc2VlZE9mZkNhbnZhcztcbn1cblxuLy8gRXhwb3NlIFNlZWRDU1MgaW4gdGhlIGdsb2JhbCBzY29wZVxuaWYgKHR5cGVvZiB3aW5kb3cuU2VlZENTUyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgd2luZG93LlNlZWRDU1MgPSB7fTtcbn1cblxuLy8gRXhwb3NlIG9mZmNhbnZhcyBtZW51IGluIHRoZSBnbG9iYWwgc2NvcGVcbndpbmRvdy5TZWVkQ1NTLm9mZkNhbnZhcyA9IHNlZWRPZmZDYW52YXM7XG4iLCIvKiohXG4gKiBTZWVkLUNTUyAtIFNjcm9sbC5cbiAqIEBjb3B5cmlnaHQgMjAxOSwgQWJ0eiBMYWJzXG4gKiBAbGljZW5zZSBNSVRcbiAqL1xuXG5jb25zdCBzZWVkU2Nyb2xsID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAndXNlIHN0cmljdCc7XG5cbiAgbGV0IHRyaWdnZXJzID0gbnVsbDtcblxuICBsZXQgcmV2ZWFsZXJzID0gbnVsbDtcblxuICBsZXQgc2Nyb2xsVGFyZ2V0ID0gMDtcblxuICBjb25zdCBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICBzcHlTY3JvbGxTZWxlY3RvcjogJ25hdiBhLnNtb290aCcsXG4gICAgcmV2ZWFsRWxlbWVudFNlbGVjdG9yOiAnLnJldmVhbCcsXG4gICAgcmV2ZWFsU3BhY2VPZmZzZXQ6IDAuMixcbiAgICByZXZlYWxXaGVuVmlzaWJsZTogJ3Zpc2libGUnLFxuICAgIHJldmVhbFNpbmdsZUFuaW1hdGlvbjogJ3Zpc2libGUtb25jZScsXG4gICAgcmV2ZWFsV2hlbkhpZGRlbjogJ2hpZGRlbicsXG4gICAgZ3V0dGVyOiA1MFxuICB9OyAvLyBkZWZhdWx0T3B0aW9uc1xuXG4gIGNvbnN0IGZuVXBkYXRlQWN0aXZlVHJpZ2dlciA9IChlbGVtKSA9PiB7XG4gICAgdHJpZ2dlcnMuZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgIH0pO1xuXG4gICAgaWYgKGVsZW0pIHtcbiAgICAgIGVsZW0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgfVxuICB9OyAvLyBmblVwZGF0ZUFjdGl2ZVRyaWdnZXJcblxuICBjb25zdCBmbkdldE9mZnNldCA9IChlbGVtKSA9PiB7XG4gICAgY29uc3QgYm9keU9mZnNldCA9IGRvY3VtZW50LmJvZHkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgY29uc3Qgb2Zmc2V0ID0gZWxlbSA/IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiAwO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvcDogTWF0aC5jZWlsKG9mZnNldC50b3AgLSBib2R5T2Zmc2V0LnRvcCksXG4gICAgICBsZWZ0OiBNYXRoLmNlaWwob2Zmc2V0LmxlZnQgLSBib2R5T2Zmc2V0LmxlZnQpXG4gICAgfTtcbiAgfTsgLy8gZm5HZXRPZmZzZXRcblxuICBjb25zdCBmblNjcm9sbENvbXBsZXRlID0gKGV2dCkgPT4ge1xuICAgIGlmICh3aW5kb3cuc2Nyb2xsWSA9PT0gc2Nyb2xsVGFyZ2V0KSB7XG4gICAgICBjb25zdCBzZWVkQ3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ3Njcm9sbC5jb21wbGV0ZScpO1xuICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChzZWVkQ3VzdG9tRXZlbnQpO1xuICAgIH1cblxuICAgIGlmICh0cmlnZ2Vycykge1xuICAgICAgY29uc3QgZmlyc3RFbGVtZW50T2Zmc2V0ID0gZm5HZXRPZmZzZXQodHJpZ2dlcnNbMF0pO1xuXG4gICAgICBpZiAod2luZG93LnNjcm9sbFkgPCBmaXJzdEVsZW1lbnRPZmZzZXQudG9wKSB7XG4gICAgICAgIGZuVXBkYXRlQWN0aXZlVHJpZ2dlcigpO1xuICAgICAgfVxuXG4gICAgICB0cmlnZ2Vycy5mb3JFYWNoKChlbCwgaSkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHRhcmdldElEID1cbiAgICAgICAgICAgIGVsLmdldEF0dHJpYnV0ZSgnaHJlZicpIHx8IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQnKTtcblxuICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGFyZ2V0SUQpO1xuICAgICAgICAgIGNvbnN0IG9mZnNldCA9IGZuR2V0T2Zmc2V0KHRhcmdldCk7XG5cbiAgICAgICAgICBpZiAob2Zmc2V0LnRvcCAtIG9wdGlvbnMuZ3V0dGVyIDw9IHdpbmRvdy5zY3JvbGxZKSB7XG4gICAgICAgICAgICBmblVwZGF0ZUFjdGl2ZVRyaWdnZXIoZWwpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2Ygd2luZG93Lm9sZE9uc2Nyb2xsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICB3aW5kb3cub2xkT25zY3JvbGwoZXZ0KTtcbiAgICB9XG4gIH07IC8vIGZuU2Nyb2xsQ29tcGxldGVcblxuICBjb25zdCBmblRyaWdnZXJDbGljayA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0KSB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG5cbiAgICBjb25zdCB0YXJnZXQgPVxuICAgICAgZXZ0LmN1cnJlbnRUYXJnZXQuZ2V0QXR0cmlidXRlKCdocmVmJykgfHxcbiAgICAgIGV2dC5jdXJyZW50VGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQnKTtcblxuICAgIGlmICh0YXJnZXQpIHtcbiAgICAgIGNvbnN0IGVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhcmdldCk7XG5cbiAgICAgIHNjcm9sbFRhcmdldCA9IGZuR2V0T2Zmc2V0KGVsZW0pLnRvcCAtIG9wdGlvbnMuZ3V0dGVyOyAvLyBhZGQgc29tZSBndXR0ZXJcblxuICAgICAgd2luZG93LnNjcm9sbFRvKHtcbiAgICAgICAgYmVoYXZpb3I6ICdzbW9vdGgnLFxuICAgICAgICBsZWZ0OiAwLFxuICAgICAgICB0b3A6IHNjcm9sbFRhcmdldFxuICAgICAgfSk7XG4gICAgfVxuICB9OyAvLyBmblRyaWdnZXJDbGlja1xuXG4gIGNvbnN0IGZuV2F0Y2hFbGVtZW50cyA9ICgpID0+IHtcbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIHZpZXdwb3J0ICh3aW5kb3cpIGRpbWVuc2lvbnMuXG4gICAgICogQHJldHVybiBvYmplY3RcbiAgICAgKi9cbiAgICBjb25zdCBnZXRWaWV3cG9ydFNpemUgPSAoKSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB3aWR0aDogd2luZG93LmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCxcbiAgICAgICAgaGVpZ2h0OiB3aW5kb3cuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodFxuICAgICAgfTtcbiAgICB9OyAvLyBnZXRWaWV3cG9ydFNpemVcblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudCBzY29sbCBwb3NpdGlvbi5cbiAgICAgKiBAcmV0dXJuIG9iamVjdFxuICAgICAqL1xuICAgIGNvbnN0IGdldEN1cnJlbnRTY3JvbGwgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHg6IHdpbmRvdy5wYWdlWE9mZnNldCxcbiAgICAgICAgeTogd2luZG93LnBhZ2VZT2Zmc2V0XG4gICAgICB9O1xuICAgIH07IC8vIGdldEN1cnJlbnRTY3JvbGxcblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGVsZW1lbnQgZGltZW5zaW9uIGFuZCBwb3NpdGlvbi5cbiAgICAgKiBAcGFyYW0gSFRNTEVsZW1lbnQgZWxcbiAgICAgKiBAcmV0dXJuIG9iamVjdFxuICAgICAqL1xuICAgIGNvbnN0IGdldEVsZW1JbmZvID0gKGVsKSA9PiB7XG4gICAgICBsZXQgZWxlbSA9IGVsO1xuICAgICAgbGV0IG9mZnNldFRvcCA9IDA7XG4gICAgICBsZXQgb2Zmc2V0TGVmdCA9IDA7XG4gICAgICBjb25zdCBvZmZzZXRXaWR0aCA9IGVsZW0ub2Zmc2V0V2lkdGg7XG4gICAgICBjb25zdCBvZmZzZXRIZWlnaHQgPSBlbGVtLm9mZnNldEhlaWdodDtcblxuICAgICAgZG8ge1xuICAgICAgICBpZiAoIWlzTmFOKGVsZW0ub2Zmc2V0VG9wKSkge1xuICAgICAgICAgIG9mZnNldFRvcCArPSBlbGVtLm9mZnNldFRvcDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaXNOYU4oZWxlbS5vZmZzZXRMZWZ0KSkge1xuICAgICAgICAgIG9mZnNldExlZnQgKz0gZWxlbS5vZmZzZXRMZWZ0O1xuICAgICAgICB9XG4gICAgICB9IHdoaWxlICgoZWxlbSA9IGVsZW0ub2Zmc2V0UGFyZW50KSAhPT0gbnVsbCk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvcDogb2Zmc2V0VG9wLFxuICAgICAgICBsZWZ0OiBvZmZzZXRMZWZ0LFxuICAgICAgICBoZWlnaHQ6IG9mZnNldEhlaWdodCxcbiAgICAgICAgd2lkdGg6IG9mZnNldFdpZHRoXG4gICAgICB9O1xuICAgIH07IC8vIGdldEVsZW1JbmZvXG5cbiAgICAvKipcbiAgICAgKiBJZGVudGlmaWVzIHdoZXRoZXIgdGhlIGVsZW1lbnQgaXMgdmlzaWJsZSBpbiB0aGUgdmlld3BvcnQuXG4gICAgICogQHBhcmFtIEhUTUxFbGVtZW50IGVsZW1cbiAgICAgKiBAcmV0dXJuIGJvb2xlYW5cbiAgICAgKi9cbiAgICBjb25zdCBpc0VsZW1lbnRWaXNpYmxlID0gKGVsZW0pID0+IHtcbiAgICAgIGNvbnN0IHZpZXdwb3J0U2l6ZSA9IGdldFZpZXdwb3J0U2l6ZSgpO1xuICAgICAgY29uc3QgY3VycmVudFNjcm9sbCA9IGdldEN1cnJlbnRTY3JvbGwoKTtcbiAgICAgIGNvbnN0IGVJbmYgPSBnZXRFbGVtSW5mbyhlbGVtKTtcbiAgICAgIGNvbnN0IHNwYWNlT2Zmc2V0ID0gb3B0aW9ucy5yZXZlYWxTcGFjZU9mZnNldDtcblxuICAgICAgY29uc3QgY2hlY2tCb3VuZGFyaWVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIFRoZSBlbGVtZW50IGJvdW5kYXJpZXNcbiAgICAgICAgY29uc3QgZVRvcCA9IGVJbmYudG9wICsgZUluZi5oZWlnaHQgKiBzcGFjZU9mZnNldDtcbiAgICAgICAgY29uc3QgZUxlZnQgPSBlSW5mLmxlZnQgKyBlSW5mLndpZHRoICogc3BhY2VPZmZzZXQ7XG4gICAgICAgIGNvbnN0IGVSaWdodCA9IGVJbmYubGVmdCArIGVJbmYud2lkdGggLSBlSW5mLndpZHRoICogc3BhY2VPZmZzZXQ7XG4gICAgICAgIGNvbnN0IGVCb3R0b20gPSBlSW5mLnRvcCArIGVJbmYuaGVpZ2h0IC0gZUluZi5oZWlnaHQgKiBzcGFjZU9mZnNldDtcblxuICAgICAgICAvLyBUaGUgd2luZG93IGJvdW5kYXJpZXNcbiAgICAgICAgY29uc3Qgd1RvcCA9IGN1cnJlbnRTY3JvbGwueSArIDA7XG4gICAgICAgIGNvbnN0IHdMZWZ0ID0gY3VycmVudFNjcm9sbC54ICsgMDtcbiAgICAgICAgY29uc3Qgd0JvdHRvbSA9IGN1cnJlbnRTY3JvbGwueSAtIDAgKyB2aWV3cG9ydFNpemUuaGVpZ2h0O1xuICAgICAgICBjb25zdCB3UmlnaHQgPSBjdXJyZW50U2Nyb2xsLnggLSAwICsgdmlld3BvcnRTaXplLndpZHRoO1xuXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBlbGVtZW50IGlzIHdpdGhpbiBib3VuZGFyeVxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIGVUb3AgPCB3Qm90dG9tICYmIGVCb3R0b20gPiB3VG9wICYmIGVMZWZ0ID4gd0xlZnQgJiYgZVJpZ2h0IDwgd1JpZ2h0XG4gICAgICAgICk7XG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gY2hlY2tCb3VuZGFyaWVzKCk7XG4gICAgfTsgLy8gaXNFbGVtZW50VmlzaWJsZVxuXG4gICAgLyoqXG4gICAgICogV2F0Y2ggdGhlIHRhcmdldCBlbGVtZW50cyB3aXRoIGEgbG9vcCB0byBpZGVudGlmeSB3aGljaCBvbmUgaXMgaW5zaWRlIHRoZSB2aWV3cG9ydC5cbiAgICAgKiBJZiBmb3VuZCwgdGhlIGVsZW1lbnQgZ2V0cyBhIGNsYXNzIGRlZmluZWQgaW4gdGhlIG9wdGlvbnMuXG4gICAgICogQHJldHVybiB2b2lkXG4gICAgICovXG4gICAgY29uc3QgdG9nZ2xlRWxlbWVudCA9ICgpID0+IHtcbiAgICAgIGlmICghcmV2ZWFsZXJzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXZlYWxlcnMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgaWYgKGlzRWxlbWVudFZpc2libGUocmV2ZWFsZXJzW2ldKSkge1xuICAgICAgICAgIGlmIChvcHRpb25zLnJldmVhbFdoZW5WaXNpYmxlKSB7XG4gICAgICAgICAgICByZXZlYWxlcnNbaV0uY2xhc3NMaXN0LmFkZChvcHRpb25zLnJldmVhbFdoZW5WaXNpYmxlKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAob3B0aW9ucy5yZXZlYWxXaGVuSGlkZGVuKSB7XG4gICAgICAgICAgICByZXZlYWxlcnNbaV0uY2xhc3NMaXN0LnJlbW92ZShvcHRpb25zLnJldmVhbFdoZW5IaWRkZW4pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICByZXZlYWxlcnNbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKG9wdGlvbnMucmV2ZWFsU2luZ2xlQW5pbWF0aW9uKSA9PT1cbiAgICAgICAgICAgIGZhbHNlXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5yZXZlYWxXaGVuSGlkZGVuKSB7XG4gICAgICAgICAgICAgIHJldmVhbGVyc1tpXS5jbGFzc0xpc3QuYWRkKG9wdGlvbnMucmV2ZWFsV2hlbkhpZGRlbik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25zLnJldmVhbFdoZW5WaXNpYmxlKSB7XG4gICAgICAgICAgICAgIHJldmVhbGVyc1tpXS5jbGFzc0xpc3QucmVtb3ZlKG9wdGlvbnMucmV2ZWFsV2hlblZpc2libGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07IC8vIHRvZ2dsZUVsZW1lbnRcblxuICAgIC8qKlxuICAgICAqIEEgaGFuZGxlciBmb3Igc2Nyb2xsaW5nIGFuZCByZXNpemluZ1xuICAgICAqIEBwYXJhbSB3aW5kb3cuRXZlbnQgZXZ0XG4gICAgICogQHJldHVybiB2b2lkXG4gICAgICovXG4gICAgY29uc3Qgc2Nyb2xsUmVzaXplSGFuZGxlciA9IChldnQpID0+IHtcbiAgICAgIHRvZ2dsZUVsZW1lbnQoKTtcbiAgICB9O1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHNjcm9sbFJlc2l6ZUhhbmRsZXIsIGZhbHNlKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgc2Nyb2xsUmVzaXplSGFuZGxlciwgZmFsc2UpO1xuICB9OyAvLyBmbldhdGNoRWxlbWVudHNcblxuICB3aW5kb3cub2xkT25zY3JvbGwgPSB3aW5kb3cub25zY3JvbGw7XG4gIHdpbmRvdy5vbnNjcm9sbCA9IGZuU2Nyb2xsQ29tcGxldGU7XG5cbiAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcblxuICAvLyBGaW5kIGFsbCBleGlzdGluZyB0cmlnZ2VycyBmb3Igc21vb3RoIHNjcm9sbGluZ1xuICB0cmlnZ2VycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwob3B0aW9ucy5zcHlTY3JvbGxTZWxlY3Rvcik7XG5cbiAgLy8gRmluZCBhbGwgZXhpc3RpbmcgdGFyZ2V0cyBmb3Igd2F0Y2hpbmcgdGhlIHZpZXdwb3J0XG4gIHJldmVhbGVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwob3B0aW9ucy5yZXZlYWxFbGVtZW50U2VsZWN0b3IpO1xuXG4gIGlmICh0cmlnZ2VycyAhPT0gbnVsbCkge1xuICAgIHRyaWdnZXJzLmZvckVhY2goZnVuY3Rpb24odHJpZ2dlciwgaSkge1xuICAgICAgdHJpZ2dlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZuVHJpZ2dlckNsaWNrLCBmYWxzZSk7XG4gICAgfSk7IC8vIHRyaWdnZXJzLmZvckVhY2goZnVuY3Rpb24odHJpZ2dlciwgaSlcbiAgfSAvLyBpZiAodHJpZ2dlcnMgIT09IG51bGwpXG5cbiAgaWYgKHJldmVhbGVycykge1xuICAgIGZuV2F0Y2hFbGVtZW50cygpO1xuICB9XG5cbiAgcmV0dXJuIHt9O1xufTsgLy8gc2VlZFNjcm9sbFxuXG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgbW9kdWxlLmV4cG9ydHMuc2VlZFNjcm9sbCA9IHNlZWRTY3JvbGw7XG59XG5cbi8vIEV4cG9zZSBTZWVkQ1NTIGluIHRoZSBnbG9iYWwgc2NvcGVcbmlmICh0eXBlb2Ygd2luZG93LlNlZWRDU1MgPT09ICd1bmRlZmluZWQnKSB7XG4gIHdpbmRvdy5TZWVkQ1NTID0ge307XG59XG5cbi8vIEV4cG9zZSBzY3JvbGwgaW4gdGhlIGdsb2JhbCBzY29wZVxud2luZG93LlNlZWRDU1Muc2Nyb2xsID0gc2VlZFNjcm9sbDtcbiIsIi8qKiFcbiAqIFNlZWQtQ1NTIC0gQWRkaXRpb25hbCBmZWF0dXJlcyBmb3IgSFRNTCBUZXh0YXJlYXMuXG4gKiBAY29weXJpZ2h0IDIwMTksIEFidHogTGFic1xuICogQGxpY2Vuc2UgTUlUXG4gKi9cblxuY29uc3Qgc2VlZFRleHRhcmVhID0gZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvLyBGaW5kIGFsbCBzZWVkLWZpbGUgaW5wdXRzLlxuICBjb25zdCBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmllbGQgPiB0ZXh0YXJlYScpO1xuXG4gIGlmIChpbnB1dHMgIT09IG51bGwpIHtcbiAgICBpbnB1dHMuZm9yRWFjaChmdW5jdGlvbihpbnB1dCwgaSkge1xuICAgICAgbGV0IG1heExlbmd0aCA9IDA7XG5cbiAgICAgIGNvbnN0IHBhcmVudCA9IGlucHV0LnBhcmVudE5vZGU7XG4gICAgICBjb25zdCBjb3VudGVyTGFiZWwgPSBwYXJlbnQucXVlcnlTZWxlY3RvcignW3JvbGU9XCJjb3VudGVyXCJdJyk7XG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9XG4gICAgICAgIGNvdW50ZXJMYWJlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGVtcGxhdGUnKSB8fFxuICAgICAgICAnVHlwZWQgJWEgb3V0IG9mICViLiBSZW1haW5pbmcgJWMuJztcblxuICAgICAgY29uc3QgZm5DYWxjID0gKCkgPT4ge1xuICAgICAgICBjb25zdCB0eXBlZCA9IGlucHV0LnZhbHVlLnJlcGxhY2UoL1tcXG5cXHJdL2csICcnKS5sZW5ndGg7XG4gICAgICAgIGNvbnN0IHJlbWFpbmluZyA9IG1heExlbmd0aCAtIHR5cGVkO1xuICAgICAgICBjb25zdCBtaW5MZW5ndGggPSBNYXRoLmZsb29yKG1heExlbmd0aCAqIDAuMSk7XG5cbiAgICAgICAgY291bnRlckxhYmVsLmlubmVySFRNTCA9IHRlbXBsYXRlXG4gICAgICAgICAgLnJlcGxhY2UoJyVhJywgdHlwZWQpXG4gICAgICAgICAgLnJlcGxhY2UoJyViJywgbWF4TGVuZ3RoKVxuICAgICAgICAgIC5yZXBsYWNlKFxuICAgICAgICAgICAgJyVjJyxcbiAgICAgICAgICAgIHJlbWFpbmluZyA8PSBtaW5MZW5ndGhcbiAgICAgICAgICAgICAgPyBgPHNwYW4gY2xhc3M9XCJyZWRcIiA+JHtyZW1haW5pbmd9PC9zcGFuPmBcbiAgICAgICAgICAgICAgOiByZW1haW5pbmdcbiAgICAgICAgICApO1xuICAgICAgfTtcblxuICAgICAgbWF4TGVuZ3RoID0gaW5wdXQuZ2V0QXR0cmlidXRlKCdtYXhsZW5ndGgnKTtcblxuICAgICAgLy8gSWdub3JlIGlmIG1heGxlbmd0aCBpcyBub3QgZ2l2ZW5cbiAgICAgIGlmICghbWF4TGVuZ3RoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gTWFrZSBzdXJlIHRoZSBsaW1pdCBpcyBhbiBpbnRlZ2VyXG4gICAgICBtYXhMZW5ndGggPSBwYXJzZUludChtYXhMZW5ndGgpO1xuXG4gICAgICAvLyBBdHRhY2ggdGhlIGhhbmRsZXJzXG4gICAgICAna2V5cHJlc3Mga2V5ZG93biBrZXl1cCcuc3BsaXQoJyAnKS5mb3JFYWNoKChldnQpID0+IHtcbiAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihldnQsIGZuQ2FsYywgdHJ1ZSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgdXRpbGl0eSBsYWJlbFxuICAgICAgZm5DYWxjKCk7XG4gICAgfSk7IC8vIGlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uKGlucHV0LCBpKVxuICB9IC8vIGlmIChpbnB1dHMgIT09IG51bGwpXG59OyAvLyBzZWVkVGV4dGFyZWFcblxuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gIG1vZHVsZS5leHBvcnRzLnNlZWRUZXh0YXJlYSA9IHNlZWRUZXh0YXJlYTtcbn1cblxuLy8gRXhwb3NlIFNlZWRDU1MgaW4gdGhlIGdsb2JhbCBzY29wZVxuaWYgKHR5cGVvZiB3aW5kb3cuU2VlZENTUyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgd2luZG93LlNlZWRDU1MgPSB7fTtcbn1cblxuLy8gRXhwb3NlIHRleHRBcmVhIGluIHRoZSBnbG9iYWwgc2NvcGVcbndpbmRvdy5TZWVkQ1NTLnRleHRBcmVhID0gc2VlZFRleHRhcmVhO1xuIl19
