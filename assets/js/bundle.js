"use strict";!function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}return"function"!=typeof window.CustomEvent&&(t.prototype=window.Event.prototype,void(window.CustomEvent=t))}();
"use strict";var seedFileUpload=function(){var e=function(e){e&&e.preventDefault();var t,i=!1,n=this,l=n.nextElementSibling;n.files&&n.files.length>1?i=(n.getAttribute("data-multiple")||"{count} files").replace("{count}",n.files.length):n.value.trim().length>0&&(i=n.value.split("\\").pop()),i&&(l.querySelector(".input").innerHTML=i),""!==n.value&&(t=new CustomEvent("file.chosen"),n.parentNode.classList.add("chosen"),n.dispatchEvent(t))},t=document.querySelectorAll('.seed-file > [type="file"]');null!==t&&t.forEach(function(t,i){var n=t.nextElementSibling,l=n.querySelector(".cancel"),o=t.getAttribute("data-empty")||"No file chosen";n&&(t.getAttribute("id")&&t.getAttribute("id")!==n.getAttribute("for")?n.setAttribute("for",t.getAttribute("id")):n.getAttribute("for")&&!t.getAttribute("id")?t.setAttribute("id",n.getAttribute("for")):(t.setAttribute("id","file-input-"+i),n.setAttribute("for","file-input-"+i)),l&&l.addEventListener("click",function(e){e&&e.preventDefault();var i=t.getAttribute("data-empty")||"No file chosen";t.value="",t.parentNode.classList.remove("chosen"),n.querySelector(".input").innerHTML=i,seedCustomEvent=new CustomEvent("file.removed"),t.dispatchEvent(seedCustomEvent)}),n.querySelector(".input").innerHTML=o,t.addEventListener("change",e))})};"undefined"!=typeof module?("undefined"==typeof module.exports.SeedCSS&&(module.exports.SeedCSS={}),module.exports.SeedCSS.fileUpload=seedFileUpload):("undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.fileUpload=seedFileUpload);
"use strict";var fnOpen,fnClose,fnEsc,seedModal=function(e){var n={trigger:'[role="modal"]',classAnimation:{open:"flipInX",close:"flipOutX"}};e=Object.assign({},n,e);var t=document.querySelectorAll(".modal"),o=document.querySelectorAll(e.trigger);return fnClose=function(n){if(n){var t,o=document.querySelector("html"),d=n.querySelector(".modal-window");d&&(document.removeEventListener("keydown",fnEsc),d.classList.replace(e.classAnimation.open,e.classAnimation.close),n.classList.add("delay-1s"),n.classList.replace("fadeIn","fadeOut"),setTimeout(function(){t=new CustomEvent("modal.closed"),n.dispatchEvent(t),n.classList.add("hide"),o.style.overflow="",n.classList.remove("delay-1s","fadeOut"),d.classList.replace(e.classAnimation.close,e.classAnimation.open)},600))}},fnOpen=function(n){if(n){var t,o=document.querySelector("html"),d=n.querySelector(".modal-window");fnEsc=function(e){var t=e.keyCode||e.which;27===t&&fnClose(n)},d&&(document.addEventListener("keydown",fnEsc),n.style.display="",n.classList.add("animated","fadeIn","fast"),d.classList.add("animated",e.classAnimation.open),n.classList.remove("hide"),o.style.overflow="hidden",setTimeout(function(){t=new CustomEvent("modal.opened"),n.dispatchEvent(t)},100))}},null!==t&&t.forEach(function(e,n){var t=e.querySelectorAll('[role="modal-dismiss"]');e.addEventListener("click",function(){fnClose(e)}),e.show=function(){fnOpen(e)},e.hide=function(){fnClose(e)},null!==t&&t.forEach(function(n,t){n.addEventListener("click",function(n){n&&(n.preventDefault(),n.stopPropagation()),fnClose(e)})})}),null!==o&&o.forEach(function(e,n){e.addEventListener("click",function(n){n&&n.preventDefault();var t=e.getAttribute("data-modal-id");if(null!==t){var o=document.querySelector("#".concat(t));fnOpen(o)}})}),o=void 0,{get:function(e){if("string"==typeof e){var n=!1;return t.forEach(function(t){if(t.id===e.replace(/^#/,""))return void(n=t)}),n}return"undefined"!=typeof t[e]&&t[e]}}};"undefined"!=typeof module?("undefined"==typeof module.exports.SeedCSS&&(module.exports.SeedCSS={}),module.exports.SeedCSS.modal=seedModal):("undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.modal=seedModal);
"use strict";var seedOffCanvas=function(){var e=function(e,n){var t,o=document.querySelector("#".concat(e.replace(/^#/,""))),a=n||document.querySelector('[role="offcanvas"][data-id="'.concat(e.replace(/^#/,""),'"]'));null!==o&&(o.classList.toggle("open"),o.classList.contains("open")?(null!==a&&a.classList.add("triggered"),document.querySelector("html").style.overflow="hidden"):(document.querySelectorAll('[role="offcanvas"][data-id="'.concat(e.replace(/^#/,""),'"]')).forEach(function(e){e.classList.remove("triggered")}),document.querySelector("html").style.overflow=""),setTimeout(function(){t=o.classList.contains("open")?new CustomEvent("canvas.opened"):new CustomEvent("canvas.closed"),o.dispatchEvent(t)},300))},n=function(n){n&&n.preventDefault(),e(n.currentTarget.getAttribute("data-id")||"offcanvas",n.currentTarget)},t=document.querySelectorAll('[role="offcanvas"]'),o=document.querySelectorAll(".offcanvas");return null!==t&&t.forEach(function(e,t){e.addEventListener("click",n)}),null!==o&&o.forEach(function(n,t){n.open=function(){e(n.getAttribute("id")||"offcanvas")},n.close=function(){}}),{get:function(e){if("string"==typeof e){var n=!1;return o.forEach(function(t){if(t.id===e.replace(/^#/,""))return void(n=t)}),n}return"undefined"!=typeof canvas[e]&&canvas[e]}}};"undefined"!=typeof module?("undefined"==typeof module.exports.SeedCSS&&(module.exports.SeedCSS={}),module.exports.SeedCSS.offCanvas=seedOffCanvas):("undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.offCanvas=seedOffCanvas);
"use strict";var seedScroll=function(e){var t=null,o=0,n=50,l={spyScrollContainer:"nav",spyScroll:"a.smooth",revealWhenVisible:".reveal"},r=function(e){t.forEach(function(e){e.classList.remove("active")}),e&&e.classList.add("active")},c=function(e){var t=document.body.getBoundingClientRect(),o=e.getBoundingClientRect();return{top:Math.ceil(o.top-t.top),left:Math.ceil(o.left-t.left)}},i=function(e){if(window.scrollY===o){var l=new CustomEvent("scroll.complete");document.dispatchEvent(l)}if(t){var i=c(t[0]);window.scrollY<i.top&&r(),t.forEach(function(e,t){var o=e.getAttribute("href")||e.getAttribute("data-target"),l=document.querySelector(o),i=c(l);if(i.top-n<=window.scrollY)return void r(e)})}"function"==typeof window.oldOnscroll&&window.oldOnscroll(e)},d=function(e){e&&e.preventDefault();var t=e.currentTarget.getAttribute("href")||e.currentTarget.getAttribute("data-target");if(t){var l=document.querySelector(t);o=c(l).top-n,window.scrollTo({behavior:"smooth",left:0,top:o})}};window.oldOnscroll=window.onscroll,window.onscroll=i,e=Object.assign({},l,e),t=document.querySelectorAll(e.spyScroll),null!==t&&t.forEach(function(e,t){e.addEventListener("click",d)})};"undefined"!=typeof module?("undefined"==typeof module.exports.SeedCSS&&(module.exports.SeedCSS={}),module.exports.SeedCSS.scroll=seedScroll):("undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.scroll=seedScroll);
"use strict";var seedTextarea=function(){var e=document.querySelectorAll(".field > textarea");null!==e&&e.forEach(function(e,t){var a=0,r=e.parentNode,n=r.querySelector('[role="counter"]'),d=n.getAttribute("data-template")||"Typed %a out of %b. Remaining %c.",o=function(){var t=e.value.replace(/[\n\r]/g,"").length,r=a-t,o=Math.floor(.1*a);n.innerHTML=d.replace("%a",t).replace("%b",a).replace("%c",r<=o?'<span class="red" >'.concat(r,"</span>"):r)};a=e.getAttribute("maxlength"),a&&(a=parseInt(a),"keypress keydown keyup".split(" ").forEach(function(t){e.addEventListener(t,o,!0)}),o())})};"undefined"!=typeof module?("undefined"==typeof module.exports.SeedCSS&&(module.exports.SeedCSS={}),module.exports.SeedCSS.textArea=seedTextarea):("undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.textArea=seedTextarea);
"use strict";!function(){var e=function(){$("#add-col").off("click").on("click",function(e){e&&e.preventDefault();var s=$("#flexible-cols"),l=s.find(".col");if(l.length<12){var o=l.length,n=12-o,d="sm-"+n;s.find(".col").removeClass("sm-1 sm-2 sm-3 sm-4 sm-5 sm-6 sm-7 sm-8 sm-9 sm-10 sm-11 sm-12"),s.find(".col:last").after($("<div />",{"class":"col align-center"}).html(o+1)),s.find(".col").each(function(){$(this).addClass("sm-1")}),s.find(".col:last").toggleClass("sm-1 "+d),$("#rem-col").attr("disabled",!1)}l.length>=11&&$(this).attr("disabled",!0)}),$("#rem-col").off("click").on("click",function(e){e&&e.preventDefault();var s=$("#flexible-cols"),l=s.find(".col");if(l.length>1){var o=l.length-1,n="sm-"+(12-o+1);s.find(".col:last").remove(),s.find(".col:last").removeClass("sm-1 sm-2 sm-3 sm-4 sm-5 sm-6 sm-7 sm-8 sm-9 sm-10 sm-11 sm-12").addClass(n),$("#add-col").attr("disabled",!1)}l.length<=2&&$(this).attr("disabled",!0)})};if(e(),"undefined"!=typeof SeedCSS){var s=SeedCSS.modal(),l=SeedCSS.offCanvas(),o=s.get("#modal"),n=l.get("#sidenav");if(SeedCSS.fileUpload(),SeedCSS.textArea(),SeedCSS.scroll(),o&&(o.addEventListener("modal.opened",function(){console.log("Modal Opened")}),o.addEventListener("modal.closed",function(){console.log("Modal Closed")})),n){var d=document.querySelector("#offcanvas-style");d&&d.addEventListener("change",function(){"overlay"===d.value?n.classList.add("overlay"):n.classList.remove("overlay")}),n.addEventListener("canvas.opened",function(){console.log("Side Menu Opened")}),n.addEventListener("canvas.closed",function(){console.log("Side Menu Closed")}),document.addEventListener("scroll.complete",function(){console.log("Finished smooth scrolling")})}}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbUV2ZW50UG9seWZpbGwuanMiLCJzZWVkRmlsZVVwbG9hZC5qcyIsInNlZWRNb2RhbC5qcyIsInNlZWRPZmZDYW52YXMuanMiLCJzZWVkU2Nyb2xsLmpzIiwic2VlZFRleHRhcmVhLmpzIiwibWFpbi5qcyJdLCJuYW1lcyI6WyJDdXN0b21FdmVudCIsImV2ZW50IiwicGFyYW1zIiwiYnViYmxlcyIsImNhbmNlbGFibGUiLCJkZXRhaWwiLCJ1bmRlZmluZWQiLCJldnQiLCJkb2N1bWVudCIsImNyZWF0ZUV2ZW50IiwiaW5pdEN1c3RvbUV2ZW50Iiwid2luZG93IiwicHJvdG90eXBlIiwiRXZlbnQiLCJzZWVkRmlsZVVwbG9hZCIsImZuQ2hhbmdlIiwicHJldmVudERlZmF1bHQiLCJzZWVkQ3VzdG9tRXZlbnQiLCJmaWxlTmFtZSIsImlucHV0IiwidGhpcyIsImxhYmVsIiwibmV4dEVsZW1lbnRTaWJsaW5nIiwiZmlsZXMiLCJsZW5ndGgiLCJnZXRBdHRyaWJ1dGUiLCJyZXBsYWNlIiwidmFsdWUiLCJ0cmltIiwic3BsaXQiLCJwb3AiLCJxdWVyeVNlbGVjdG9yIiwiaW5uZXJIVE1MIiwicGFyZW50Tm9kZSIsImNsYXNzTGlzdCIsImFkZCIsImRpc3BhdGNoRXZlbnQiLCJpbnB1dHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImkiLCJjYW5jZWwiLCJlbXB0eVRleHQiLCJzZXRBdHRyaWJ1dGUiLCJhZGRFdmVudExpc3RlbmVyIiwicmVtb3ZlIiwibW9kdWxlIiwiZXhwb3J0cyIsIlNlZWRDU1MiLCJmaWxlVXBsb2FkIiwiZm5PcGVuIiwiZm5DbG9zZSIsImZuRXNjIiwic2VlZE1vZGFsIiwib3B0aW9ucyIsImRlZmF1bHRPcHRpb25zIiwidHJpZ2dlciIsImNsYXNzQW5pbWF0aW9uIiwib3BlbiIsImNsb3NlIiwiT2JqZWN0IiwiYXNzaWduIiwibW9kYWxzIiwibW9kYWxUcmlnZ2VycyIsIm1vZGFsT2JqZWN0IiwiY3VzdG9tRXZlbnQiLCJodG1sIiwibVdpbiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRUaW1lb3V0Iiwic3R5bGUiLCJvdmVyZmxvdyIsImUiLCJrZXkiLCJrZXlDb2RlIiwid2hpY2giLCJkaXNwbGF5IiwibW9kYWwiLCJkaXNtaXNzYWxzIiwic2hvdyIsImhpZGUiLCJkaXNtaXNzIiwiaiIsInN0b3BQcm9wYWdhdGlvbiIsInJlZiIsImNvbmNhdCIsImdldCIsImlkeCIsIm5vZGUiLCJpZCIsInNlZWRPZmZDYW52YXMiLCJmblRvZ2dsZSIsImNhbnZhc0lEIiwidHJpZ2dlckVsZW1lbnQiLCJjYW52YXMiLCJ0b2dnbGUiLCJjb250YWlucyIsInRnciIsImZuVHJpZ2dlckNsaWNrIiwiY3VycmVudFRhcmdldCIsInRyaWdnZXJzIiwiY2FudmFzZXMiLCJvZmZDYW52YXMiLCJzZWVkU2Nyb2xsIiwic2Nyb2xsVGFyZ2V0IiwiZ3V0dGVyIiwic3B5U2Nyb2xsQ29udGFpbmVyIiwic3B5U2Nyb2xsIiwicmV2ZWFsV2hlblZpc2libGUiLCJmblVwZGF0ZUFjdGl2ZVRyaWdnZXIiLCJlbGVtIiwiZWwiLCJmbkdldE9mZnNldCIsImJvZHlPZmZzZXQiLCJib2R5IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0Iiwib2Zmc2V0IiwidG9wIiwiTWF0aCIsImNlaWwiLCJsZWZ0IiwiZm5TY3JvbGxDb21wbGV0ZSIsInNjcm9sbFkiLCJmaXJzdEVsZW1lbnRPZmZzZXQiLCJ0YXJnZXRJRCIsInRhcmdldCIsIm9sZE9uc2Nyb2xsIiwic2Nyb2xsVG8iLCJiZWhhdmlvciIsIm9uc2Nyb2xsIiwic2Nyb2xsIiwic2VlZFRleHRhcmVhIiwibWF4TGVuZ3RoIiwicGFyZW50IiwiY291bnRlckxhYmVsIiwidGVtcGxhdGUiLCJmbkNhbGMiLCJ0eXBlZCIsInJlbWFpbmluZyIsIm1pbkxlbmd0aCIsImZsb29yIiwicGFyc2VJbnQiLCJ0ZXh0QXJlYSIsImVuYWJsZUdyaWRQbGF5Z3JvdW5kIiwiJCIsIm9mZiIsIm9uIiwicm93IiwiY29scyIsImZpbmQiLCJjb3VudCIsInJlbWFpbiIsImxhc3RDbGFzcyIsInJlbW92ZUNsYXNzIiwiYWZ0ZXIiLCJjbGFzcyIsImVhY2giLCJhZGRDbGFzcyIsInRvZ2dsZUNsYXNzIiwiYXR0ciIsIm0iLCJjIiwiY29uc29sZSIsImxvZyIsImNhbnZhc1N0eWxlU3dpdGNoZXIiXSwibWFwcGluZ3MiOiJBQUFBLGNBSUEsV0FHRSxRQUFTQSxHQUFZQyxFQUFPQyxHQUMxQkEsRUFBU0EsSUFBWUMsU0FBUyxFQUFPQyxZQUFZLEVBQU9DLE9BQVFDLE9BQ2hFLElBQUlDLEdBQU1DLFNBQVNDLFlBQVksY0FPL0IsT0FOQUYsR0FBSUcsZ0JBQ0ZULEVBQ0FDLEVBQU9DLFFBQ1BELEVBQU9FLFdBQ1BGLEVBQU9HLFFBRUZFLEVBWFQsTUFBa0Msa0JBQXZCSSxRQUFPWCxjQWNsQkEsRUFBWVksVUFBWUQsT0FBT0UsTUFBTUQsZUFFckNELE9BQU9YLFlBQWNBO0FDckJ2QixZQVFBLElBQU1jLGdCQUFpQixXQUdyQixHQUFNQyxHQUFXLFNBQWtCUixHQUM3QkEsR0FDRkEsRUFBSVMsZ0JBR04sSUFBSUMsR0FDQUMsR0FBVyxFQUVUQyxFQUFRQyxLQUNSQyxFQUFRRixFQUFNRyxrQkFHaEJILEdBQU1JLE9BQVNKLEVBQU1JLE1BQU1DLE9BQVMsRUFDdENOLEdBQ0VDLEVBQU1NLGFBQWEsa0JBQW9CLGlCQUN2Q0MsUUFBUSxVQUFXUCxFQUFNSSxNQUFNQyxRQUkxQkwsRUFBTVEsTUFBTUMsT0FBT0osT0FBUyxJQUNuQ04sRUFBV0MsRUFBTVEsTUFBTUUsTUFBTSxNQUFNQyxPQUdqQ1osSUFDRkcsRUFBTVUsY0FBYyxVQUFVQyxVQUFZZCxHQUd4QixLQUFoQkMsRUFBTVEsUUFDUlYsRUFBa0IsR0FBSWpCLGFBQVksZUFDbENtQixFQUFNYyxXQUFXQyxVQUFVQyxJQUFJLFVBQy9CaEIsRUFBTWlCLGNBQWNuQixLQUtsQm9CLEVBQVM3QixTQUFTOEIsaUJBQWlCLDZCQUUxQixRQUFYRCxHQUNGQSxFQUFPRSxRQUFRLFNBQVNwQixF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Q3NILFFBQVFDLElBQUksbUJBSVpyRSxFQUFRLENBQ1YsR0FBSXNFLEdBQXNCNUosU0FBU3VCLGNBQWMsbUJBRTdDcUksSUFDRkEsRUFBb0J4SCxpQkFBaUIsU0FBVSxXQUNYLFlBQTlCd0gsRUFBb0J6SSxNQUN0Qm1FLEVBQU81RCxVQUFVQyxJQUFJLFdBRXJCMkQsRUFBTzVELFVBQVVXLE9BQU8sYUFLOUJpRCxFQUFPbEQsaUJBQWlCLGdCQUFpQixXQUN2Q3NILFFBQVFDLElBQUksc0JBR2RyRSxFQUFPbEQsaUJBQWlCLGdCQUFpQixXQUN2Q3NILFFBQVFDLElBQUksc0JBR2QzSixTQUFTb0MsaUJBQWlCLGtCQUFtQixXQUMzQ3NILFFBQVFDLElBQUkiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqIVxuICogQSBzaW1wbGUgcG9seWZpbGwgZm9yIEN1c3RvbUV2ZW50XG4gKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9DdXN0b21FdmVudC9DdXN0b21FdmVudCNQb2x5ZmlsbFxuICovXG4oZnVuY3Rpb24oKSB7XG4gIGlmICh0eXBlb2Ygd2luZG93LkN1c3RvbUV2ZW50ID09PSAnZnVuY3Rpb24nKSByZXR1cm4gZmFsc2U7XG5cbiAgZnVuY3Rpb24gQ3VzdG9tRXZlbnQoZXZlbnQsIHBhcmFtcykge1xuICAgIHBhcmFtcyA9IHBhcmFtcyB8fCB7IGJ1YmJsZXM6IGZhbHNlLCBjYW5jZWxhYmxlOiBmYWxzZSwgZGV0YWlsOiB1bmRlZmluZWQgfTtcbiAgICB2YXIgZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XG4gICAgZXZ0LmluaXRDdXN0b21FdmVudChcbiAgICAgIGV2ZW50LFxuICAgICAgcGFyYW1zLmJ1YmJsZXMsXG4gICAgICBwYXJhbXMuY2FuY2VsYWJsZSxcbiAgICAgIHBhcmFtcy5kZXRhaWxcbiAgICApO1xuICAgIHJldHVybiBldnQ7XG4gIH1cblxuICBDdXN0b21FdmVudC5wcm90b3R5cGUgPSB3aW5kb3cuRXZlbnQucHJvdG90eXBlO1xuXG4gIHdpbmRvdy5DdXN0b21FdmVudCA9IEN1c3RvbUV2ZW50O1xufSkoKTtcbiIsIi8qKiFcbiAqIFNlZWQtQ1NTIC0gQ3VzdG9tIEhUTUwgSW5wdXQgRmlsZS5cbiAqIEBhdXRob3IgUm9nZXJpbyBUYXF1ZXMgKGhlbGxvQGFidHouY28pXG4gKiBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9BYnR6TGFicy9zZWVkLWNzc1xuICogQHZlcnNpb24gMi4wLjFcbiAqIEBsaWNlbnNlIE1JVFxuICovXG5cbmNvbnN0IHNlZWRGaWxlVXBsb2FkID0gZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICBjb25zdCBmbkNoYW5nZSA9IGZ1bmN0aW9uIGZuQ2hhbmdlKGV2dCkge1xuICAgIGlmIChldnQpIHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cblxuICAgIGxldCBzZWVkQ3VzdG9tRXZlbnQ7XG4gICAgbGV0IGZpbGVOYW1lID0gZmFsc2U7XG5cbiAgICBjb25zdCBpbnB1dCA9IHRoaXM7XG4gICAgY29uc3QgbGFiZWwgPSBpbnB1dC5uZXh0RWxlbWVudFNpYmxpbmc7XG5cbiAgICAvLyBXaGVuIG11bHRpcGxlIGZpbGVzIGFyZSBzZWxlY3RlZFxuICAgIGlmIChpbnB1dC5maWxlcyAmJiBpbnB1dC5maWxlcy5sZW5ndGggPiAxKSB7XG4gICAgICBmaWxlTmFtZSA9IChcbiAgICAgICAgaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLW11bHRpcGxlJykgfHwgJ3tjb3VudH0gZmlsZXMnXG4gICAgICApLnJlcGxhY2UoJ3tjb3VudH0nLCBpbnB1dC5maWxlcy5sZW5ndGgpO1xuICAgIH1cblxuICAgIC8vIFdoZW4gb25seSBvbmUgZmlsZSBpcyBzZWxlY3RlZFxuICAgIGVsc2UgaWYgKGlucHV0LnZhbHVlLnRyaW0oKS5sZW5ndGggPiAwKSB7XG4gICAgICBmaWxlTmFtZSA9IGlucHV0LnZhbHVlLnNwbGl0KCdcXFxcJykucG9wKCk7XG4gICAgfVxuXG4gICAgaWYgKGZpbGVOYW1lKSB7XG4gICAgICBsYWJlbC5xdWVyeVNlbGVjdG9yKCcuaW5wdXQnKS5pbm5lckhUTUwgPSBmaWxlTmFtZTtcbiAgICB9XG5cbiAgICBpZiAoaW5wdXQudmFsdWUgIT09ICcnKSB7XG4gICAgICBzZWVkQ3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2ZpbGUuY2hvc2VuJyk7XG4gICAgICBpbnB1dC5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ2Nob3NlbicpO1xuICAgICAgaW5wdXQuZGlzcGF0Y2hFdmVudChzZWVkQ3VzdG9tRXZlbnQpO1xuICAgIH1cbiAgfTsgLy8gZm5DaGFuZ2VcblxuICAvLyBGaW5kIGFsbCBzZWVkLWZpbGUgaW5wdXRzLlxuICBjb25zdCBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2VlZC1maWxlID4gW3R5cGU9XCJmaWxlXCJdJyk7XG5cbiAgaWYgKGlucHV0cyAhPT0gbnVsbCkge1xuICAgIGlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uKGlucHV0LCBpKSB7XG4gICAgICAvLyBGaW5kIHRoZSBmaWVsZCBsYWJlbFxuICAgICAgY29uc3QgbGFiZWwgPSBpbnB1dC5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgICBjb25zdCBjYW5jZWwgPSBsYWJlbC5xdWVyeVNlbGVjdG9yKCcuY2FuY2VsJyk7XG4gICAgICBjb25zdCBlbXB0eVRleHQgPSBpbnB1dC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZW1wdHknKSB8fCAnTm8gZmlsZSBjaG9zZW4nO1xuXG4gICAgICAvLyBJZiBsYWJlbCBkb2VzIG5vdCBleGlzdHMsIHNpbXBseSBkbyBub3Qgc2V0IGl0IHVwXG4gICAgICBpZiAoIWxhYmVsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gTWFrZSBzdXJlIGlucHV0IGFuZCBsYWJlbCBtYXRjaGVzIGFuZCB3b3Jrcy5cbiAgICAgIGlmIChcbiAgICAgICAgaW5wdXQuZ2V0QXR0cmlidXRlKCdpZCcpICYmXG4gICAgICAgIGlucHV0LmdldEF0dHJpYnV0ZSgnaWQnKSAhPT0gbGFiZWwuZ2V0QXR0cmlidXRlKCdmb3InKVxuICAgICAgKSB7XG4gICAgICAgIGxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgaW5wdXQuZ2V0QXR0cmlidXRlKCdpZCcpKTtcbiAgICAgIH0gZWxzZSBpZiAobGFiZWwuZ2V0QXR0cmlidXRlKCdmb3InKSAmJiAhaW5wdXQuZ2V0QXR0cmlidXRlKCdpZCcpKSB7XG4gICAgICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnaWQnLCBsYWJlbC5nZXRBdHRyaWJ1dGUoJ2ZvcicpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnaWQnLCAnZmlsZS1pbnB1dC0nICsgaSk7XG4gICAgICAgIGxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgJ2ZpbGUtaW5wdXQtJyArIGkpO1xuICAgICAgfVxuXG4gICAgICAvLyBBbHdheXMgdGhlIGNhbmNlbCBidXR0b24gZXhpc3RzLCBhZGRzIGEgaGFuZGxlclxuICAgICAgaWYgKGNhbmNlbCkge1xuICAgICAgICBjYW5jZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgaWYgKGV2dCkge1xuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgZW1wdHlUZXh0ID1cbiAgICAgICAgICAgIGlucHV0LmdldEF0dHJpYnV0ZSgnZGF0YS1lbXB0eScpIHx8ICdObyBmaWxlIGNob3Nlbic7XG5cbiAgICAgICAgICBpbnB1dC52YWx1ZSA9ICcnO1xuICAgICAgICAgIGlucHV0LnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnY2hvc2VuJyk7XG4gICAgICAgICAgbGFiZWwucXVlcnlTZWxlY3RvcignLmlucHV0JykuaW5uZXJIVE1MID0gZW1wdHlUZXh0O1xuXG4gICAgICAgICAgc2VlZEN1c3RvbUV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdmaWxlLnJlbW92ZWQnKTtcbiAgICAgICAgICBpbnB1dC5kaXNwYXRjaEV2ZW50KHNlZWRDdXN0b21FdmVudCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBsYWJlbC5xdWVyeVNlbGVjdG9yKCcuaW5wdXQnKS5pbm5lckhUTUwgPSBlbXB0eVRleHQ7XG5cbiAgICAgIC8vIFN0YXJ0IGxpc3RlbmluZyB0aGUgZmllbGQgZm9yIGNoYW5nZXNcbiAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZuQ2hhbmdlKTtcbiAgICB9KTsgLy8gaW5wdXRzLmZvckVhY2goZnVuY3Rpb24oaW5wdXQsIGkpXG4gIH0gLy8gaWYgKGlucHV0cyAhPT0gbnVsbClcbn07IC8vIHNlZWRGaWxlVXBsb2FkXG5cbmlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xuICBpZiAodHlwZW9mIG1vZHVsZS5leHBvcnRzLlNlZWRDU1MgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMuU2VlZENTUyA9IHt9O1xuICB9XG5cbiAgbW9kdWxlLmV4cG9ydHMuU2VlZENTUy5maWxlVXBsb2FkID0gc2VlZEZpbGVVcGxvYWQ7XG59IGVsc2Uge1xuICBpZiAodHlwZW9mIHdpbmRvdy5TZWVkQ1NTID09PSAndW5kZWZpbmVkJykge1xuICAgIHdpbmRvdy5TZWVkQ1NTID0ge307XG4gIH1cblxuICB3aW5kb3cuU2VlZENTUy5maWxlVXBsb2FkID0gc2VlZEZpbGVVcGxvYWQ7XG59XG4iLCIvKiohXG4gKiBTZWVkLUNTUyAtIE1vZGFsXG4gKiBAYXV0aG9yIFJvZ2VyaW8gVGFxdWVzIChoZWxsb0BhYnR6LmNvKVxuICogQHNlZSBodHRwczovL2dpdGh1Yi5jb20vQWJ0ekxhYnMvc2VlZC1jc3NcbiAqIEB2ZXJzaW9uIDIuMC4xXG4gKiBAbGljZW5zZSBNSVRcbiAqL1xuXG5sZXQgZm5PcGVuO1xuXG5sZXQgZm5DbG9zZTtcblxubGV0IGZuRXNjO1xuXG5jb25zdCBzZWVkTW9kYWwgPSAob3B0aW9ucykgPT4ge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLy8gRGVmYXVsdCBzZXR0aW5nc1xuICBjb25zdCBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAvLyB0aGUgZWxlbWVudCB0aGF0IHRyaWdnZXJzIHRoZSBtb2RhbFxuICAgIHRyaWdnZXI6ICdbcm9sZT1cIm1vZGFsXCJdJyxcblxuICAgIC8vIEBzZWU6IGh0dHBzOi8vZGFuZWRlbi5naXRodWIuaW8vYW5pbWF0ZS5jc3MvXG4gICAgLy8gYW5pbWF0ZS5jc3MgY2xhc3NlcyB0byBiZSB1c2VkXG4gICAgY2xhc3NBbmltYXRpb246IHtcbiAgICAgIG9wZW46ICdmbGlwSW5YJyxcbiAgICAgIGNsb3NlOiAnZmxpcE91dFgnXG4gICAgfVxuICB9O1xuXG4gIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG5cbiAgLy8gR2V0IGVsZW1lbnRzXG4gIGxldCBtb2RhbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubW9kYWwnKTtcbiAgbGV0IG1vZGFsVHJpZ2dlcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKG9wdGlvbnMudHJpZ2dlcik7XG5cbiAgZm5DbG9zZSA9IChtb2RhbE9iamVjdCkgPT4ge1xuICAgIGlmICghbW9kYWxPYmplY3QpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBsZXQgY3VzdG9tRXZlbnQ7XG4gICAgY29uc3QgaHRtbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKTtcbiAgICBjb25zdCBtV2luID0gbW9kYWxPYmplY3QucXVlcnlTZWxlY3RvcignLm1vZGFsLXdpbmRvdycpO1xuXG4gICAgaWYgKCFtV2luKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gUmVtb3ZlcyB0aGUgRVNDIGxpc3RlbmVyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZuRXNjKTtcblxuICAgIC8vIFJlcGxhY2Ugb3BlbiBhbmltYXRpb24gdG8gY2xvc2UgdGhlIG1vZGFsIHdpbmRvd1xuICAgIG1XaW4uY2xhc3NMaXN0LnJlcGxhY2UoXG4gICAgICBvcHRpb25zLmNsYXNzQW5pbWF0aW9uLm9wZW4sXG4gICAgICBvcHRpb25zLmNsYXNzQW5pbWF0aW9uLmNsb3NlXG4gICAgKTtcblxuICAgIC8vIEFkZCBhbmltYXRpb24gdG8gdGhlIG92ZXJsYXlcbiAgICBtb2RhbE9iamVjdC5jbGFzc0xpc3QuYWRkKCdkZWxheS0xcycpO1xuICAgIG1vZGFsT2JqZWN0LmNsYXNzTGlzdC5yZXBsYWNlKCdmYWRlSW4nLCAnZmFkZU91dCcpO1xuXG4gICAgLy8gV2FpdCAyIHNlY29uZHMgYmVmb3JlIGNvbXBsZXRlIGRlIHByb2Nlc3MuXG4gICAgLy8gVGhpcyBpcyB0aGUgdGltZSB0byBmaW5pc2hpbmcgYWxsIGFuaW1hdGUuY3NzIGFuaW1hdGlvbnNcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIC8vIERpc3BhdGNoIHRoZSAnbW9kYWwuY2xvc2VkJyBldmVudFxuICAgICAgY3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ21vZGFsLmNsb3NlZCcpO1xuICAgICAgbW9kYWxPYmplY3QuZGlzcGF0Y2hFdmVudChjdXN0b21FdmVudCk7XG5cbiAgICAgIC8vIENvbXBsZXRlbHkgaGlkZSB0aGUgY29tcG9uZW50XG4gICAgICBtb2RhbE9iamVjdC5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XG4gICAgICAvLyBSZWVuYWJsZSBzY3JvbGxpbmcgZnJvbSB0aGUgSFRNTFxuICAgICAgaHRtbC5zdHlsZS5vdmVyZmxvdyA9ICcnO1xuICAgICAgLy8gUmVtb3ZlIGNsb3NpbmcgY2xhc3NlcyBmcm9tIG92ZXJsYXlcbiAgICAgIG1vZGFsT2JqZWN0LmNsYXNzTGlzdC5yZW1vdmUoJ2RlbGF5LTFzJywgJ2ZhZGVPdXQnKTtcbiAgICAgIC8vIFJlbW92ZSBjbG9zaW5nIGNsYXNzZXMgZnJvbSBtb2RhbCB3aW5kb3dcbiAgICAgIG1XaW4uY2xhc3NMaXN0LnJlcGxhY2UoXG4gICAgICAgIG9wdGlvbnMuY2xhc3NBbmltYXRpb24uY2xvc2UsXG4gICAgICAgIG9wdGlvbnMuY2xhc3NBbmltYXRpb24ub3BlblxuICAgICAgKTtcbiAgICB9LCA2MDApO1xuICB9OyAvLyBmbkNsb3NlXG5cbiAgZm5PcGVuID0gKG1vZGFsT2JqZWN0KSA9PiB7XG4gICAgaWYgKCFtb2RhbE9iamVjdCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCBjdXN0b21FdmVudDtcbiAgICBjb25zdCBodG1sID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaHRtbCcpO1xuICAgIGNvbnN0IG1XaW4gPSBtb2RhbE9iamVjdC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtd2luZG93Jyk7XG5cbiAgICAvLyBIYW5kbGUgdGhlIEVTQyBkaXNtaXNzXG4gICAgZm5Fc2MgPSBmdW5jdGlvbiBlc2NIYW5kbGVyKGUpIHtcbiAgICAgIGNvbnN0IGtleSA9IGUua2V5Q29kZSB8fCBlLndoaWNoO1xuXG4gICAgICAvLyBXaGVuIHRoZSBFU0Mga2V5IGlzIHByZXNzZWRcbiAgICAgIGlmIChrZXkgPT09IDI3KSB7XG4gICAgICAgIGZuQ2xvc2UobW9kYWxPYmplY3QpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBpZiAoIW1XaW4pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBBZGQgKGFuZCByZW1vdmUpIGFuIEVTQyBoYW5kbGVyIGZvciB0aGUgb3ZlcmxheVxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBmbkVzYyk7XG5cbiAgICAvLyBDbGVhciBpbmxpbmUgZGlzcGxheSBzdHlsZSwgaWYgYW55XG4gICAgbW9kYWxPYmplY3Quc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgIC8vIEFkZCBhbmltYXRpb24gdG8gdGhlIG92ZXJsYXlcbiAgICBtb2RhbE9iamVjdC5jbGFzc0xpc3QuYWRkKCdhbmltYXRlZCcsICdmYWRlSW4nLCAnZmFzdCcpO1xuICAgIC8vIEFkZCBhbmltYXRpb24gdG8gdGhlIG1vZGFsIHdpbmRvd1xuICAgIG1XaW4uY2xhc3NMaXN0LmFkZCgnYW5pbWF0ZWQnLCBvcHRpb25zLmNsYXNzQW5pbWF0aW9uLm9wZW4pO1xuICAgIC8vIFNob3cgdGhlIGNvbXBvbmVudFxuICAgIG1vZGFsT2JqZWN0LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKTtcbiAgICAvLyBGaW5hbGx5IHByZXZlbnQgc2Nyb2xsaW5nXG4gICAgaHRtbC5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuXG4gICAgLy8gV2FpdCB0aGUgYW5pbWF0aW9uIGNvbXBsZXRlIHRvIGRpc3BhdGNoIHRoZSBldmVudFxuICAgIC8vIEVhY2ggYW5pbWF0ZS5jc3MgYW5pbWF0aW9uIHRha2VzIDFzXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAvLyBEaXNwYXRjaCB0aGUgJ21vZGFsLm9wZW5lZCcgZXZlbnRcbiAgICAgIGN1c3RvbUV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdtb2RhbC5vcGVuZWQnKTtcbiAgICAgIG1vZGFsT2JqZWN0LmRpc3BhdGNoRXZlbnQoY3VzdG9tRXZlbnQpO1xuICAgIH0sIDEwMCk7XG4gIH07IC8vIGZuT3BlblxuXG4gIGlmIChtb2RhbHMgIT09IG51bGwpIHtcbiAgICBtb2RhbHMuZm9yRWFjaCgobW9kYWwsIGkpID0+IHtcbiAgICAgIC8vIEhhbmRsZSB0aGUgZGlzbWlzcyBidXR0b25zXG4gICAgICBjb25zdCBkaXNtaXNzYWxzID0gbW9kYWwucXVlcnlTZWxlY3RvckFsbCgnW3JvbGU9XCJtb2RhbC1kaXNtaXNzXCJdJyk7XG5cbiAgICAgIC8vIEFkZCAoYW5kIHJlbW92ZSkgYSBjbGljayBoYW5kbGVyIG9uIHRoZSBvdmVybGF5XG4gICAgICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgZm5DbG9zZShtb2RhbCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gQWRkIHByb3RvdHlwZSBmb3Igc2hvdyAob3BlbilcbiAgICAgIG1vZGFsLnNob3cgPSAoKSA9PiB7XG4gICAgICAgIGZuT3Blbihtb2RhbCk7XG4gICAgICB9O1xuXG4gICAgICAvLyBBZGQgcHJvdG90eXBlIGZvciBoaWRlIChjbG9kZSlcbiAgICAgIG1vZGFsLmhpZGUgPSAoKSA9PiB7XG4gICAgICAgIGZuQ2xvc2UobW9kYWwpO1xuICAgICAgfTtcblxuICAgICAgaWYgKGRpc21pc3NhbHMgIT09IG51bGwpIHtcbiAgICAgICAgZGlzbWlzc2Fscy5mb3JFYWNoKChkaXNtaXNzLCBqKSA9PiB7XG4gICAgICAgICAgZGlzbWlzcy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldnQpID0+IHtcbiAgICAgICAgICAgIGlmIChldnQpIHtcbiAgICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm5DbG9zZShtb2RhbCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSAvLyBpZiAoZGlzbWlzc2FscyAhPT0gbnVsbClcbiAgICB9KTtcbiAgfSAvLyBpZiAobW9kYWxzICE9PSBudWxsKVxuXG4gIGlmIChtb2RhbFRyaWdnZXJzICE9PSBudWxsKSB7XG4gICAgbW9kYWxUcmlnZ2Vycy5mb3JFYWNoKCh0cmlnZ2VyLCBpKSA9PiB7XG4gICAgICB0cmlnZ2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xuICAgICAgICBpZiAoZXZ0KSB7XG4gICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZWYgPSB0cmlnZ2VyLmdldEF0dHJpYnV0ZSgnZGF0YS1tb2RhbC1pZCcpO1xuXG4gICAgICAgIGlmIChyZWYgIT09IG51bGwpIHtcbiAgICAgICAgICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke3JlZn1gKTtcbiAgICAgICAgICBmbk9wZW4obW9kYWwpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSAvLyBpZiAobW9kYWxUcmlnZ2VycyAhPT0gbnVsbClcblxuICBtb2RhbFRyaWdnZXJzID0gdW5kZWZpbmVkO1xuXG4gIHJldHVybiB7XG4gICAgZ2V0OiAoaWR4KSA9PiB7XG4gICAgICBpZiAodHlwZW9mIGlkeCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgbGV0IG1vZGFsID0gZmFsc2U7XG5cbiAgICAgICAgbW9kYWxzLmZvckVhY2goKG5vZGUpID0+IHtcbiAgICAgICAgICBpZiAobm9kZS5pZCA9PT0gaWR4LnJlcGxhY2UoL14jLywgJycpKSB7XG4gICAgICAgICAgICBtb2RhbCA9IG5vZGU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gbW9kYWw7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgbW9kYWxzW2lkeF0gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybiBtb2RhbHNbaWR4XTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfTtcbn07IC8vIHNlZWRNb2RhbFxuXG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgaWYgKHR5cGVvZiBtb2R1bGUuZXhwb3J0cy5TZWVkQ1NTID09PSAndW5kZWZpbmVkJykge1xuICAgIG1vZHVsZS5leHBvcnRzLlNlZWRDU1MgPSB7fTtcbiAgfVxuXG4gIG1vZHVsZS5leHBvcnRzLlNlZWRDU1MubW9kYWwgPSBzZWVkTW9kYWw7XG59IGVsc2Uge1xuICBpZiAodHlwZW9mIHdpbmRvdy5TZWVkQ1NTID09PSAndW5kZWZpbmVkJykge1xuICAgIHdpbmRvdy5TZWVkQ1NTID0ge307XG4gIH1cblxuICB3aW5kb3cuU2VlZENTUy5tb2RhbCA9IHNlZWRNb2RhbDtcbn1cbiIsIi8qKiFcbiAqIFNlZWQtQ1NTIC0gT2ZmLUNhbnZhcy5cbiAqIEBhdXRob3IgUm9nZXJpbyBUYXF1ZXMgKGhlbGxvQGFidHouY28pXG4gKiBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9BYnR6TGFicy9zZWVkLWNzc1xuICogQHZlcnNpb24gMi4wLjFcbiAqIEBsaWNlbnNlIE1JVFxuICovXG5cbmNvbnN0IHNlZWRPZmZDYW52YXMgPSBmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGNvbnN0IGZuVG9nZ2xlID0gKGNhbnZhc0lELCB0cmlnZ2VyRWxlbWVudCkgPT4ge1xuICAgIGxldCBjdXN0b21FdmVudDtcblxuICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2NhbnZhc0lELnJlcGxhY2UoL14jLywgJycpfWApO1xuXG4gICAgY29uc3QgdHJpZ2dlciA9XG4gICAgICB0cmlnZ2VyRWxlbWVudCB8fFxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgYFtyb2xlPVwib2ZmY2FudmFzXCJdW2RhdGEtaWQ9XCIke2NhbnZhc0lELnJlcGxhY2UoL14jLywgJycpfVwiXWBcbiAgICAgICk7XG5cbiAgICBpZiAoY2FudmFzICE9PSBudWxsKSB7XG4gICAgICBjYW52YXMuY2xhc3NMaXN0LnRvZ2dsZSgnb3BlbicpO1xuXG4gICAgICAvLyBQcmV2ZW50cyBzY3JvbGxpbmcgdGhlIEhUTUxcbiAgICAgIGlmIChjYW52YXMuY2xhc3NMaXN0LmNvbnRhaW5zKCdvcGVuJykpIHtcbiAgICAgICAgaWYgKHRyaWdnZXIgIT09IG51bGwpIHtcbiAgICAgICAgICAvLyBBZGQgdGhlICd0cmlnZ2VyZWQnIGNsYXNzIHRvIHRoZSBlbGVtZW50IHdoaWNoIGhhcyB0cmlnZ2VyZWQgdGhlIG9mZmNhbnZhcy5cbiAgICAgICAgICB0cmlnZ2VyLmNsYXNzTGlzdC5hZGQoJ3RyaWdnZXJlZCcpO1xuICAgICAgICB9IC8vIGlmICh0cmlnZ2VyICE9PSBudWxsKVxuXG4gICAgICAgIC8vIFByZXZlbnRzIG1haW4gdG8gc2Nyb2xsXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKS5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gUmVtb3ZlIHRoZSAndHJpZ2dlcmVkJyBjbGFzcyBmb3IgYW55IGV4aXN0aW5nIHRyaWdnZXIgd2hpY2ggcmVmZXJzIGdpdmVuIG9mZmNhbnZhcy5cbiAgICAgICAgZG9jdW1lbnRcbiAgICAgICAgICAucXVlcnlTZWxlY3RvckFsbChcbiAgICAgICAgICAgIGBbcm9sZT1cIm9mZmNhbnZhc1wiXVtkYXRhLWlkPVwiJHtjYW52YXNJRC5yZXBsYWNlKC9eIy8sICcnKX1cIl1gXG4gICAgICAgICAgKVxuICAgICAgICAgIC5mb3JFYWNoKCh0Z3IpID0+IHtcbiAgICAgICAgICAgIHRnci5jbGFzc0xpc3QucmVtb3ZlKCd0cmlnZ2VyZWQnKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBSZS1lbmFibGVzIG1haW4gc2Nyb2xsaW5nXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKS5zdHlsZS5vdmVyZmxvdyA9ICcnO1xuICAgICAgfVxuXG4gICAgICAvLyBXYWl0IHVudGlsIGFuaW1hdGlvbiBpcyBjb21wbGV0ZSB0byBkaXNwYXRjaCB0aGUgZXZlbnRcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBpZiAoY2FudmFzLmNsYXNzTGlzdC5jb250YWlucygnb3BlbicpKSB7XG4gICAgICAgICAgY3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2NhbnZhcy5vcGVuZWQnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudCgnY2FudmFzLmNsb3NlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGlzcGF0Y2ggdGhlICdjYW52YXMub3BlbmVkJy8gJ2NhbnZhcy5jbG9zZWQnIGV2ZW50c1xuICAgICAgICBjYW52YXMuZGlzcGF0Y2hFdmVudChjdXN0b21FdmVudCk7XG4gICAgICB9LCAzMDApO1xuICAgIH0gLy8gaWYgKGNhbnZhcyAhPT0gbnVsbClcbiAgfTsgLy8gZm5Ub2dnbGVcblxuICBjb25zdCBmblRyaWdnZXJDbGljayA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0KSB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG5cbiAgICBmblRvZ2dsZShcbiAgICAgIGV2dC5jdXJyZW50VGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS1pZCcpIHx8ICdvZmZjYW52YXMnLFxuICAgICAgZXZ0LmN1cnJlbnRUYXJnZXRcbiAgICApO1xuICB9OyAvLyBmblRyaWdnZXJDbGlja1xuXG4gIC8vIEZpbmQgYWxsIGV4aXN0aW5nIHRyaWdnZXJzXG4gIGNvbnN0IHRyaWdnZXJzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW3JvbGU9XCJvZmZjYW52YXNcIl0nKTtcblxuICAvLyBGaW5kIGFsbCBleGlzdGluZyBvZmZjYW52YXNcbiAgY29uc3QgY2FudmFzZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcub2ZmY2FudmFzJyk7XG5cbiAgaWYgKHRyaWdnZXJzICE9PSBudWxsKSB7XG4gICAgdHJpZ2dlcnMuZm9yRWFjaChmdW5jdGlvbih0cmlnZ2VyLCBpKSB7XG4gICAgICB0cmlnZ2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZm5UcmlnZ2VyQ2xpY2spO1xuICAgIH0pOyAvLyB0cmlnZ2Vycy5mb3JFYWNoKGZ1bmN0aW9uKHRyaWdnZXIsIGkpXG4gIH0gLy8gaWYgKHRyaWdnZXJzICE9PSBudWxsKVxuXG4gIGlmIChjYW52YXNlcyAhPT0gbnVsbCkge1xuICAgIGNhbnZhc2VzLmZvckVhY2goKGNhbnZhcywgaSkgPT4ge1xuICAgICAgLy8gQXR0YWNoIG1ldGhvZCBmb3Igb3BlbmluZ1xuICAgICAgY2FudmFzLm9wZW4gPSAoKSA9PiB7XG4gICAgICAgIGZuVG9nZ2xlKGNhbnZhcy5nZXRBdHRyaWJ1dGUoJ2lkJykgfHwgJ29mZmNhbnZhcycpO1xuICAgICAgfTsgLy8gb3BlblxuXG4gICAgICAvLyBBdHRhY2ggbWV0aG9kIGZvciBjbG9zaW5nXG4gICAgICBjYW52YXMuY2xvc2UgPSAoKSA9PiB7fTsgLy8gY2xvc2VcbiAgICB9KTsgLy8gY2FudmFzZXMuZm9yRWFjaCgoY2FudmFzLCBpKVxuICB9IC8vIGlmIChjYW52YXNlcyAhPT0gbnVsbClcblxuICByZXR1cm4ge1xuICAgIGdldDogKGlkeCkgPT4ge1xuICAgICAgaWYgKHR5cGVvZiBpZHggPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGxldCBjYW52YXMgPSBmYWxzZTtcblxuICAgICAgICBjYW52YXNlcy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgICAgaWYgKG5vZGUuaWQgPT09IGlkeC5yZXBsYWNlKC9eIy8sICcnKSkge1xuICAgICAgICAgICAgY2FudmFzID0gbm9kZTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBjYW52YXM7XG4gICAgICB9XG5cbiAgICAgIGlmICh0eXBlb2YgY2FudmFzW2lkeF0gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybiBjYW52YXNbaWR4XTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfTtcbn07IC8vIHNlZWRPZmZDYW52YXNcblxuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gIGlmICh0eXBlb2YgbW9kdWxlLmV4cG9ydHMuU2VlZENTUyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBtb2R1bGUuZXhwb3J0cy5TZWVkQ1NTID0ge307XG4gIH1cblxuICBtb2R1bGUuZXhwb3J0cy5TZWVkQ1NTLm9mZkNhbnZhcyA9IHNlZWRPZmZDYW52YXM7XG59IGVsc2Uge1xuICBpZiAodHlwZW9mIHdpbmRvdy5TZWVkQ1NTID09PSAndW5kZWZpbmVkJykge1xuICAgIHdpbmRvdy5TZWVkQ1NTID0ge307XG4gIH1cblxuICB3aW5kb3cuU2VlZENTUy5vZmZDYW52YXMgPSBzZWVkT2ZmQ2FudmFzO1xufVxuIiwiLyoqIVxuICogU2VlZC1DU1MgLSBTY3JvbGwuXG4gKiBAYXV0aG9yIFJvZ2VyaW8gVGFxdWVzIChoZWxsb0BhYnR6LmNvKVxuICogQHNlZSBodHRwczovL2dpdGh1Yi5jb20vQWJ0ekxhYnMvc2VlZC1jc3NcbiAqIEB2ZXJzaW9uIDIuMC4xXG4gKiBAbGljZW5zZSBNSVRcbiAqL1xuXG5jb25zdCBzZWVkU2Nyb2xsID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAndXNlIHN0cmljdCc7XG5cbiAgbGV0IHRyaWdnZXJzID0gbnVsbDtcblxuICBsZXQgc2Nyb2xsVGFyZ2V0ID0gMDtcblxuICBjb25zdCBndXR0ZXIgPSA1MDtcblxuICBjb25zdCBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICBzcHlTY3JvbGxDb250YWluZXI6ICduYXYnLFxuICAgIHNweVNjcm9sbDogJ2Euc21vb3RoJyxcbiAgICByZXZlYWxXaGVuVmlzaWJsZTogJy5yZXZlYWwnXG4gIH07IC8vIGRlZmF1bHRPcHRpb25zXG5cbiAgY29uc3QgZm5VcGRhdGVBY3RpdmVUcmlnZ2VyID0gKGVsZW0pID0+IHtcbiAgICB0cmlnZ2Vycy5mb3JFYWNoKChlbCkgPT4ge1xuICAgICAgZWwuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4gICAgfSk7XG5cbiAgICBpZiAoZWxlbSkge1xuICAgICAgZWxlbS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcbiAgICB9XG4gIH07IC8vIGZuVXBkYXRlQWN0aXZlVHJpZ2dlclxuXG4gIGNvbnN0IGZuR2V0T2Zmc2V0ID0gKGVsZW0pID0+IHtcbiAgICBjb25zdCBib2R5T2Zmc2V0ID0gZG9jdW1lbnQuYm9keS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBjb25zdCBvZmZzZXQgPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvcDogTWF0aC5jZWlsKG9mZnNldC50b3AgLSBib2R5T2Zmc2V0LnRvcCksXG4gICAgICBsZWZ0OiBNYXRoLmNlaWwob2Zmc2V0LmxlZnQgLSBib2R5T2Zmc2V0LmxlZnQpXG4gICAgfTtcbiAgfTsgLy8gZm5HZXRPZmZzZXRcblxuICBjb25zdCBmblNjcm9sbENvbXBsZXRlID0gKGV2dCkgPT4ge1xuICAgIGlmICh3aW5kb3cuc2Nyb2xsWSA9PT0gc2Nyb2xsVGFyZ2V0KSB7XG4gICAgICBjb25zdCBzZWVkQ3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ3Njcm9sbC5jb21wbGV0ZScpO1xuICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChzZWVkQ3VzdG9tRXZlbnQpO1xuICAgIH1cblxuICAgIGlmICh0cmlnZ2Vycykge1xuICAgICAgY29uc3QgZmlyc3RFbGVtZW50T2Zmc2V0ID0gZm5HZXRPZmZzZXQodHJpZ2dlcnNbMF0pO1xuXG4gICAgICBpZiAod2luZG93LnNjcm9sbFkgPCBmaXJzdEVsZW1lbnRPZmZzZXQudG9wKSB7XG4gICAgICAgIGZuVXBkYXRlQWN0aXZlVHJpZ2dlcigpO1xuICAgICAgfVxuXG4gICAgICB0cmlnZ2Vycy5mb3JFYWNoKChlbCwgaSkgPT4ge1xuICAgICAgICBjb25zdCB0YXJnZXRJRCA9XG4gICAgICAgICAgZWwuZ2V0QXR0cmlidXRlKCdocmVmJykgfHwgZWwuZ2V0QXR0cmlidXRlKCdkYXRhLXRhcmdldCcpO1xuXG4gICAgICAgIGNvbnN0IHRhcmdldCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGFyZ2V0SUQpO1xuICAgICAgICBjb25zdCBvZmZzZXQgPSBmbkdldE9mZnNldCh0YXJnZXQpO1xuXG4gICAgICAgIGlmIChvZmZzZXQudG9wIC0gZ3V0dGVyIDw9IHdpbmRvdy5zY3JvbGxZKSB7XG4gICAgICAgICAgZm5VcGRhdGVBY3RpdmVUcmlnZ2VyKGVsKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2Ygd2luZG93Lm9sZE9uc2Nyb2xsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICB3aW5kb3cub2xkT25zY3JvbGwoZXZ0KTtcbiAgICB9XG4gIH07IC8vIGZuU2Nyb2xsQ29tcGxldGVcblxuICBjb25zdCBmblRyaWdnZXJDbGljayA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0KSB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG5cbiAgICBjb25zdCB0YXJnZXQgPVxuICAgICAgZXZ0LmN1cnJlbnRUYXJnZXQuZ2V0QXR0cmlidXRlKCdocmVmJykgfHxcbiAgICAgIGV2dC5jdXJyZW50VGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQnKTtcblxuICAgIGlmICh0YXJnZXQpIHtcbiAgICAgIGNvbnN0IGVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhcmdldCk7XG5cbiAgICAgIHNjcm9sbFRhcmdldCA9IGZuR2V0T2Zmc2V0KGVsZW0pLnRvcCAtIGd1dHRlcjsgLy8gYWRkIHNvbWUgZ3V0dGVyXG5cbiAgICAgIHdpbmRvdy5zY3JvbGxUbyh7XG4gICAgICAgIGJlaGF2aW9yOiAnc21vb3RoJyxcbiAgICAgICAgbGVmdDogMCxcbiAgICAgICAgdG9wOiBzY3JvbGxUYXJnZXRcbiAgICAgIH0pO1xuICAgIH1cbiAgfTsgLy8gZm5UcmlnZ2VyQ2xpY2tcblxuICB3aW5kb3cub2xkT25zY3JvbGwgPSB3aW5kb3cub25zY3JvbGw7XG4gIHdpbmRvdy5vbnNjcm9sbCA9IGZuU2Nyb2xsQ29tcGxldGU7XG5cbiAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcblxuICAvLyBGaW5kIGFsbCBleGlzdGluZyB0cmlnZ2VycyBmb3Igc21vb3RoIHNjcm9sbGluZ1xuICB0cmlnZ2VycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwob3B0aW9ucy5zcHlTY3JvbGwpO1xuXG4gIGlmICh0cmlnZ2VycyAhPT0gbnVsbCkge1xuICAgIHRyaWdnZXJzLmZvckVhY2goZnVuY3Rpb24odHJpZ2dlciwgaSkge1xuICAgICAgdHJpZ2dlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZuVHJpZ2dlckNsaWNrKTtcbiAgICB9KTsgLy8gdHJpZ2dlcnMuZm9yRWFjaChmdW5jdGlvbih0cmlnZ2VyLCBpKVxuICB9IC8vIGlmICh0cmlnZ2VycyAhPT0gbnVsbClcblxuICAvL1xufTsgLy8gc2VlZFNjcm9sbFxuXG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgaWYgKHR5cGVvZiBtb2R1bGUuZXhwb3J0cy5TZWVkQ1NTID09PSAndW5kZWZpbmVkJykge1xuICAgIG1vZHVsZS5leHBvcnRzLlNlZWRDU1MgPSB7fTtcbiAgfVxuXG4gIG1vZHVsZS5leHBvcnRzLlNlZWRDU1Muc2Nyb2xsID0gc2VlZFNjcm9sbDtcbn0gZWxzZSB7XG4gIGlmICh0eXBlb2Ygd2luZG93LlNlZWRDU1MgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgd2luZG93LlNlZWRDU1MgPSB7fTtcbiAgfVxuXG4gIHdpbmRvdy5TZWVkQ1NTLnNjcm9sbCA9IHNlZWRTY3JvbGw7XG59XG4iLCIvKiohXG4gKiBTZWVkLUNTUyAtIEFkZGl0aW9uYWwgZmVhdHVyZXMgZm9yIEhUTUwgVGV4dGFyZWFzLlxuICogQGF1dGhvciBSb2dlcmlvIFRhcXVlcyAoaGVsbG9AYWJ0ei5jbylcbiAqIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL0FidHpMYWJzL3NlZWQtY3NzXG4gKiBAdmVyc2lvbiAyLjAuMVxuICogQGxpY2Vuc2UgTUlUXG4gKi9cblxuY29uc3Qgc2VlZFRleHRhcmVhID0gZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvLyBGaW5kIGFsbCBzZWVkLWZpbGUgaW5wdXRzLlxuICBjb25zdCBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmllbGQgPiB0ZXh0YXJlYScpO1xuXG4gIGlmIChpbnB1dHMgIT09IG51bGwpIHtcbiAgICBpbnB1dHMuZm9yRWFjaChmdW5jdGlvbihpbnB1dCwgaSkge1xuICAgICAgbGV0IG1heExlbmd0aCA9IDA7XG5cbiAgICAgIGNvbnN0IHBhcmVudCA9IGlucHV0LnBhcmVudE5vZGU7XG4gICAgICBjb25zdCBjb3VudGVyTGFiZWwgPSBwYXJlbnQucXVlcnlTZWxlY3RvcignW3JvbGU9XCJjb3VudGVyXCJdJyk7XG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9XG4gICAgICAgIGNvdW50ZXJMYWJlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGVtcGxhdGUnKSB8fFxuICAgICAgICAnVHlwZWQgJWEgb3V0IG9mICViLiBSZW1haW5pbmcgJWMuJztcblxuICAgICAgY29uc3QgZm5DYWxjID0gKCkgPT4ge1xuICAgICAgICBjb25zdCB0eXBlZCA9IGlucHV0LnZhbHVlLnJlcGxhY2UoL1tcXG5cXHJdL2csICcnKS5sZW5ndGg7XG4gICAgICAgIGNvbnN0IHJlbWFpbmluZyA9IG1heExlbmd0aCAtIHR5cGVkO1xuICAgICAgICBjb25zdCBtaW5MZW5ndGggPSBNYXRoLmZsb29yKG1heExlbmd0aCAqIDAuMSk7XG5cbiAgICAgICAgY291bnRlckxhYmVsLmlubmVySFRNTCA9IHRlbXBsYXRlXG4gICAgICAgICAgLnJlcGxhY2UoJyVhJywgdHlwZWQpXG4gICAgICAgICAgLnJlcGxhY2UoJyViJywgbWF4TGVuZ3RoKVxuICAgICAgICAgIC5yZXBsYWNlKFxuICAgICAgICAgICAgJyVjJyxcbiAgICAgICAgICAgIHJlbWFpbmluZyA8PSBtaW5MZW5ndGhcbiAgICAgICAgICAgICAgPyBgPHNwYW4gY2xhc3M9XCJyZWRcIiA+JHtyZW1haW5pbmd9PC9zcGFuPmBcbiAgICAgICAgICAgICAgOiByZW1haW5pbmdcbiAgICAgICAgICApO1xuICAgICAgfTtcblxuICAgICAgbWF4TGVuZ3RoID0gaW5wdXQuZ2V0QXR0cmlidXRlKCdtYXhsZW5ndGgnKTtcblxuICAgICAgLy8gSWdub3JlIGlmIG1heGxlbmd0aCBpcyBub3QgZ2l2ZW5cbiAgICAgIGlmICghbWF4TGVuZ3RoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gTWFrZSBzdXJlIHRoZSBsaW1pdCBpcyBhbiBpbnRlZ2VyXG4gICAgICBtYXhMZW5ndGggPSBwYXJzZUludChtYXhMZW5ndGgpO1xuXG4gICAgICAvLyBBdHRhY2ggdGhlIGhhbmRsZXJzXG4gICAgICAna2V5cHJlc3Mga2V5ZG93biBrZXl1cCcuc3BsaXQoJyAnKS5mb3JFYWNoKChldnQpID0+IHtcbiAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihldnQsIGZuQ2FsYywgdHJ1ZSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgdXRpbGl0eSBsYWJlbFxuICAgICAgZm5DYWxjKCk7XG4gICAgfSk7IC8vIGlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uKGlucHV0LCBpKVxuICB9IC8vIGlmIChpbnB1dHMgIT09IG51bGwpXG59OyAvLyBzZWVkVGV4dGFyZWFcblxuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gIGlmICh0eXBlb2YgbW9kdWxlLmV4cG9ydHMuU2VlZENTUyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBtb2R1bGUuZXhwb3J0cy5TZWVkQ1NTID0ge307XG4gIH1cblxuICBtb2R1bGUuZXhwb3J0cy5TZWVkQ1NTLnRleHRBcmVhID0gc2VlZFRleHRhcmVhO1xufSBlbHNlIHtcbiAgaWYgKHR5cGVvZiB3aW5kb3cuU2VlZENTUyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICB3aW5kb3cuU2VlZENTUyA9IHt9O1xuICB9XG5cbiAgd2luZG93LlNlZWRDU1MudGV4dEFyZWEgPSBzZWVkVGV4dGFyZWE7XG59XG4iLCIvKipcbiAqIFNlZWQtQ1NTIC0gTGFuZGluZyBQYWdlLlxuICogQGF1dGhvciBSb2dlcmlvIFRhcXVlcyAoaGVsbG9AYWJ0ei5jbylcbiAqIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL0FidHpMYWJzL3NlZWQtY3NzXG4gKiBAdmVyc2lvbiAyLjAuMVxuICogQGxpY2Vuc2UgcHJpdmF0ZVxuICovXG5cbigoKSA9PiB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvKipcbiAgICogRW5hYmxlcyB0aGUgZ3JpZCBwbGF5Z3JvdW5kIHdoZXJlIHVzZXIgY2FuIGFkZCBhbmQgcmVtb3ZlXG4gICAqIGNvbGx1bW5zIGluIHRoZSBzYW1wbGUgcGFnZS5cbiAgICovXG4gIGNvbnN0IGVuYWJsZUdyaWRQbGF5Z3JvdW5kID0gKCkgPT4ge1xuICAgIC8vIGFkZCBjb2x1bW5zXG4gICAgJCgnI2FkZC1jb2wnKVxuICAgICAgLm9mZignY2xpY2snKVxuICAgICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICBpZiAoZXZ0KSB7XG4gICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByb3cgPSAkKCcjZmxleGlibGUtY29scycpO1xuICAgICAgICBjb25zdCBjb2xzID0gcm93LmZpbmQoJy5jb2wnKTtcblxuICAgICAgICBpZiAoY29scy5sZW5ndGggPCAxMikge1xuICAgICAgICAgIGNvbnN0IGNvdW50ID0gY29scy5sZW5ndGg7XG4gICAgICAgICAgY29uc3QgcmVtYWluID0gMTIgLSBjb3VudDtcbiAgICAgICAgICBjb25zdCBsYXN0Q2xhc3MgPSAnc20tJyArIHJlbWFpbjtcblxuICAgICAgICAgIHJvd1xuICAgICAgICAgICAgLmZpbmQoJy5jb2wnKVxuICAgICAgICAgICAgLnJlbW92ZUNsYXNzKFxuICAgICAgICAgICAgICAnc20tMSBzbS0yIHNtLTMgc20tNCBzbS01IHNtLTYgc20tNyBzbS04IHNtLTkgc20tMTAgc20tMTEgc20tMTInXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgcm93XG4gICAgICAgICAgICAuZmluZCgnLmNvbDpsYXN0JylcbiAgICAgICAgICAgIC5hZnRlcigkKCc8ZGl2IC8+JywgeyBjbGFzczogJ2NvbCBhbGlnbi1jZW50ZXInIH0pLmh0bWwoY291bnQgKyAxKSk7XG5cbiAgICAgICAgICByb3cuZmluZCgnLmNvbCcpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdzbS0xJyk7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICByb3cuZmluZCgnLmNvbDpsYXN0JykudG9nZ2xlQ2xhc3MoJ3NtLTEgJyArIGxhc3RDbGFzcyk7XG5cbiAgICAgICAgICAkKCcjcmVtLWNvbCcpLmF0dHIoJ2Rpc2FibGVkJywgZmFsc2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNvbHMubGVuZ3RoID49IDExKSB7XG4gICAgICAgICAgJCh0aGlzKS5hdHRyKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgIC8vIHJlbW92ZSBjb2x1bW5zXG4gICAgJCgnI3JlbS1jb2wnKVxuICAgICAgLm9mZignY2xpY2snKVxuICAgICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICBpZiAoZXZ0KSB7XG4gICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByb3cgPSAkKCcjZmxleGlibGUtY29scycpO1xuICAgICAgICBjb25zdCBjb2xzID0gcm93LmZpbmQoJy5jb2wnKTtcblxuICAgICAgICBpZiAoY29scy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgY29uc3QgcmVtYWluID0gY29scy5sZW5ndGggLSAxO1xuICAgICAgICAgIGNvbnN0IGxhc3RDbGFzcyA9ICdzbS0nICsgKDEyIC0gcmVtYWluICsgMSk7XG5cbiAgICAgICAgICByb3cuZmluZCgnLmNvbDpsYXN0JykucmVtb3ZlKCk7XG5cbiAgICAgICAgICByb3dcbiAgICAgICAgICAgIC5maW5kKCcuY29sOmxhc3QnKVxuICAgICAgICAgICAgLnJlbW92ZUNsYXNzKFxuICAgICAgICAgICAgICAnc20tMSBzbS0yIHNtLTMgc20tNCBzbS01IHNtLTYgc20tNyBzbS04IHNtLTkgc20tMTAgc20tMTEgc20tMTInXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuYWRkQ2xhc3MobGFzdENsYXNzKTtcblxuICAgICAgICAgICQoJyNhZGQtY29sJykuYXR0cignZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY29scy5sZW5ndGggPD0gMikge1xuICAgICAgICAgICQodGhpcykuYXR0cignZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH07XG5cbiAgLy8gSW5pdCBncmlkIHBsYXlncm91bmRcbiAgZW5hYmxlR3JpZFBsYXlncm91bmQoKTtcblxuICBpZiAodHlwZW9mIFNlZWRDU1MgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgY29uc3QgbSA9IFNlZWRDU1MubW9kYWwoKTsgLy8gSW5pdCB0aGUgbW9kYWwgaGVscGVyXG4gICAgY29uc3QgYyA9IFNlZWRDU1Mub2ZmQ2FudmFzKCk7IC8vIEluaXQgdGhlIG9mZkNhbnZhcyBoZWxwZXJcbiAgICBjb25zdCBtb2RhbCA9IG0uZ2V0KCcjbW9kYWwnKTtcbiAgICBjb25zdCBjYW52YXMgPSBjLmdldCgnI3NpZGVuYXYnKTtcblxuICAgIFNlZWRDU1MuZmlsZVVwbG9hZCgpOyAvLyBJbml0IHRoZSBmaWxlVXBsb2FkIGhlbHBlclxuICAgIFNlZWRDU1MudGV4dEFyZWEoKTsgLy8gSW5pdCB0aGUgdGV4dEFyZWEgaGVscGVyXG4gICAgU2VlZENTUy5zY3JvbGwoKTsgLy8gSW5pdCB0aGUgc2Nyb2xsIGhlbHBlclxuXG4gICAgaWYgKG1vZGFsKSB7XG4gICAgICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKCdtb2RhbC5vcGVuZWQnLCAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdNb2RhbCBPcGVuZWQnKTtcbiAgICAgIH0pO1xuXG4gICAgICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKCdtb2RhbC5jbG9zZWQnLCAoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdNb2RhbCBDbG9zZWQnKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChjYW52YXMpIHtcbiAgICAgIGxldCBjYW52YXNTdHlsZVN3aXRjaGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI29mZmNhbnZhcy1zdHlsZScpO1xuXG4gICAgICBpZiAoY2FudmFzU3R5bGVTd2l0Y2hlcikge1xuICAgICAgICBjYW52YXNTdHlsZVN3aXRjaGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICBpZiAoY2FudmFzU3R5bGVTd2l0Y2hlci52YWx1ZSA9PT0gJ292ZXJsYXknKSB7XG4gICAgICAgICAgICBjYW52YXMuY2xhc3NMaXN0LmFkZCgnb3ZlcmxheScpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYW52YXMuY2xhc3NMaXN0LnJlbW92ZSgnb3ZlcmxheScpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdjYW52YXMub3BlbmVkJywgKCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnU2lkZSBNZW51IE9wZW5lZCcpO1xuICAgICAgfSk7XG5cbiAgICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCdjYW52YXMuY2xvc2VkJywgKCkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZygnU2lkZSBNZW51IENsb3NlZCcpO1xuICAgICAgfSk7XG5cbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbC5jb21wbGV0ZScsICgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ0ZpbmlzaGVkIHNtb290aCBzY3JvbGxpbmcnKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufSkoKTtcblxuLy8gKGZ1bmN0aW9uKCQpIHtcbi8vICAgJ3VzZSBzdHJpY3QnO1xuXG4vLyAgIHZhciBndXR0ZXIgPSA1MDtcblxuLy8gICAvKipcbi8vICAgICogRW5hYmxlcyB0aGUgaGVybyBlZmZlY3QuXG4vLyAgICAqL1xuLy8gICB2YXIgZW5hYmxlSGVybyA9IGZ1bmN0aW9uKCkge1xuLy8gICAgICQod2luZG93KS5vbignc2Nyb2xsJywgZnVuY3Rpb24oKSB7XG4vLyAgICAgICB2YXIgc2Nyb2xsID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpO1xuXG4vLyAgICAgICAkKCdoZWFkZXInKS5jc3Moe1xuLy8gICAgICAgICAnYmFja2dyb3VuZC1zaXplJzogMTAwICsgc2Nyb2xsIC8gMjAgKyAnJSAnICsgKDEwMCArIHNjcm9sbCAvIDIwKSArICclJ1xuLy8gICAgICAgfSk7XG4vLyAgICAgfSk7XG4vLyAgIH07XG5cbi8vICAgLyoqXG4vLyAgICAqIEVuYWJsZXMgdGhlIHNjcm9sbCBzcHkgd2hpY2ggaGlnaGxpZ2h0cyB0aGUgbWVudSBpdGVtXG4vLyAgICAqIGFzIHNvb24gYXMgdGhlIHVzZXIgc2Nyb2xscyBvbiBpdHMgY29udGVudCBwb3NpdGlvbi5cbi8vICAgICovXG4vLyAgIHZhciBlbmFibGVTY3JvbGxTcHkgPSBmdW5jdGlvbigpIHtcbi8vICAgICAvLyBEZWZpbmUgdGhlIGluaXRpYWwgcG9zaXRpb24gZm9yIGFsbCBuYXZzLlxuLy8gICAgICQoJy5zYW1wbGVzLW5hdicpLmVhY2goZnVuY3Rpb24oaSwgZWwpIHtcbi8vICAgICAgIHZhciBfdGhpcyA9ICQoZWwpO1xuLy8gICAgICAgdmFyIHJlZiA9ICQoX3RoaXMuZGF0YSgnYXR0YWNoJykpO1xuXG4vLyAgICAgICBfdGhpcy5kYXRhKHtcbi8vICAgICAgICAgd2lkdGg6IF90aGlzLndpZHRoKCksXG4vLyAgICAgICAgIHN0YXJ0OiByZWYub2Zmc2V0KCkudG9wIC0gKGd1dHRlciArIGkgKiAxMClcbi8vICAgICAgIH0pO1xuLy8gICAgIH0pO1xuXG4vLyAgICAgJCh3aW5kb3cpXG4vLyAgICAgICAvLyBNYWtlcyBzaWRlIG5hdiBzY3JvbGxpbmcgdG9nZXRoZXIgdG8gdGhlIHNjcmVlbi5cbi8vICAgICAgIC5vbignc2Nyb2xsJywgZnVuY3Rpb24oKSB7XG4vLyAgICAgICAgICQoJy5zYW1wbGVzLW5hdicpLmVhY2goZnVuY3Rpb24oaSwgZWwpIHtcbi8vICAgICAgICAgICB2YXIgX3RoaXMgPSAkKGVsKTtcbi8vICAgICAgICAgICB2YXIgc3RhcnQgPSBfdGhpcy5kYXRhKCdzdGFydCcpO1xuLy8gICAgICAgICAgIHZhciBsaW1pdCA9ICQoX3RoaXMuZGF0YSgnbGltaXQnKSkub2Zmc2V0KCkudG9wIC0gZ3V0dGVyO1xuLy8gICAgICAgICAgIHZhciBzY3JvbGwgPSAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7XG5cbi8vICAgICAgICAgICBpZiAoc2Nyb2xsICsgZ3V0dGVyID49IF90aGlzLmRhdGEoJ3N0YXJ0JykpIHtcbi8vICAgICAgICAgICAgIGlmICghX3RoaXMuaGFzQ2xhc3MoJ3N0YWNrZWQnKSkge1xuLy8gICAgICAgICAgICAgICBfdGhpcy5hZGRDbGFzcygnc3RhY2tlZCcpO1xuLy8gICAgICAgICAgICAgfVxuXG4vLyAgICAgICAgICAgICBpZiAoc2Nyb2xsICsgX3RoaXMuaGVpZ2h0KCkgPCBsaW1pdCkge1xuLy8gICAgICAgICAgICAgICBfdGhpcy5jc3Moe1xuLy8gICAgICAgICAgICAgICAgIHdpZHRoOiBfdGhpcy5kYXRhKCd3aWR0aCcpLFxuLy8gICAgICAgICAgICAgICAgIHRvcDogTWF0aC5mcm91bmQoc2Nyb2xsIC0gX3RoaXMuZGF0YSgnc3RhcnQnKSArIGd1dHRlcilcbi8vICAgICAgICAgICAgICAgfSk7XG4vLyAgICAgICAgICAgICB9IGVsc2UgaWYgKFxuLy8gICAgICAgICAgICAgICBzY3JvbGwgPCBfdGhpcy5kYXRhKCdzdGFydCcpICYmXG4vLyAgICAgICAgICAgICAgIF90aGlzLmhhc0NsYXNzKCdzdGFja2VkJylcbi8vICAgICAgICAgICAgICkge1xuLy8gICAgICAgICAgICAgICBfdGhpcy5yZW1vdmVDbGFzcygnc3RhY2tlZCcpO1xuLy8gICAgICAgICAgICAgICBfdGhpcy5jc3Moe1xuLy8gICAgICAgICAgICAgICAgIHRvcDogJycsXG4vLyAgICAgICAgICAgICAgICAgd2lkdGg6ICcnXG4vLyAgICAgICAgICAgICAgIH0pO1xuLy8gICAgICAgICAgICAgfVxuLy8gICAgICAgICAgIH1cbi8vICAgICAgICAgfSk7XG4vLyAgICAgICB9KVxuLy8gICAgICAgLy8gTWFrZXMgdGhlIHNpZGUgbmF2IGl0ZW1zIGhpZ2hsaXRoZWQgd2hlbiBzY3JvbGwgaW50byBpdHMgY29udGVudFxuLy8gICAgICAgLm9uKCdzY3JvbGwgcmVzaXplJywgZnVuY3Rpb24oKSB7XG4vLyAgICAgICAgIHZhciBzY3JvbGwgPSAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7XG5cbi8vICAgICAgICAgJCgnLnNweScpXG4vLyAgICAgICAgICAgLm5vdCgnLmlnbm9yZScpXG4vLyAgICAgICAgICAgLmVhY2goZnVuY3Rpb24oaSwgZWwpIHtcbi8vICAgICAgICAgICAgIHZhciBfZWwgPSAkKGVsKTtcbi8vICAgICAgICAgICAgIHZhciByZWYgPSAkKF9lbC5hdHRyKCdocmVmJykpO1xuXG4vLyAgICAgICAgICAgICBpZiAoXG4vLyAgICAgICAgICAgICAgIHJlZi5vZmZzZXQoKSAhPT0gdW5kZWZpbmVkICYmXG4vLyAgICAgICAgICAgICAgIHNjcm9sbCA+PSByZWYub2Zmc2V0KCkudG9wIC0gZ3V0dGVyICYmXG4vLyAgICAgICAgICAgICAgIHNjcm9sbCA8IHJlZi5vZmZzZXQoKS50b3AgKyByZWYuaGVpZ2h0KCkgLSBndXR0ZXJcbi8vICAgICAgICAgICAgICkge1xuLy8gICAgICAgICAgICAgICAkKCcuc3B5LmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbi8vICAgICAgICAgICAgICAgX2VsLmFkZENsYXNzKCdhY3RpdmUnKTtcbi8vICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuLy8gICAgICAgICAgICAgfVxuLy8gICAgICAgICAgIH0pO1xuLy8gICAgICAgfSk7XG5cbi8vICAgICAvLyBTbW9vdGggdGhlIHNjcm9sbGluZyB3aGVuIHVzZXIgY2xpY2tzIG9uIGFueSBpdGVtIGZyb20gc2lkZSBuYXYuXG4vLyAgICAgJCgnLnNweScpLmVhY2goZnVuY3Rpb24oaSwgZWwpIHtcbi8vICAgICAgIHZhciBfZWwgPSAkKGVsKTtcblxuLy8gICAgICAgX2VsLm9uKCdjbGljaycsIGZ1bmN0aW9uKGV2dCkge1xuLy8gICAgICAgICB2YXIgcmVmID0gJChfZWwuYXR0cignaHJlZicpKTtcblxuLy8gICAgICAgICAkKCdodG1sLCBib2R5JykuYW5pbWF0ZShcbi8vICAgICAgICAgICB7XG4vLyAgICAgICAgICAgICBzY3JvbGxUb3A6IHJlZi5vZmZzZXQoKS50b3AgLSBndXR0ZXIgKyAyMFxuLy8gICAgICAgICAgIH0sXG4vLyAgICAgICAgICAgNDAwXG4vLyAgICAgICAgICk7XG4vLyAgICAgICB9KTtcbi8vICAgICB9KTtcbi8vICAgfTtcblxuLy8gICBlbmFibGVIZXJvKCk7XG4vLyAgIGVuYWJsZVNjcm9sbFNweSgpO1xuLy8gICBlbmFibGVHcmlkUGxheWdyb3VuZCgpO1xuXG4vLyAgIC8vIFNldHVwIGZpbGVVcGxvYWRcbi8vICAgaWYgKHR5cGVvZiBmaWxlVXBsb2FkICE9PSAndW5kZWZpbmVkJykge1xuLy8gICAgIGZpbGVVcGxvYWQoKTtcbi8vICAgfVxuXG4vLyAgIC8vIFNldHVwIG1vZGFsXG4vLyAgIGlmICh0eXBlb2YgbW9kYWwgIT09ICd1bmRlZmluZWQnKSB7XG4vLyAgICAgbW9kYWwoKTtcbi8vICAgfVxuXG4vLyAgIC8vIGdldCB2ZXJzaW9uIHNoaWVsZCBmcm9tIGdpdGh1Yi9zaGlsZHMuaW9cbi8vICAgLy8gQGRlcHJlY2F0ZWRcbi8vICAgLy8gJC5nZXQoJ2h0dHBzOi8vaW1nLnNoaWVsZHMuaW8vZ2l0aHViL3JlbGVhc2Uvcm9nZXJpb3RhcXVlcy9zZWVkLWNzcy5qc29uJywgZnVuY3Rpb24gKGRhdGEpIHtcbi8vICAgLy8gICAkKCcjcmVsZWFzZScpLmh0bWwoIGRhdGEudmFsdWUgKTtcbi8vICAgLy8gfSk7XG4vLyAgIC8vIH0pO1xuLy8gfSkoalF1ZXJ5KTtcbiJdfQ==
