"use strict";!function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}return"function"!=typeof window.CustomEvent&&(t.prototype=window.Event.prototype,void(window.CustomEvent=t))}();
"use strict";var seedFileUpload=function(){var e,t=function(t){t&&t.preventDefault();var i=!1,n=this,r=n.nextElementSibling;n.files&&n.files.length>1?i=(n.getAttribute("data-multiple")||"{count} files").replace("{count}",n.files.length):n.value.trim().length>0&&(i=n.value.split("\\").pop()),i&&(r.querySelector(".input").innerHTML=i),""!==n.value&&(e=new CustomEvent("file.chosen"),n.parentNode.classList.add("chosen"),n.dispatchEvent(e))},i=document.querySelectorAll('.seed-file > [type="file"]');return null!==i&&i.forEach(function(i,n){var r=i.nextElementSibling,l=r.querySelector(".cancel"),u=i.getAttribute("data-empty")||"No file chosen";r&&(i.getAttribute("id")&&i.getAttribute("id")!==r.getAttribute("for")?r.setAttribute("for",i.getAttribute("id")):r.getAttribute("for")&&!i.getAttribute("id")?i.setAttribute("id",r.getAttribute("for")):r.getAttribute("for")||i.getAttribute("id")||(i.setAttribute("id","file-input-"+n),r.setAttribute("for","file-input-"+n)),l&&l.addEventListener("click",function(t){t&&t.preventDefault();var n=i.getAttribute("data-empty")||"No file chosen";i.value="",i.parentNode.classList.remove("chosen"),r.querySelector(".input").innerHTML=n,e=new CustomEvent("file.removed"),i.dispatchEvent(e)}),r.querySelector(".input").innerHTML=u,i.addEventListener("change",t))}),{get:function(e){if("string"==typeof e){var t=!1;return i.forEach(function(i){if(i.id===e.replace(/^#/,""))return void(t=i)}),t}return"undefined"!=typeof i[e]&&i[e]}}};"undefined"!=typeof module&&(module.exports.fileUpload=fileUpload),"undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.fileUpload=seedFileUpload;
"use strict";var fnOpen,fnClose,fnEsc,seedModal=function(e){var n={trigger:'[role="modal"]',classAnimation:{open:"bounceInDown",close:"bounceOutUp"}};e=Object.assign({},n,e);var o=document.querySelectorAll(".modal"),t=document.querySelectorAll(e.trigger);return fnClose=function(n){if(n){var o,t=document.querySelector("html"),a=n.querySelector(".modal-window");a&&(document.removeEventListener("keydown",fnEsc),a.classList.replace(e.classAnimation.open,e.classAnimation.close),n.classList.add("delay-1s"),n.classList.replace("fadeIn","fadeOut"),setTimeout(function(){o=new CustomEvent("modal.closed"),n.dispatchEvent(o),n.classList.add("hide"),t.style.overflow="",n.classList.remove("delay-1s","fadeOut"),a.classList.replace(e.classAnimation.close,e.classAnimation.open)},600))}},fnOpen=function(n){if(n){var o,t=document.querySelector("html"),a=n.querySelector(".modal-window");fnEsc=function(e){var o=e.keyCode||e.which;27===o&&fnClose(n)},a&&(document.addEventListener("keydown",fnEsc),n.style.display="",n.classList.add("animated","fadeIn","fast"),a.classList.add("animated",e.classAnimation.open),n.classList.remove("hide"),t.style.overflow="hidden",setTimeout(function(){o=new CustomEvent("modal.opened"),n.dispatchEvent(o)},100))}},null!==o&&o.forEach(function(e,n){var o=e.querySelectorAll('[role="modal-dismiss"]');e.addEventListener("click",function(n){for(var o=n.target,t=!1;"html"!==o.nodeName.toLowerCase();){if(o.classList.contains("modal-window")){t=!0;break}o=o.parentNode}t||fnClose(e)}),e.show=function(){fnOpen(e)},e.hide=function(){fnClose(e)},null!==o&&o.forEach(function(n,o){n.addEventListener("click",function(n){n&&(n.preventDefault(),n.stopPropagation()),fnClose(e)})})}),null!==t&&t.forEach(function(e,n){e.addEventListener("click",function(n){n&&n.preventDefault();var o=e.getAttribute("data-modal-id");if(null!==o){var t=document.querySelector("#".concat(o));fnOpen(t)}})}),t=void 0,{get:function(e){if("string"==typeof e){var n=!1;return o.forEach(function(o){if(o.id===e.replace(/^#/,""))return void(n=o)}),n}return"undefined"!=typeof o[e]&&o[e]}}};"undefined"!=typeof module&&(module.exports.seedModal=seedModal),"undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.modal=seedModal;
"use strict";var fnOutsideClickHandler,fnToggle,fnTriggerClick,seedOffCanvas=function(){var e="canvas-opened";fnOutsideClickHandler=function(t){for(var n=t.target,a=!1,c=document.querySelector("html");!a&&n&&n.parentNode;)n.classList&&!n.classList.contains("offcanvas")?n=n.parentNode:n.classList&&(a=!0);!a&&c.classList.contains(e)&&fnToggle(c.getAttribute("data-canvas-id"))},fnToggle=function(t,n){var a,c=document.querySelector("#".concat(t.replace(/^#/,""))),o=n||document.querySelector('[role="offcanvas"][data-id="'.concat(t.replace(/^#/,""),'"]'));if(null!==c){var s=document.querySelector("html");s.classList.contains(e)?(c.classList.remove("open"),document.querySelectorAll('[role="offcanvas"][data-id="'.concat(t.replace(/^#/,""),'"]')).forEach(function(e){e.classList.remove("triggered")}),s.removeEventListener("click",fnOutsideClickHandler),s.style.overflow=""):(c.classList.add("open"),null!==o&&o.classList.add("triggered"),s.addEventListener("click",fnOutsideClickHandler),s.style.overflow="hidden"),setTimeout(function(){c.classList.contains("open")?(s.classList.add(e),s.setAttribute("data-canvas-id",t.replace(/^#/,"")),a=new CustomEvent("canvas.opened")):(s.classList.remove(e),a=new CustomEvent("canvas.closed")),c.dispatchEvent(a)},300)}},fnTriggerClick=function(e){e&&e.preventDefault(),fnToggle(e.currentTarget.getAttribute("data-id")||"offcanvas",e.currentTarget)};var t=document.querySelectorAll('[role="offcanvas"]'),n=document.querySelectorAll(".offcanvas");return null!==t&&t.forEach(function(e,t){e.addEventListener("click",fnTriggerClick,!1)}),null!==n&&n.forEach(function(t,n){t.open=function(){var n=document.querySelector("html");n.classList.contains(e)||fnToggle(t.getAttribute("id")||"offcanvas")},t.close=function(){var n=document.querySelector("html");n.classList.contains(e)&&fnToggle(t.getAttribute("id")||"offcanvas")},t.toggle=function(){fnToggle(t.getAttribute("id")||"offcanvas")}}),{get:function(e){if("string"==typeof e){var t=!1;return n.forEach(function(n){if(n.id===e.replace(/^#/,""))return void(t=n)}),t}return"undefined"!=typeof canvas[e]&&canvas[e]}}};"undefined"!=typeof module&&(module.exports.seedOffCanvas=seedOffCanvas),"undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.offCanvas=seedOffCanvas;
"use strict";var seedScroll=function(e){var t=null,n=null,o=0,i={spyScrollSelector:"nav a.smooth",revealElementSelector:".reveal",revealSpaceOffset:.2,revealWhenVisible:"visible",revealSingleAnimation:"visible-once",revealWhenHidden:"hidden",gutter:50},l=function(e){t.forEach(function(e){e.classList.remove("active")}),e&&e.classList.add("active")},r=function(e){var t=document.body.getBoundingClientRect(),n=e?e.getBoundingClientRect():0;return{top:Math.ceil(n.top-t.top),left:Math.ceil(n.left-t.left)}},c=function(n){if(window.scrollY===o){var i=new CustomEvent("scroll.complete");document.dispatchEvent(i)}if(t){var c=r(t[0]);window.scrollY<c.top&&l(),t.forEach(function(t,n){try{var o=t.getAttribute("href")||t.getAttribute("data-target"),i=document.querySelector(o),c=r(i);if(c.top-e.gutter<=window.scrollY)return void l(t)}catch(d){}})}"function"==typeof window.oldOnscroll&&window.oldOnscroll(n)},d=function(t){t&&t.preventDefault();var n=t.currentTarget.getAttribute("href")||t.currentTarget.getAttribute("data-target");if(n){var i=document.querySelector(n);o=r(i).top-e.gutter,window.scrollTo({behavior:"smooth",left:0,top:o})}},a=function(){var t=function(){return{width:window.document.documentElement.clientWidth,height:window.document.documentElement.clientHeight}},o=function(){return{x:window.pageXOffset,y:window.pageYOffset}},i=function(e){var t=e,n=0,o=0,i=t.offsetWidth,l=t.offsetHeight;do isNaN(t.offsetTop)||(n+=t.offsetTop),isNaN(t.offsetLeft)||(o+=t.offsetLeft);while(null!==(t=t.offsetParent));return{top:n,left:o,height:l,width:i}},l=function(n){var l=t(),r=o(),c=i(n),d=e.revealSpaceOffset,a=function(){var e=c.top+c.height*d,t=c.left+c.width*d,n=c.left+c.width-c.width*d,o=c.top+c.height-c.height*d,i=r.y+0,a=r.x+0,s=r.y-0+l.height,f=r.x-0+l.width;return e<s&&o>i&&t>a&&n<f};return a()},r=function(){if(n)for(var t=0;t<n.length;t+=1)l(n[t])?(e.revealWhenVisible&&n[t].classList.add(e.revealWhenVisible),e.revealWhenHidden&&n[t].classList.remove(e.revealWhenHidden)):n[t].classList.contains(e.revealSingleAnimation)===!1&&(e.revealWhenHidden&&n[t].classList.add(e.revealWhenHidden),e.revealWhenVisible&&n[t].classList.remove(e.revealWhenVisible))},c=function(e){r()};window.addEventListener("scroll",c,!1),window.addEventListener("resize",c,!1)};return window.oldOnscroll=window.onscroll,window.onscroll=c,e=Object.assign({},i,e),t=document.querySelectorAll(e.spyScrollSelector),n=document.querySelectorAll(e.revealElementSelector),null!==t&&t.forEach(function(e,t){e.addEventListener("click",d,!1)}),n&&a(),{}};"undefined"!=typeof module&&(module.exports.seedScroll=seedScroll),"undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.scroll=seedScroll;
"use strict";var seedTextarea=function(){var e=document.querySelectorAll(".field > textarea");null!==e&&e.forEach(function(e,t){var a=0,r=e.parentNode,n=r.querySelector('[role="counter"]'),o=n.getAttribute("data-template")||"Typed %a out of %b. Remaining %c.",d=function(){var t=e.value.replace(/[\n\r]/g,"").length,r=a-t,d=Math.floor(.1*a);n.innerHTML=o.replace("%a",t).replace("%b",a).replace("%c",r<=d?'<span class="red" >'.concat(r,"</span>"):r)};a=e.getAttribute("maxlength"),a&&(a=parseInt(a),"keypress keydown keyup".split(" ").forEach(function(t){e.addEventListener(t,d,!0)}),d())})};"undefined"!=typeof module&&(module.exports.seedTextarea=seedTextarea),"undefined"==typeof window.SeedCSS&&(window.SeedCSS={}),window.SeedCSS.textArea=seedTextarea;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbUV2ZW50UG9seWZpbGwuanMiLCJzZWVkRmlsZVVwbG9hZC5qcyIsInNlZWRNb2RhbC5qcyIsInNlZWRPZmZDYW52YXMuanMiLCJzZWVkU2Nyb2xsLmpzIiwic2VlZFRleHRhcmVhLmpzIl0sIm5hbWVzIjpbIkN1c3RvbUV2ZW50IiwiZXZlbnQiLCJwYXJhbXMiLCJidWJibGVzIiwiY2FuY2VsYWJsZSIsImRldGFpbCIsInVuZGVmaW5lZCIsImV2dCIsImRvY3VtZW50IiwiY3JlYXRlRXZlbnQiLCJpbml0Q3VzdG9tRXZlbnQiLCJ3aW5kb3ciLCJwcm90b3R5cGUiLCJFdmVudCIsInNlZWRGaWxlVXBsb2FkIiwic2VlZEN1c3RvbUV2ZW50IiwiZm5DaGFuZ2UiLCJwcmV2ZW50RGVmYXVsdCIsImZpbGVOYW1lIiwiaW5wdXQiLCJ0aGlzIiwibGFiZWwiLCJuZXh0RWxlbWVudFNpYmxpbmciLCJmaWxlcyIsImxlbmd0aCIsImdldEF0dHJpYnV0ZSIsInJlcGxhY2UiLCJ2YWx1ZSIsInRyaW0iLCJzcGxpdCIsInBvcCIsInF1ZXJ5U2VsZWN0b3IiLCJpbm5lckhUTUwiLCJwYXJlbnROb2RlIiwiY2xhc3NMaXN0IiwiYWRkIiwiZGlzcGF0Y2hFdmVudCIsImlucHV0cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiaSIsImNhbmNlbCIsImVtcHR5VGV4dCIsInNldEF0dHJpYnV0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmUiLCJnZXQiLCJpZHgiLCJmaWxlVXBsb2FkIiwibm9kZSIsImlkIiwibW9kdWxlIiwiZXhwb3J0cyIsIlNlZWRDU1MiLCJmbk9wZW4iLCJmbkNsb3NlIiwiZm5Fc2MiLCJzZWVkTW9kYWwiLCJvcHRpb25zIiwiZGVmYXVsdE9wdGlvbnMiLCJ0cmlnZ2VyIiwiY2xhc3NBbmltYXRpb24iLCJvcGVuIiwiY2xvc2UiLCJPYmplY3QiLCJhc3NpZ24iLCJtb2RhbHMiLCJtb2RhbFRyaWdnZXJzIiwibW9kYWxPYmplY3QiLCJjdXN0b21FdmVudCIsImh0bWwiLCJtV2luIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldFRpbWVvdXQiLCJzdHlsZSIsIm92ZXJmbG93IiwiZSIsImtleSIsImtleUNvZGUiLCJ3aGljaCIsImRpc3BsYXkiLCJtb2RhbCIsImRpc21pc3NhbHMiLCJ0YXJnZXQiLCJhYm9ydCIsIm5vZGVOYW1lIiwidG9Mb3dlckNhc2UiLCJjb250YWlucyIsInNob3ciLCJoaWRlIiwiZGlzbWlzcyIsImoiLCJzdG9wUHJvcGFnYXRpb24iLCJyZWYiLCJjb25jYXQiLCJmbk91dHNpZGVDbGlja0hhbmRsZXIiLCJmblRvZ2dsZSIsImZuVHJpZ2dlckNsaWNrIiwic2VlZE9mZkNhbnZhcyIsIm9wZW5lZE9mZmNhbnZhc0NsYXNzIiwiZXYiLCJhIiwiZm91bmQiLCJjYW52YXNJRCIsInRyaWdnZXJFbGVtZW50IiwiY2FudmFzIiwidGdyIiwiY3VycmVudFRhcmdldCIsInRyaWdnZXJzIiwiY2FudmFzZXMiLCJ0b2dnbGUiLCJvZmZDYW52YXMiLCJzZWVkU2Nyb2xsIiwicmV2ZWFsZXJzIiwic2Nyb2xsVGFyZ2V0Iiwic3B5U2Nyb2xsU2VsZWN0b3IiLCJyZXZlYWxFbGVtZW50U2VsZWN0b3IiLCJyZXZlYWxTcGFjZU9mZnNldCIsInJldmVhbFdoZW5WaXNpYmxlIiwicmV2ZWFsU2luZ2xlQW5pbWF0aW9uIiwicmV2ZWFsV2hlbkhpZGRlbiIsImd1dHRlciIsImZuVXBkYXRlQWN0aXZlVHJpZ2dlciIsImVsZW0iLCJlbCIsImZuR2V0T2Zmc2V0IiwiYm9keU9mZnNldCIsImJvZHkiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJvZmZzZXQiLCJ0b3AiLCJNYXRoIiwiY2VpbCIsImxlZnQiLCJmblNjcm9sbENvbXBsZXRlIiwic2Nyb2xsWSIsImZpcnN0RWxlbWVudE9mZnNldCIsInRhcmdldElEIiwib2xkT25zY3JvbGwiLCJzY3JvbGxUbyIsImJlaGF2aW9yIiwiZm5XYXRjaEVsZW1lbnRzIiwiZ2V0Vmlld3BvcnRTaXplIiwid2lkdGgiLCJkb2N1bWVudEVsZW1lbnQiLCJjbGllbnRXaWR0aCIsImhlaWdodCIsImNsaWVudEhlaWdodCIsImdldEN1cnJlbnRTY3JvbGwiLCJ4IiwicGFnZVhPZmZzZXQiLCJ5IiwicGFnZVlPZmZzZXQiLCJnZXRFbGVtSW5mbyIsIm9mZnNldFRvcCIsIm9mZnNldExlZnQiLCJvZmZzZXRXaWR0aCIsIm9mZnNldEhlaWdodCIsImlzTmFOIiwib2Zmc2V0UGFyZW50IiwiaXNFbGVtZW50VmlzaWJsZSIsInZpZXdwb3J0U2l6ZSIsImN1cnJlbnRTY3JvbGwiLCJlSW5mIiwic3BhY2VPZmZzZXQiLCJjaGVja0JvdW5kYXJpZXMiLCJlVG9wIiwiZUxlZnQiLCJlUmlnaHQiLCJlQm90dG9tIiwid1RvcCIsIndMZWZ0Iiwid0JvdHRvbSIsIndSaWdodCIsInRvZ2dsZUVsZW1lbnQiLCJzY3JvbGxSZXNpemVIYW5kbGVyIiwib25zY3JvbGwiLCJzY3JvbGwiLCJzZWVkVGV4dGFyZWEiLCJtYXhMZW5ndGgiLCJwYXJlbnQiLCJjb3VudGVyTGFiZWwiLCJ0ZW1wbGF0ZSIsImZuQ2FsYyIsInR5cGVkIiwicmVtYWluaW5nIiwibWluTGVuZ3RoIiwiZmxvb3IiLCJwYXJzZUludCIsInRleHRBcmVhIl0sIm1hcHBpbmdzIjoiQUFBQSxjQUtBLFdBR0UsUUFBU0EsR0FBWUMsRUFBT0MsR0FDMUJBLEVBQVNBLElBQVlDLFNBQVMsRUFBT0MsWUFBWSxFQUFPQyxPQUFRQyxPQUNoRSxJQUFJQyxHQUFNQyxTQUFTQyxZQUFZLGNBTy9CLE9BTkFGLEdBQUlHLGdCQUNGVCxFQUNBQyxFQUFPQyxRQUNQRCxFQUFPRSxXQUNQRixFQUFPRyxRQUVGRSxFQVhULE1BQWtDLGtCQUF2QkksUUFBT1gsY0FjbEJBLEVBQVlZLFVBQVlELE9BQU9FLE1BQU1ELGVBRXJDRCxPQUFPWCxZQUFjQTtBQ3RCdkIsWUFNQSxJQUFNYyxnQkFBaUIsV0FHckIsR0FBSUMsR0FFRUMsRUFBVyxTQUFrQlQsR0FDN0JBLEdBQ0ZBLEVBQUlV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bGwgZm9yIEN1c3RvbUV2ZW50XG4gKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9DdXN0b21FdmVudC9DdXN0b21FdmVudCNQb2x5ZmlsbFxuICovXG5cbihmdW5jdGlvbiAoKSB7XG4gIGlmICh0eXBlb2Ygd2luZG93LkN1c3RvbUV2ZW50ID09PSAnZnVuY3Rpb24nKSByZXR1cm4gZmFsc2U7XG5cbiAgZnVuY3Rpb24gQ3VzdG9tRXZlbnQoZXZlbnQsIHBhcmFtcykge1xuICAgIHBhcmFtcyA9IHBhcmFtcyB8fCB7IGJ1YmJsZXM6IGZhbHNlLCBjYW5jZWxhYmxlOiBmYWxzZSwgZGV0YWlsOiB1bmRlZmluZWQgfTtcbiAgICB2YXIgZXZ0ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XG4gICAgZXZ0LmluaXRDdXN0b21FdmVudChcbiAgICAgIGV2ZW50LFxuICAgICAgcGFyYW1zLmJ1YmJsZXMsXG4gICAgICBwYXJhbXMuY2FuY2VsYWJsZSxcbiAgICAgIHBhcmFtcy5kZXRhaWxcbiAgICApO1xuICAgIHJldHVybiBldnQ7XG4gIH1cblxuICBDdXN0b21FdmVudC5wcm90b3R5cGUgPSB3aW5kb3cuRXZlbnQucHJvdG90eXBlO1xuXG4gIHdpbmRvdy5DdXN0b21FdmVudCA9IEN1c3RvbUV2ZW50O1xufSkoKTtcbiIsIi8qKiFcbiAqIFNlZWQtQ1NTIC0gQ3VzdG9tIEhUTUwgSW5wdXQgRmlsZS5cbiAqIEBjb3B5cmlnaHQgMjAxOSwgQWJ0eiBMYWJzXG4gKiBAbGljZW5zZSBNSVRcbiAqL1xuXG5jb25zdCBzZWVkRmlsZVVwbG9hZCA9IGZ1bmN0aW9uKCkge1xuICAndXNlIHN0cmljdCc7XG5cbiAgbGV0IHNlZWRDdXN0b21FdmVudDtcblxuICBjb25zdCBmbkNoYW5nZSA9IGZ1bmN0aW9uIGZuQ2hhbmdlKGV2dCkge1xuICAgIGlmIChldnQpIHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cblxuICAgIGxldCBmaWxlTmFtZSA9IGZhbHNlO1xuXG4gICAgY29uc3QgaW5wdXQgPSB0aGlzO1xuICAgIGNvbnN0IGxhYmVsID0gaW5wdXQubmV4dEVsZW1lbnRTaWJsaW5nO1xuXG4gICAgLy8gV2hlbiBtdWx0aXBsZSBmaWxlcyBhcmUgc2VsZWN0ZWRcbiAgICBpZiAoaW5wdXQuZmlsZXMgJiYgaW5wdXQuZmlsZXMubGVuZ3RoID4gMSkge1xuICAgICAgZmlsZU5hbWUgPSAoaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLW11bHRpcGxlJykgfHwgJ3tjb3VudH0gZmlsZXMnKS5yZXBsYWNlKCd7Y291bnR9JywgaW5wdXQuZmlsZXMubGVuZ3RoKTtcbiAgICB9XG5cbiAgICAvLyBXaGVuIG9ubHkgb25lIGZpbGUgaXMgc2VsZWN0ZWRcbiAgICBlbHNlIGlmIChpbnB1dC52YWx1ZS50cmltKCkubGVuZ3RoID4gMCkge1xuICAgICAgZmlsZU5hbWUgPSBpbnB1dC52YWx1ZS5zcGxpdCgnXFxcXCcpLnBvcCgpO1xuICAgIH1cblxuICAgIGlmIChmaWxlTmFtZSkge1xuICAgICAgbGFiZWwucXVlcnlTZWxlY3RvcignLmlucHV0JykuaW5uZXJIVE1MID0gZmlsZU5hbWU7XG4gICAgfVxuXG4gICAgaWYgKGlucHV0LnZhbHVlICE9PSAnJykge1xuICAgICAgc2VlZEN1c3RvbUV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KCdmaWxlLmNob3NlbicpO1xuICAgICAgaW5wdXQucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKCdjaG9zZW4nKTtcbiAgICAgIGlucHV0LmRpc3BhdGNoRXZlbnQoc2VlZEN1c3RvbUV2ZW50KTtcbiAgICB9XG4gIH07IC8vIGZuQ2hhbmdlXG5cbiAgLy8gRmluZCBhbGwgc2VlZC1maWxlIGlucHV0cy5cbiAgY29uc3QgaW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNlZWQtZmlsZSA+IFt0eXBlPVwiZmlsZVwiXScpO1xuXG4gIGlmIChpbnB1dHMgIT09IG51bGwpIHtcbiAgICBpbnB1dHMuZm9yRWFjaChmdW5jdGlvbihpbnB1dCwgaSkge1xuICAgICAgLy8gRmluZCB0aGUgZmllbGQgbGFiZWxcbiAgICAgIGNvbnN0IGxhYmVsID0gaW5wdXQubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgICAgY29uc3QgY2FuY2VsID0gbGFiZWwucXVlcnlTZWxlY3RvcignLmNhbmNlbCcpO1xuICAgICAgY29uc3QgZW1wdHlUZXh0ID0gaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLWVtcHR5JykgfHwgJ05vIGZpbGUgY2hvc2VuJztcblxuICAgICAgLy8gSWYgbGFiZWwgZG9lcyBub3QgZXhpc3RzLCBzaW1wbHkgZG8gbm90IHNldCBpdCB1cFxuICAgICAgaWYgKCFsYWJlbCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIE1ha2Ugc3VyZSBpbnB1dCBhbmQgbGFiZWwgbWF0Y2hlcyBhbmQgd29ya3MuXG4gICAgICBpZiAoaW5wdXQuZ2V0QXR0cmlidXRlKCdpZCcpICYmIGlucHV0LmdldEF0dHJpYnV0ZSgnaWQnKSAhPT0gbGFiZWwuZ2V0QXR0cmlidXRlKCdmb3InKSkge1xuICAgICAgICBsYWJlbC5zZXRBdHRyaWJ1dGUoJ2ZvcicsIGlucHV0LmdldEF0dHJpYnV0ZSgnaWQnKSk7XG4gICAgICB9IGVsc2UgaWYgKGxhYmVsLmdldEF0dHJpYnV0ZSgnZm9yJykgJiYgIWlucHV0LmdldEF0dHJpYnV0ZSgnaWQnKSkge1xuICAgICAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ2lkJywgbGFiZWwuZ2V0QXR0cmlidXRlKCdmb3InKSk7XG4gICAgICB9IGVsc2UgaWYgKCFsYWJlbC5nZXRBdHRyaWJ1dGUoJ2ZvcicpICYmICFpbnB1dC5nZXRBdHRyaWJ1dGUoJ2lkJykpIHtcbiAgICAgICAgaW5wdXQuc2V0QXR0cmlidXRlKCdpZCcsICdmaWxlLWlucHV0LScgKyBpKTtcbiAgICAgICAgbGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCAnZmlsZS1pbnB1dC0nICsgaSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFsd2F5cyB0aGUgY2FuY2VsIGJ1dHRvbiBleGlzdHMsIGFkZHMgYSBoYW5kbGVyXG4gICAgICBpZiAoY2FuY2VsKSB7XG4gICAgICAgIGNhbmNlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldnQpID0+IHtcbiAgICAgICAgICBpZiAoZXZ0KSB7XG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBlbXB0eVRleHQgPSBpbnB1dC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZW1wdHknKSB8fCAnTm8gZmlsZSBjaG9zZW4nO1xuXG4gICAgICAgICAgaW5wdXQudmFsdWUgPSAnJztcbiAgICAgICAgICBpbnB1dC5wYXJlbnROb2RlLmNsYXNzTGlzdC5yZW1vdmUoJ2Nob3NlbicpO1xuICAgICAgICAgIGxhYmVsLnF1ZXJ5U2VsZWN0b3IoJy5pbnB1dCcpLmlubmVySFRNTCA9IGVtcHR5VGV4dDtcblxuICAgICAgICAgIHNlZWRDdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudCgnZmlsZS5yZW1vdmVkJyk7XG4gICAgICAgICAgaW5wdXQuZGlzcGF0Y2hFdmVudChzZWVkQ3VzdG9tRXZlbnQpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgbGFiZWwucXVlcnlTZWxlY3RvcignLmlucHV0JykuaW5uZXJIVE1MID0gZW1wdHlUZXh0O1xuXG4gICAgICAvLyBTdGFydCBsaXN0ZW5pbmcgdGhlIGZpZWxkIGZvciBjaGFuZ2VzXG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmbkNoYW5nZSk7XG4gICAgfSk7IC8vIGlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uKGlucHV0LCBpKVxuICB9IC8vIGlmIChpbnB1dHMgIT09IG51bGwpXG5cbiAgcmV0dXJuIHtcbiAgICBnZXQ6IChpZHgpID0+IHtcbiAgICAgIGlmICh0eXBlb2YgaWR4ID09PSAnc3RyaW5nJykge1xuICAgICAgICBsZXQgZmlsZVVwbG9hZCA9IGZhbHNlO1xuXG4gICAgICAgIGlucHV0cy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgICAgaWYgKG5vZGUuaWQgPT09IGlkeC5yZXBsYWNlKC9eIy8sICcnKSkge1xuICAgICAgICAgICAgZmlsZVVwbG9hZCA9IG5vZGU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gZmlsZVVwbG9hZDtcbiAgICAgIH1cblxuICAgICAgaWYgKHR5cGVvZiBpbnB1dHNbaWR4XSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0c1tpZHhdO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9O1xufTsgLy8gc2VlZEZpbGVVcGxvYWRcblxuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gIG1vZHVsZS5leHBvcnRzLmZpbGVVcGxvYWQgPSBmaWxlVXBsb2FkO1xufVxuXG4vLyBFeHBvc2UgU2VlZENTUyBpbiB0aGUgZ2xvYmFsIHNjb3BlXG5pZiAodHlwZW9mIHdpbmRvdy5TZWVkQ1NTID09PSAndW5kZWZpbmVkJykge1xuICB3aW5kb3cuU2VlZENTUyA9IHt9O1xufVxuXG4vLyBFeHBvc2UgZmlsZVVwbG9hZCBtZW51IGluIHRoZSBnbG9iYWwgc2NvcGVcbndpbmRvdy5TZWVkQ1NTLmZpbGVVcGxvYWQgPSBzZWVkRmlsZVVwbG9hZDtcbiIsIi8qKiFcbiAqIFNlZWQtQ1NTIC0gTW9kYWxcbiAqIEBjb3B5cmlnaHQgMjAxOSwgQWJ0eiBMYWJzXG4gKiBAbGljZW5zZSBNSVRcbiAqL1xuXG5sZXQgZm5PcGVuO1xuXG5sZXQgZm5DbG9zZTtcblxubGV0IGZuRXNjO1xuXG5jb25zdCBzZWVkTW9kYWwgPSAob3B0aW9ucykgPT4ge1xuICAndXNlIHN0cmljdCc7XG5cbiAgLy8gRGVmYXVsdCBzZXR0aW5nc1xuICBjb25zdCBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAvLyB0aGUgZWxlbWVudCB0aGF0IHRyaWdnZXJzIHRoZSBtb2RhbFxuICAgIHRyaWdnZXI6ICdbcm9sZT1cIm1vZGFsXCJdJyxcblxuICAgIC8vIEBzZWU6IGh0dHBzOi8vZGFuZWRlbi5naXRodWIuaW8vYW5pbWF0ZS5jc3MvXG4gICAgLy8gYW5pbWF0ZS5jc3MgY2xhc3NlcyB0byBiZSB1c2VkXG4gICAgY2xhc3NBbmltYXRpb246IHtcbiAgICAgIG9wZW46ICdib3VuY2VJbkRvd24nLFxuICAgICAgY2xvc2U6ICdib3VuY2VPdXRVcCdcbiAgICB9XG4gIH07XG5cbiAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcblxuICAvLyBHZXQgZWxlbWVudHNcbiAgbGV0IG1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RhbCcpO1xuICBsZXQgbW9kYWxUcmlnZ2VycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwob3B0aW9ucy50cmlnZ2VyKTtcblxuICBmbkNsb3NlID0gKG1vZGFsT2JqZWN0KSA9PiB7XG4gICAgaWYgKCFtb2RhbE9iamVjdCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGxldCBjdXN0b21FdmVudDtcbiAgICBjb25zdCBodG1sID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaHRtbCcpO1xuICAgIGNvbnN0IG1XaW4gPSBtb2RhbE9iamVjdC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtd2luZG93Jyk7XG5cbiAgICBpZiAoIW1XaW4pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBSZW1vdmVzIHRoZSBFU0MgbGlzdGVuZXJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZm5Fc2MpO1xuXG4gICAgLy8gUmVwbGFjZSBvcGVuIGFuaW1hdGlvbiB0byBjbG9zZSB0aGUgbW9kYWwgd2luZG93XG4gICAgbVdpbi5jbGFzc0xpc3QucmVwbGFjZShvcHRpb25zLmNsYXNzQW5pbWF0aW9uLm9wZW4sIG9wdGlvbnMuY2xhc3NBbmltYXRpb24uY2xvc2UpO1xuXG4gICAgLy8gQWRkIGFuaW1hdGlvbiB0byB0aGUgb3ZlcmxheVxuICAgIG1vZGFsT2JqZWN0LmNsYXNzTGlzdC5hZGQoJ2RlbGF5LTFzJyk7XG4gICAgbW9kYWxPYmplY3QuY2xhc3NMaXN0LnJlcGxhY2UoJ2ZhZGVJbicsICdmYWRlT3V0Jyk7XG5cbiAgICAvLyBXYWl0IDIgc2Vjb25kcyBiZWZvcmUgY29tcGxldGUgZGUgcHJvY2Vzcy5cbiAgICAvLyBUaGlzIGlzIHRoZSB0aW1lIHRvIGZpbmlzaGluZyBhbGwgYW5pbWF0ZS5jc3MgYW5pbWF0aW9uc1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgLy8gRGlzcGF0Y2ggdGhlICdtb2RhbC5jbG9zZWQnIGV2ZW50XG4gICAgICBjdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudCgnbW9kYWwuY2xvc2VkJyk7XG4gICAgICBtb2RhbE9iamVjdC5kaXNwYXRjaEV2ZW50KGN1c3RvbUV2ZW50KTtcblxuICAgICAgLy8gQ29tcGxldGVseSBoaWRlIHRoZSBjb21wb25lbnRcbiAgICAgIG1vZGFsT2JqZWN0LmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcbiAgICAgIC8vIFJlZW5hYmxlIHNjcm9sbGluZyBmcm9tIHRoZSBIVE1MXG4gICAgICBodG1sLnN0eWxlLm92ZXJmbG93ID0gJyc7XG4gICAgICAvLyBSZW1vdmUgY2xvc2luZyBjbGFzc2VzIGZyb20gb3ZlcmxheVxuICAgICAgbW9kYWxPYmplY3QuY2xhc3NMaXN0LnJlbW92ZSgnZGVsYXktMXMnLCAnZmFkZU91dCcpO1xuICAgICAgLy8gUmVtb3ZlIGNsb3NpbmcgY2xhc3NlcyBmcm9tIG1vZGFsIHdpbmRvd1xuICAgICAgbVdpbi5jbGFzc0xpc3QucmVwbGFjZShvcHRpb25zLmNsYXNzQW5pbWF0aW9uLmNsb3NlLCBvcHRpb25zLmNsYXNzQW5pbWF0aW9uLm9wZW4pO1xuICAgIH0sIDYwMCk7XG4gIH07IC8vIGZuQ2xvc2VcblxuICBmbk9wZW4gPSAobW9kYWxPYmplY3QpID0+IHtcbiAgICBpZiAoIW1vZGFsT2JqZWN0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgbGV0IGN1c3RvbUV2ZW50O1xuICAgIGNvbnN0IGh0bWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdodG1sJyk7XG4gICAgY29uc3QgbVdpbiA9IG1vZGFsT2JqZWN0LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC13aW5kb3cnKTtcblxuICAgIC8vIEhhbmRsZSB0aGUgRVNDIGRpc21pc3NcbiAgICBmbkVzYyA9IGZ1bmN0aW9uIGVzY0hhbmRsZXIoZSkge1xuICAgICAgY29uc3Qga2V5ID0gZS5rZXlDb2RlIHx8IGUud2hpY2g7XG5cbiAgICAgIC8vIFdoZW4gdGhlIEVTQyBrZXkgaXMgcHJlc3NlZFxuICAgICAgaWYgKGtleSA9PT0gMjcpIHtcbiAgICAgICAgZm5DbG9zZShtb2RhbE9iamVjdCk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGlmICghbVdpbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEFkZCAoYW5kIHJlbW92ZSkgYW4gRVNDIGhhbmRsZXIgZm9yIHRoZSBvdmVybGF5XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZuRXNjKTtcblxuICAgIC8vIENsZWFyIGlubGluZSBkaXNwbGF5IHN0eWxlLCBpZiBhbnlcbiAgICBtb2RhbE9iamVjdC5zdHlsZS5kaXNwbGF5ID0gJyc7XG4gICAgLy8gQWRkIGFuaW1hdGlvbiB0byB0aGUgb3ZlcmxheVxuICAgIG1vZGFsT2JqZWN0LmNsYXNzTGlzdC5hZGQoJ2FuaW1hdGVkJywgJ2ZhZGVJbicsICdmYXN0Jyk7XG4gICAgLy8gQWRkIGFuaW1hdGlvbiB0byB0aGUgbW9kYWwgd2luZG93XG4gICAgbVdpbi5jbGFzc0xpc3QuYWRkKCdhbmltYXRlZCcsIG9wdGlvbnMuY2xhc3NBbmltYXRpb24ub3Blbik7XG4gICAgLy8gU2hvdyB0aGUgY29tcG9uZW50XG4gICAgbW9kYWxPYmplY3QuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpO1xuICAgIC8vIEZpbmFsbHkgcHJldmVudCBzY3JvbGxpbmdcbiAgICBodG1sLnN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XG5cbiAgICAvLyBXYWl0IHRoZSBhbmltYXRpb24gY29tcGxldGUgdG8gZGlzcGF0Y2ggdGhlIGV2ZW50XG4gICAgLy8gRWFjaCBhbmltYXRlLmNzcyBhbmltYXRpb24gdGFrZXMgMXNcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIC8vIERpc3BhdGNoIHRoZSAnbW9kYWwub3BlbmVkJyBldmVudFxuICAgICAgY3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ21vZGFsLm9wZW5lZCcpO1xuICAgICAgbW9kYWxPYmplY3QuZGlzcGF0Y2hFdmVudChjdXN0b21FdmVudCk7XG4gICAgfSwgMTAwKTtcbiAgfTsgLy8gZm5PcGVuXG5cbiAgaWYgKG1vZGFscyAhPT0gbnVsbCkge1xuICAgIG1vZGFscy5mb3JFYWNoKChtb2RhbCwgaSkgPT4ge1xuICAgICAgLy8gSGFuZGxlIHRoZSBkaXNtaXNzIGJ1dHRvbnNcbiAgICAgIGNvbnN0IGRpc21pc3NhbHMgPSBtb2RhbC5xdWVyeVNlbGVjdG9yQWxsKCdbcm9sZT1cIm1vZGFsLWRpc21pc3NcIl0nKTtcblxuICAgICAgLy8gQWRkIChhbmQgcmVtb3ZlKSBhIGNsaWNrIGhhbmRsZXIgb24gdGhlIG92ZXJsYXlcbiAgICAgIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xuICAgICAgICBsZXQgeyB0YXJnZXQgfSA9IGV2dDtcbiAgICAgICAgbGV0IGFib3J0ID0gZmFsc2U7XG5cbiAgICAgICAgLy8gRG8gbm90IGNsb3NlIHRoZSBtb2RhbCB3aGVuIHRoZSBjbGljayBpcyBpbnNpZGUgbW9kYWwtd2luZG93XG4gICAgICAgIHdoaWxlICh0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gJ2h0bWwnKSB7XG4gICAgICAgICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsLXdpbmRvdycpKSB7XG4gICAgICAgICAgICBhYm9ydCA9IHRydWU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0YXJnZXQgPSB0YXJnZXQucGFyZW50Tm9kZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghYWJvcnQpIHtcbiAgICAgICAgICBmbkNsb3NlKG1vZGFsKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIEFkZCBwcm90b3R5cGUgZm9yIHNob3cgKG9wZW4pXG4gICAgICBtb2RhbC5zaG93ID0gKCkgPT4ge1xuICAgICAgICBmbk9wZW4obW9kYWwpO1xuICAgICAgfTtcblxuICAgICAgLy8gQWRkIHByb3RvdHlwZSBmb3IgaGlkZSAoY2xvZGUpXG4gICAgICBtb2RhbC5oaWRlID0gKCkgPT4ge1xuICAgICAgICBmbkNsb3NlKG1vZGFsKTtcbiAgICAgIH07XG5cbiAgICAgIGlmIChkaXNtaXNzYWxzICE9PSBudWxsKSB7XG4gICAgICAgIGRpc21pc3NhbHMuZm9yRWFjaCgoZGlzbWlzcywgaikgPT4ge1xuICAgICAgICAgIGRpc21pc3MuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXZ0KSB7XG4gICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZuQ2xvc2UobW9kYWwpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0gLy8gaWYgKGRpc21pc3NhbHMgIT09IG51bGwpXG4gICAgfSk7XG4gIH0gLy8gaWYgKG1vZGFscyAhPT0gbnVsbClcblxuICBpZiAobW9kYWxUcmlnZ2VycyAhPT0gbnVsbCkge1xuICAgIG1vZGFsVHJpZ2dlcnMuZm9yRWFjaCgodHJpZ2dlciwgaSkgPT4ge1xuICAgICAgdHJpZ2dlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldnQpID0+IHtcbiAgICAgICAgaWYgKGV2dCkge1xuICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVmID0gdHJpZ2dlci5nZXRBdHRyaWJ1dGUoJ2RhdGEtbW9kYWwtaWQnKTtcblxuICAgICAgICBpZiAocmVmICE9PSBudWxsKSB7XG4gICAgICAgICAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtyZWZ9YCk7XG4gICAgICAgICAgZm5PcGVuKG1vZGFsKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH0gLy8gaWYgKG1vZGFsVHJpZ2dlcnMgIT09IG51bGwpXG5cbiAgbW9kYWxUcmlnZ2VycyA9IHVuZGVmaW5lZDtcblxuICByZXR1cm4ge1xuICAgIGdldDogKGlkeCkgPT4ge1xuICAgICAgaWYgKHR5cGVvZiBpZHggPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIGxldCBtb2RhbCA9IGZhbHNlO1xuXG4gICAgICAgIG1vZGFscy5mb3JFYWNoKChub2RlKSA9PiB7XG4gICAgICAgICAgaWYgKG5vZGUuaWQgPT09IGlkeC5yZXBsYWNlKC9eIy8sICcnKSkge1xuICAgICAgICAgICAgbW9kYWwgPSBub2RlO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIG1vZGFsO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIG1vZGFsc1tpZHhdICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm4gbW9kYWxzW2lkeF07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG59OyAvLyBzZWVkTW9kYWxcblxuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gIG1vZHVsZS5leHBvcnRzLnNlZWRNb2RhbCA9IHNlZWRNb2RhbDtcbn1cblxuLy8gRXhwb3NlIFNlZWRDU1MgaW4gdGhlIGdsb2JhbCBzY29wZVxuaWYgKHR5cGVvZiB3aW5kb3cuU2VlZENTUyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgd2luZG93LlNlZWRDU1MgPSB7fTtcbn1cblxuLy8gRXhwb3NlIG1vZGFsIG1lbnUgaW4gdGhlIGdsb2JhbCBzY29wZVxud2luZG93LlNlZWRDU1MubW9kYWwgPSBzZWVkTW9kYWw7XG4iLCIvKiohXG4gKiBTZWVkLUNTUyAtIE9mZi1DYW52YXMuXG4gKiBAY29weXJpZ2h0IDIwMTksIEFidHogTGFic1xuICogQGxpY2Vuc2UgTUlUXG4gKi9cblxubGV0IGZuT3V0c2lkZUNsaWNrSGFuZGxlcjtcblxubGV0IGZuVG9nZ2xlO1xuXG5sZXQgZm5UcmlnZ2VyQ2xpY2s7XG5cbmNvbnN0IHNlZWRPZmZDYW52YXMgPSBmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIGNvbnN0IG9wZW5lZE9mZmNhbnZhc0NsYXNzID0gJ2NhbnZhcy1vcGVuZWQnO1xuXG4gIGZuT3V0c2lkZUNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uKGV2KSB7XG4gICAgbGV0IGEgPSBldi50YXJnZXQ7XG4gICAgbGV0IGZvdW5kID0gZmFsc2U7XG5cbiAgICBjb25zdCBodG1sID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaHRtbCcpO1xuXG4gICAgd2hpbGUgKCFmb3VuZCkge1xuICAgICAgaWYgKCFhIHx8ICFhLnBhcmVudE5vZGUpIHtcbiAgICAgICAgLy8gSXQgc2VlbXMgd2UndmUgcmVhY2hlZCB0aGUgcm9vdCAoaHRtbClcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG5cbiAgICAgIGlmIChhLmNsYXNzTGlzdCAmJiAhYS5jbGFzc0xpc3QuY29udGFpbnMoJ29mZmNhbnZhcycpKSB7XG4gICAgICAgIC8vIE5laXRoZXIgZm91bmQgLmNhbnZhcyBub3IgdGhlIHJvb3QgbGV2ZWxcbiAgICAgICAgYSA9IGEucGFyZW50Tm9kZTtcbiAgICAgIH0gZWxzZSBpZiAoYS5jbGFzc0xpc3QpIHtcbiAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghZm91bmQgJiYgaHRtbC5jbGFzc0xpc3QuY29udGFpbnMob3BlbmVkT2ZmY2FudmFzQ2xhc3MpKSB7XG4gICAgICAvLyBJdCBzZWVtcyBoYXMgaGFwcGVuZWQgYW4gb3V0c2lkZXIgY2xpY2tcbiAgICAgIGZuVG9nZ2xlKGh0bWwuZ2V0QXR0cmlidXRlKCdkYXRhLWNhbnZhcy1pZCcpKTtcbiAgICB9XG4gIH07XG5cbiAgZm5Ub2dnbGUgPSAoY2FudmFzSUQsIHRyaWdnZXJFbGVtZW50KSA9PiB7XG4gICAgbGV0IGN1c3RvbUV2ZW50O1xuXG4gICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7Y2FudmFzSUQucmVwbGFjZSgvXiMvLCAnJyl9YCk7XG5cbiAgICBjb25zdCB0cmlnZ2VyID1cbiAgICAgIHRyaWdnZXJFbGVtZW50IHx8IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtyb2xlPVwib2ZmY2FudmFzXCJdW2RhdGEtaWQ9XCIke2NhbnZhc0lELnJlcGxhY2UoL14jLywgJycpfVwiXWApO1xuXG4gICAgaWYgKGNhbnZhcyAhPT0gbnVsbCkge1xuICAgICAgY29uc3QgaHRtbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKTtcblxuICAgICAgaWYgKCFodG1sLmNsYXNzTGlzdC5jb250YWlucyhvcGVuZWRPZmZjYW52YXNDbGFzcykpIHtcbiAgICAgICAgY2FudmFzLmNsYXNzTGlzdC5hZGQoJ29wZW4nKTtcblxuICAgICAgICBpZiAodHJpZ2dlciAhPT0gbnVsbCkge1xuICAgICAgICAgIC8vIEFkZCB0aGUgJ3RyaWdnZXJlZCcgY2xhc3MgdG8gdGhlIGVsZW1lbnQgd2hpY2ggaGFzIHRyaWdnZXJlZCB0aGUgb2ZmY2FudmFzLlxuICAgICAgICAgIHRyaWdnZXIuY2xhc3NMaXN0LmFkZCgndHJpZ2dlcmVkJyk7XG4gICAgICAgIH0gLy8gaWYgKHRyaWdnZXIgIT09IG51bGwpXG5cbiAgICAgICAgLy8gUHJldmVudHMgbWFpbiB0byBzY3JvbGxcbiAgICAgICAgaHRtbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZuT3V0c2lkZUNsaWNrSGFuZGxlcik7XG4gICAgICAgIGh0bWwuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNhbnZhcy5jbGFzc0xpc3QucmVtb3ZlKCdvcGVuJyk7XG5cbiAgICAgICAgLy8gUmVtb3ZlIHRoZSAndHJpZ2dlcmVkJyBjbGFzcyBmb3IgYW55IGV4aXN0aW5nIHRyaWdnZXIgd2hpY2ggcmVmZXJzIGdpdmVuIG9mZmNhbnZhcy5cbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgW3JvbGU9XCJvZmZjYW52YXNcIl1bZGF0YS1pZD1cIiR7Y2FudmFzSUQucmVwbGFjZSgvXiMvLCAnJyl9XCJdYCkuZm9yRWFjaCgodGdyKSA9PiB7XG4gICAgICAgICAgdGdyLmNsYXNzTGlzdC5yZW1vdmUoJ3RyaWdnZXJlZCcpO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBSZS1lbmFibGVzIG1haW4gc2Nyb2xsaW5nXG4gICAgICAgIGh0bWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmbk91dHNpZGVDbGlja0hhbmRsZXIpO1xuICAgICAgICBodG1sLnN0eWxlLm92ZXJmbG93ID0gJyc7XG4gICAgICB9XG5cbiAgICAgIC8vIFdhaXQgdW50aWwgYW5pbWF0aW9uIGlzIGNvbXBsZXRlIHRvIGRpc3BhdGNoIHRoZSBldmVudFxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGlmIChjYW52YXMuY2xhc3NMaXN0LmNvbnRhaW5zKCdvcGVuJykpIHtcbiAgICAgICAgICBodG1sLmNsYXNzTGlzdC5hZGQob3BlbmVkT2ZmY2FudmFzQ2xhc3MpO1xuICAgICAgICAgIGh0bWwuc2V0QXR0cmlidXRlKCdkYXRhLWNhbnZhcy1pZCcsIGNhbnZhc0lELnJlcGxhY2UoL14jLywgJycpKTtcbiAgICAgICAgICBjdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudCgnY2FudmFzLm9wZW5lZCcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGh0bWwuY2xhc3NMaXN0LnJlbW92ZShvcGVuZWRPZmZjYW52YXNDbGFzcyk7XG4gICAgICAgICAgY3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ2NhbnZhcy5jbG9zZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERpc3BhdGNoIHRoZSAnY2FudmFzLm9wZW5lZCcvICdjYW52YXMuY2xvc2VkJyBldmVudHNcbiAgICAgICAgY2FudmFzLmRpc3BhdGNoRXZlbnQoY3VzdG9tRXZlbnQpO1xuICAgICAgfSwgMzAwKTtcbiAgICB9IC8vIGlmIChjYW52YXMgIT09IG51bGwpXG4gIH07IC8vIGZuVG9nZ2xlXG5cbiAgZm5UcmlnZ2VyQ2xpY2sgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dCkge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXG4gICAgZm5Ub2dnbGUoZXZ0LmN1cnJlbnRUYXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJykgfHwgJ29mZmNhbnZhcycsIGV2dC5jdXJyZW50VGFyZ2V0KTtcbiAgfTsgLy8gZm5UcmlnZ2VyQ2xpY2tcblxuICAvLyBGaW5kIGFsbCBleGlzdGluZyB0cmlnZ2Vyc1xuICBjb25zdCB0cmlnZ2VycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tyb2xlPVwib2ZmY2FudmFzXCJdJyk7XG5cbiAgLy8gRmluZCBhbGwgZXhpc3Rpbmcgb2ZmY2FudmFzXG4gIGNvbnN0IGNhbnZhc2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm9mZmNhbnZhcycpO1xuXG4gIGlmICh0cmlnZ2VycyAhPT0gbnVsbCkge1xuICAgIHRyaWdnZXJzLmZvckVhY2goZnVuY3Rpb24odHJpZ2dlciwgaSkge1xuICAgICAgdHJpZ2dlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZuVHJpZ2dlckNsaWNrLCBmYWxzZSk7XG4gICAgfSk7IC8vIHRyaWdnZXJzLmZvckVhY2goZnVuY3Rpb24odHJpZ2dlciwgaSlcbiAgfSAvLyBpZiAodHJpZ2dlcnMgIT09IG51bGwpXG5cbiAgaWYgKGNhbnZhc2VzICE9PSBudWxsKSB7XG4gICAgY2FudmFzZXMuZm9yRWFjaCgoY2FudmFzLCBpKSA9PiB7XG4gICAgICAvLyBBdHRhY2ggbWV0aG9kIGZvciBvcGVuaW5nXG4gICAgICBjYW52YXMub3BlbiA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgaHRtbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKTtcblxuICAgICAgICBpZiAoIWh0bWwuY2xhc3NMaXN0LmNvbnRhaW5zKG9wZW5lZE9mZmNhbnZhc0NsYXNzKSkge1xuICAgICAgICAgIGZuVG9nZ2xlKGNhbnZhcy5nZXRBdHRyaWJ1dGUoJ2lkJykgfHwgJ29mZmNhbnZhcycpO1xuICAgICAgICB9XG4gICAgICB9OyAvLyBvcGVuXG5cbiAgICAgIC8vIEF0dGFjaCBtZXRob2QgZm9yIGNsb3NpbmdcbiAgICAgIGNhbnZhcy5jbG9zZSA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgaHRtbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKTtcblxuICAgICAgICBpZiAoaHRtbC5jbGFzc0xpc3QuY29udGFpbnMob3BlbmVkT2ZmY2FudmFzQ2xhc3MpKSB7XG4gICAgICAgICAgZm5Ub2dnbGUoY2FudmFzLmdldEF0dHJpYnV0ZSgnaWQnKSB8fCAnb2ZmY2FudmFzJyk7XG4gICAgICAgIH1cbiAgICAgIH07IC8vIGNsb3NlXG5cbiAgICAgIC8vIEF0dGFjaCBtZXRob2QgZm9yIGNsb3NpbmdcbiAgICAgIGNhbnZhcy50b2dnbGUgPSAoKSA9PiB7XG4gICAgICAgIGZuVG9nZ2xlKGNhbnZhcy5nZXRBdHRyaWJ1dGUoJ2lkJykgfHwgJ29mZmNhbnZhcycpO1xuICAgICAgfTsgLy8gdG9nZ2xlXG4gICAgfSk7IC8vIGNhbnZhc2VzLmZvckVhY2goKGNhbnZhcywgaSlcbiAgfSAvLyBpZiAoY2FudmFzZXMgIT09IG51bGwpXG5cbiAgcmV0dXJuIHtcbiAgICBnZXQ6IChpZHgpID0+IHtcbiAgICAgIGlmICh0eXBlb2YgaWR4ID09PSAnc3RyaW5nJykge1xuICAgICAgICBsZXQgY2FudmFzID0gZmFsc2U7XG5cbiAgICAgICAgY2FudmFzZXMuZm9yRWFjaCgobm9kZSkgPT4ge1xuICAgICAgICAgIGlmIChub2RlLmlkID09PSBpZHgucmVwbGFjZSgvXiMvLCAnJykpIHtcbiAgICAgICAgICAgIGNhbnZhcyA9IG5vZGU7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gY2FudmFzO1xuICAgICAgfVxuXG4gICAgICBpZiAodHlwZW9mIGNhbnZhc1tpZHhdICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm4gY2FudmFzW2lkeF07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG59OyAvLyBzZWVkT2ZmQ2FudmFzXG5cbmlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xuICBtb2R1bGUuZXhwb3J0cy5zZWVkT2ZmQ2FudmFzID0gc2VlZE9mZkNhbnZhcztcbn1cblxuLy8gRXhwb3NlIFNlZWRDU1MgaW4gdGhlIGdsb2JhbCBzY29wZVxuaWYgKHR5cGVvZiB3aW5kb3cuU2VlZENTUyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgd2luZG93LlNlZWRDU1MgPSB7fTtcbn1cblxuLy8gRXhwb3NlIG9mZmNhbnZhcyBtZW51IGluIHRoZSBnbG9iYWwgc2NvcGVcbndpbmRvdy5TZWVkQ1NTLm9mZkNhbnZhcyA9IHNlZWRPZmZDYW52YXM7XG4iLCIvKiohXG4gKiBTZWVkLUNTUyAtIFNjcm9sbC5cbiAqIEBjb3B5cmlnaHQgMjAxOSwgQWJ0eiBMYWJzXG4gKiBAbGljZW5zZSBNSVRcbiAqL1xuXG5jb25zdCBzZWVkU2Nyb2xsID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAndXNlIHN0cmljdCc7XG5cbiAgbGV0IHRyaWdnZXJzID0gbnVsbDtcblxuICBsZXQgcmV2ZWFsZXJzID0gbnVsbDtcblxuICBsZXQgc2Nyb2xsVGFyZ2V0ID0gMDtcblxuICBjb25zdCBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICBzcHlTY3JvbGxTZWxlY3RvcjogJ25hdiBhLnNtb290aCcsXG4gICAgcmV2ZWFsRWxlbWVudFNlbGVjdG9yOiAnLnJldmVhbCcsXG4gICAgcmV2ZWFsU3BhY2VPZmZzZXQ6IDAuMixcbiAgICByZXZlYWxXaGVuVmlzaWJsZTogJ3Zpc2libGUnLFxuICAgIHJldmVhbFNpbmdsZUFuaW1hdGlvbjogJ3Zpc2libGUtb25jZScsXG4gICAgcmV2ZWFsV2hlbkhpZGRlbjogJ2hpZGRlbicsXG4gICAgZ3V0dGVyOiA1MFxuICB9OyAvLyBkZWZhdWx0T3B0aW9uc1xuXG4gIGNvbnN0IGZuVXBkYXRlQWN0aXZlVHJpZ2dlciA9IChlbGVtKSA9PiB7XG4gICAgdHJpZ2dlcnMuZm9yRWFjaCgoZWwpID0+IHtcbiAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xuICAgIH0pO1xuXG4gICAgaWYgKGVsZW0pIHtcbiAgICAgIGVsZW0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgfVxuICB9OyAvLyBmblVwZGF0ZUFjdGl2ZVRyaWdnZXJcblxuICBjb25zdCBmbkdldE9mZnNldCA9IChlbGVtKSA9PiB7XG4gICAgY29uc3QgYm9keU9mZnNldCA9IGRvY3VtZW50LmJvZHkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgY29uc3Qgb2Zmc2V0ID0gZWxlbSA/IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiAwO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvcDogTWF0aC5jZWlsKG9mZnNldC50b3AgLSBib2R5T2Zmc2V0LnRvcCksXG4gICAgICBsZWZ0OiBNYXRoLmNlaWwob2Zmc2V0LmxlZnQgLSBib2R5T2Zmc2V0LmxlZnQpXG4gICAgfTtcbiAgfTsgLy8gZm5HZXRPZmZzZXRcblxuICBjb25zdCBmblNjcm9sbENvbXBsZXRlID0gKGV2dCkgPT4ge1xuICAgIGlmICh3aW5kb3cuc2Nyb2xsWSA9PT0gc2Nyb2xsVGFyZ2V0KSB7XG4gICAgICBjb25zdCBzZWVkQ3VzdG9tRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoJ3Njcm9sbC5jb21wbGV0ZScpO1xuICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChzZWVkQ3VzdG9tRXZlbnQpO1xuICAgIH1cblxuICAgIGlmICh0cmlnZ2Vycykge1xuICAgICAgY29uc3QgZmlyc3RFbGVtZW50T2Zmc2V0ID0gZm5HZXRPZmZzZXQodHJpZ2dlcnNbMF0pO1xuXG4gICAgICBpZiAod2luZG93LnNjcm9sbFkgPCBmaXJzdEVsZW1lbnRPZmZzZXQudG9wKSB7XG4gICAgICAgIGZuVXBkYXRlQWN0aXZlVHJpZ2dlcigpO1xuICAgICAgfVxuXG4gICAgICB0cmlnZ2Vycy5mb3JFYWNoKChlbCwgaSkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHRhcmdldElEID1cbiAgICAgICAgICAgIGVsLmdldEF0dHJpYnV0ZSgnaHJlZicpIHx8IGVsLmdldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQnKTtcblxuICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGFyZ2V0SUQpO1xuICAgICAgICAgIGNvbnN0IG9mZnNldCA9IGZuR2V0T2Zmc2V0KHRhcmdldCk7XG5cbiAgICAgICAgICBpZiAob2Zmc2V0LnRvcCAtIG9wdGlvbnMuZ3V0dGVyIDw9IHdpbmRvdy5zY3JvbGxZKSB7XG4gICAgICAgICAgICBmblVwZGF0ZUFjdGl2ZVRyaWdnZXIoZWwpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge31cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2Ygd2luZG93Lm9sZE9uc2Nyb2xsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICB3aW5kb3cub2xkT25zY3JvbGwoZXZ0KTtcbiAgICB9XG4gIH07IC8vIGZuU2Nyb2xsQ29tcGxldGVcblxuICBjb25zdCBmblRyaWdnZXJDbGljayA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0KSB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG5cbiAgICBjb25zdCB0YXJnZXQgPVxuICAgICAgZXZ0LmN1cnJlbnRUYXJnZXQuZ2V0QXR0cmlidXRlKCdocmVmJykgfHxcbiAgICAgIGV2dC5jdXJyZW50VGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS10YXJnZXQnKTtcblxuICAgIGlmICh0YXJnZXQpIHtcbiAgICAgIGNvbnN0IGVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhcmdldCk7XG5cbiAgICAgIHNjcm9sbFRhcmdldCA9IGZuR2V0T2Zmc2V0KGVsZW0pLnRvcCAtIG9wdGlvbnMuZ3V0dGVyOyAvLyBhZGQgc29tZSBndXR0ZXJcblxuICAgICAgd2luZG93LnNjcm9sbFRvKHtcbiAgICAgICAgYmVoYXZpb3I6ICdzbW9vdGgnLFxuICAgICAgICBsZWZ0OiAwLFxuICAgICAgICB0b3A6IHNjcm9sbFRhcmdldFxuICAgICAgfSk7XG4gICAgfVxuICB9OyAvLyBmblRyaWdnZXJDbGlja1xuXG4gIGNvbnN0IGZuV2F0Y2hFbGVtZW50cyA9ICgpID0+IHtcbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIHZpZXdwb3J0ICh3aW5kb3cpIGRpbWVuc2lvbnMuXG4gICAgICogQHJldHVybiBvYmplY3RcbiAgICAgKi9cbiAgICBjb25zdCBnZXRWaWV3cG9ydFNpemUgPSAoKSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB3aWR0aDogd2luZG93LmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCxcbiAgICAgICAgaGVpZ2h0OiB3aW5kb3cuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodFxuICAgICAgfTtcbiAgICB9OyAvLyBnZXRWaWV3cG9ydFNpemVcblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudCBzY29sbCBwb3NpdGlvbi5cbiAgICAgKiBAcmV0dXJuIG9iamVjdFxuICAgICAqL1xuICAgIGNvbnN0IGdldEN1cnJlbnRTY3JvbGwgPSBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHg6IHdpbmRvdy5wYWdlWE9mZnNldCxcbiAgICAgICAgeTogd2luZG93LnBhZ2VZT2Zmc2V0XG4gICAgICB9O1xuICAgIH07IC8vIGdldEN1cnJlbnRTY3JvbGxcblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGVsZW1lbnQgZGltZW5zaW9uIGFuZCBwb3NpdGlvbi5cbiAgICAgKiBAcGFyYW0gSFRNTEVsZW1lbnQgZWxcbiAgICAgKiBAcmV0dXJuIG9iamVjdFxuICAgICAqL1xuICAgIGNvbnN0IGdldEVsZW1JbmZvID0gKGVsKSA9PiB7XG4gICAgICBsZXQgZWxlbSA9IGVsO1xuICAgICAgbGV0IG9mZnNldFRvcCA9IDA7XG4gICAgICBsZXQgb2Zmc2V0TGVmdCA9IDA7XG4gICAgICBjb25zdCBvZmZzZXRXaWR0aCA9IGVsZW0ub2Zmc2V0V2lkdGg7XG4gICAgICBjb25zdCBvZmZzZXRIZWlnaHQgPSBlbGVtLm9mZnNldEhlaWdodDtcblxuICAgICAgZG8ge1xuICAgICAgICBpZiAoIWlzTmFOKGVsZW0ub2Zmc2V0VG9wKSkge1xuICAgICAgICAgIG9mZnNldFRvcCArPSBlbGVtLm9mZnNldFRvcDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaXNOYU4oZWxlbS5vZmZzZXRMZWZ0KSkge1xuICAgICAgICAgIG9mZnNldExlZnQgKz0gZWxlbS5vZmZzZXRMZWZ0O1xuICAgICAgICB9XG4gICAgICB9IHdoaWxlICgoZWxlbSA9IGVsZW0ub2Zmc2V0UGFyZW50KSAhPT0gbnVsbCk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvcDogb2Zmc2V0VG9wLFxuICAgICAgICBsZWZ0OiBvZmZzZXRMZWZ0LFxuICAgICAgICBoZWlnaHQ6IG9mZnNldEhlaWdodCxcbiAgICAgICAgd2lkdGg6IG9mZnNldFdpZHRoXG4gICAgICB9O1xuICAgIH07IC8vIGdldEVsZW1JbmZvXG5cbiAgICAvKipcbiAgICAgKiBJZGVudGlmaWVzIHdoZXRoZXIgdGhlIGVsZW1lbnQgaXMgdmlzaWJsZSBpbiB0aGUgdmlld3BvcnQuXG4gICAgICogQHBhcmFtIEhUTUxFbGVtZW50IGVsZW1cbiAgICAgKiBAcmV0dXJuIGJvb2xlYW5cbiAgICAgKi9cbiAgICBjb25zdCBpc0VsZW1lbnRWaXNpYmxlID0gKGVsZW0pID0+IHtcbiAgICAgIGNvbnN0IHZpZXdwb3J0U2l6ZSA9IGdldFZpZXdwb3J0U2l6ZSgpO1xuICAgICAgY29uc3QgY3VycmVudFNjcm9sbCA9IGdldEN1cnJlbnRTY3JvbGwoKTtcbiAgICAgIGNvbnN0IGVJbmYgPSBnZXRFbGVtSW5mbyhlbGVtKTtcbiAgICAgIGNvbnN0IHNwYWNlT2Zmc2V0ID0gb3B0aW9ucy5yZXZlYWxTcGFjZU9mZnNldDtcblxuICAgICAgY29uc3QgY2hlY2tCb3VuZGFyaWVzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIFRoZSBlbGVtZW50IGJvdW5kYXJpZXNcbiAgICAgICAgY29uc3QgZVRvcCA9IGVJbmYudG9wICsgZUluZi5oZWlnaHQgKiBzcGFjZU9mZnNldDtcbiAgICAgICAgY29uc3QgZUxlZnQgPSBlSW5mLmxlZnQgKyBlSW5mLndpZHRoICogc3BhY2VPZmZzZXQ7XG4gICAgICAgIGNvbnN0IGVSaWdodCA9IGVJbmYubGVmdCArIGVJbmYud2lkdGggLSBlSW5mLndpZHRoICogc3BhY2VPZmZzZXQ7XG4gICAgICAgIGNvbnN0IGVCb3R0b20gPSBlSW5mLnRvcCArIGVJbmYuaGVpZ2h0IC0gZUluZi5oZWlnaHQgKiBzcGFjZU9mZnNldDtcblxuICAgICAgICAvLyBUaGUgd2luZG93IGJvdW5kYXJpZXNcbiAgICAgICAgY29uc3Qgd1RvcCA9IGN1cnJlbnRTY3JvbGwueSArIDA7XG4gICAgICAgIGNvbnN0IHdMZWZ0ID0gY3VycmVudFNjcm9sbC54ICsgMDtcbiAgICAgICAgY29uc3Qgd0JvdHRvbSA9IGN1cnJlbnRTY3JvbGwueSAtIDAgKyB2aWV3cG9ydFNpemUuaGVpZ2h0O1xuICAgICAgICBjb25zdCB3UmlnaHQgPSBjdXJyZW50U2Nyb2xsLnggLSAwICsgdmlld3BvcnRTaXplLndpZHRoO1xuXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBlbGVtZW50IGlzIHdpdGhpbiBib3VuZGFyeVxuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgIGVUb3AgPCB3Qm90dG9tICYmIGVCb3R0b20gPiB3VG9wICYmIGVMZWZ0ID4gd0xlZnQgJiYgZVJpZ2h0IDwgd1JpZ2h0XG4gICAgICAgICk7XG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gY2hlY2tCb3VuZGFyaWVzKCk7XG4gICAgfTsgLy8gaXNFbGVtZW50VmlzaWJsZVxuXG4gICAgLyoqXG4gICAgICogV2F0Y2ggdGhlIHRhcmdldCBlbGVtZW50cyB3aXRoIGEgbG9vcCB0byBpZGVudGlmeSB3aGljaCBvbmUgaXMgaW5zaWRlIHRoZSB2aWV3cG9ydC5cbiAgICAgKiBJZiBmb3VuZCwgdGhlIGVsZW1lbnQgZ2V0cyBhIGNsYXNzIGRlZmluZWQgaW4gdGhlIG9wdGlvbnMuXG4gICAgICogQHJldHVybiB2b2lkXG4gICAgICovXG4gICAgY29uc3QgdG9nZ2xlRWxlbWVudCA9ICgpID0+IHtcbiAgICAgIGlmICghcmV2ZWFsZXJzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXZlYWxlcnMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgaWYgKGlzRWxlbWVudFZpc2libGUocmV2ZWFsZXJzW2ldKSkge1xuICAgICAgICAgIGlmIChvcHRpb25zLnJldmVhbFdoZW5WaXNpYmxlKSB7XG4gICAgICAgICAgICByZXZlYWxlcnNbaV0uY2xhc3NMaXN0LmFkZChvcHRpb25zLnJldmVhbFdoZW5WaXNpYmxlKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAob3B0aW9ucy5yZXZlYWxXaGVuSGlkZGVuKSB7XG4gICAgICAgICAgICByZXZlYWxlcnNbaV0uY2xhc3NMaXN0LnJlbW92ZShvcHRpb25zLnJldmVhbFdoZW5IaWRkZW4pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICByZXZlYWxlcnNbaV0uY2xhc3NMaXN0LmNvbnRhaW5zKG9wdGlvbnMucmV2ZWFsU2luZ2xlQW5pbWF0aW9uKSA9PT1cbiAgICAgICAgICAgIGZhbHNlXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5yZXZlYWxXaGVuSGlkZGVuKSB7XG4gICAgICAgICAgICAgIHJldmVhbGVyc1tpXS5jbGFzc0xpc3QuYWRkKG9wdGlvbnMucmV2ZWFsV2hlbkhpZGRlbik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25zLnJldmVhbFdoZW5WaXNpYmxlKSB7XG4gICAgICAgICAgICAgIHJldmVhbGVyc1tpXS5jbGFzc0xpc3QucmVtb3ZlKG9wdGlvbnMucmV2ZWFsV2hlblZpc2libGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07IC8vIHRvZ2dsZUVsZW1lbnRcblxuICAgIC8qKlxuICAgICAqIEEgaGFuZGxlciBmb3Igc2Nyb2xsaW5nIGFuZCByZXNpemluZ1xuICAgICAqIEBwYXJhbSB3aW5kb3cuRXZlbnQgZXZ0XG4gICAgICogQHJldHVybiB2b2lkXG4gICAgICovXG4gICAgY29uc3Qgc2Nyb2xsUmVzaXplSGFuZGxlciA9IChldnQpID0+IHtcbiAgICAgIHRvZ2dsZUVsZW1lbnQoKTtcbiAgICB9O1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHNjcm9sbFJlc2l6ZUhhbmRsZXIsIGZhbHNlKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgc2Nyb2xsUmVzaXplSGFuZGxlciwgZmFsc2UpO1xuICB9OyAvLyBmbldhdGNoRWxlbWVudHNcblxuICB3aW5kb3cub2xkT25zY3JvbGwgPSB3aW5kb3cub25zY3JvbGw7XG4gIHdpbmRvdy5vbnNjcm9sbCA9IGZuU2Nyb2xsQ29tcGxldGU7XG5cbiAgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKTtcblxuICAvLyBGaW5kIGFsbCBleGlzdGluZyB0cmlnZ2VycyBmb3Igc21vb3RoIHNjcm9sbGluZ1xuICB0cmlnZ2VycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwob3B0aW9ucy5zcHlTY3JvbGxTZWxlY3Rvcik7XG5cbiAgLy8gRmluZCBhbGwgZXhpc3RpbmcgdGFyZ2V0cyBmb3Igd2F0Y2hpbmcgdGhlIHZpZXdwb3J0XG4gIHJldmVhbGVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwob3B0aW9ucy5yZXZlYWxFbGVtZW50U2VsZWN0b3IpO1xuXG4gIGlmICh0cmlnZ2VycyAhPT0gbnVsbCkge1xuICAgIHRyaWdnZXJzLmZvckVhY2goZnVuY3Rpb24odHJpZ2dlciwgaSkge1xuICAgICAgdHJpZ2dlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZuVHJpZ2dlckNsaWNrLCBmYWxzZSk7XG4gICAgfSk7IC8vIHRyaWdnZXJzLmZvckVhY2goZnVuY3Rpb24odHJpZ2dlciwgaSlcbiAgfSAvLyBpZiAodHJpZ2dlcnMgIT09IG51bGwpXG5cbiAgaWYgKHJldmVhbGVycykge1xuICAgIGZuV2F0Y2hFbGVtZW50cygpO1xuICB9XG5cbiAgcmV0dXJuIHt9O1xufTsgLy8gc2VlZFNjcm9sbFxuXG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgbW9kdWxlLmV4cG9ydHMuc2VlZFNjcm9sbCA9IHNlZWRTY3JvbGw7XG59XG5cbi8vIEV4cG9zZSBTZWVkQ1NTIGluIHRoZSBnbG9iYWwgc2NvcGVcbmlmICh0eXBlb2Ygd2luZG93LlNlZWRDU1MgPT09ICd1bmRlZmluZWQnKSB7XG4gIHdpbmRvdy5TZWVkQ1NTID0ge307XG59XG5cbi8vIEV4cG9zZSBzY3JvbGwgaW4gdGhlIGdsb2JhbCBzY29wZVxud2luZG93LlNlZWRDU1Muc2Nyb2xsID0gc2VlZFNjcm9sbDtcbiIsIi8qKiFcbiAqIFNlZWQtQ1NTIC0gQWRkaXRpb25hbCBmZWF0dXJlcyBmb3IgSFRNTCBUZXh0YXJlYXMuXG4gKiBAY29weXJpZ2h0IDIwMTksIEFidHogTGFic1xuICogQGxpY2Vuc2UgTUlUXG4gKi9cblxuY29uc3Qgc2VlZFRleHRhcmVhID0gZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcblxuICAvLyBGaW5kIGFsbCBzZWVkLWZpbGUgaW5wdXRzLlxuICBjb25zdCBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmllbGQgPiB0ZXh0YXJlYScpO1xuXG4gIGlmIChpbnB1dHMgIT09IG51bGwpIHtcbiAgICBpbnB1dHMuZm9yRWFjaChmdW5jdGlvbihpbnB1dCwgaSkge1xuICAgICAgbGV0IG1heExlbmd0aCA9IDA7XG5cbiAgICAgIGNvbnN0IHBhcmVudCA9IGlucHV0LnBhcmVudE5vZGU7XG4gICAgICBjb25zdCBjb3VudGVyTGFiZWwgPSBwYXJlbnQucXVlcnlTZWxlY3RvcignW3JvbGU9XCJjb3VudGVyXCJdJyk7XG4gICAgICBjb25zdCB0ZW1wbGF0ZSA9XG4gICAgICAgIGNvdW50ZXJMYWJlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdGVtcGxhdGUnKSB8fFxuICAgICAgICAnVHlwZWQgJWEgb3V0IG9mICViLiBSZW1haW5pbmcgJWMuJztcblxuICAgICAgY29uc3QgZm5DYWxjID0gKCkgPT4ge1xuICAgICAgICBjb25zdCB0eXBlZCA9IGlucHV0LnZhbHVlLnJlcGxhY2UoL1tcXG5cXHJdL2csICcnKS5sZW5ndGg7XG4gICAgICAgIGNvbnN0IHJlbWFpbmluZyA9IG1heExlbmd0aCAtIHR5cGVkO1xuICAgICAgICBjb25zdCBtaW5MZW5ndGggPSBNYXRoLmZsb29yKG1heExlbmd0aCAqIDAuMSk7XG5cbiAgICAgICAgY291bnRlckxhYmVsLmlubmVySFRNTCA9IHRlbXBsYXRlXG4gICAgICAgICAgLnJlcGxhY2UoJyVhJywgdHlwZWQpXG4gICAgICAgICAgLnJlcGxhY2UoJyViJywgbWF4TGVuZ3RoKVxuICAgICAgICAgIC5yZXBsYWNlKFxuICAgICAgICAgICAgJyVjJyxcbiAgICAgICAgICAgIHJlbWFpbmluZyA8PSBtaW5MZW5ndGhcbiAgICAgICAgICAgICAgPyBgPHNwYW4gY2xhc3M9XCJyZWRcIiA+JHtyZW1haW5pbmd9PC9zcGFuPmBcbiAgICAgICAgICAgICAgOiByZW1haW5pbmdcbiAgICAgICAgICApO1xuICAgICAgfTtcblxuICAgICAgbWF4TGVuZ3RoID0gaW5wdXQuZ2V0QXR0cmlidXRlKCdtYXhsZW5ndGgnKTtcblxuICAgICAgLy8gSWdub3JlIGlmIG1heGxlbmd0aCBpcyBub3QgZ2l2ZW5cbiAgICAgIGlmICghbWF4TGVuZ3RoKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gTWFrZSBzdXJlIHRoZSBsaW1pdCBpcyBhbiBpbnRlZ2VyXG4gICAgICBtYXhMZW5ndGggPSBwYXJzZUludChtYXhMZW5ndGgpO1xuXG4gICAgICAvLyBBdHRhY2ggdGhlIGhhbmRsZXJzXG4gICAgICAna2V5cHJlc3Mga2V5ZG93biBrZXl1cCcuc3BsaXQoJyAnKS5mb3JFYWNoKChldnQpID0+IHtcbiAgICAgICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihldnQsIGZuQ2FsYywgdHJ1ZSk7XG4gICAgICB9KTtcblxuICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgdXRpbGl0eSBsYWJlbFxuICAgICAgZm5DYWxjKCk7XG4gICAgfSk7IC8vIGlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uKGlucHV0LCBpKVxuICB9IC8vIGlmIChpbnB1dHMgIT09IG51bGwpXG59OyAvLyBzZWVkVGV4dGFyZWFcblxuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gIG1vZHVsZS5leHBvcnRzLnNlZWRUZXh0YXJlYSA9IHNlZWRUZXh0YXJlYTtcbn1cblxuLy8gRXhwb3NlIFNlZWRDU1MgaW4gdGhlIGdsb2JhbCBzY29wZVxuaWYgKHR5cGVvZiB3aW5kb3cuU2VlZENTUyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgd2luZG93LlNlZWRDU1MgPSB7fTtcbn1cblxuLy8gRXhwb3NlIHRleHRBcmVhIGluIHRoZSBnbG9iYWwgc2NvcGVcbndpbmRvdy5TZWVkQ1NTLnRleHRBcmVhID0gc2VlZFRleHRhcmVhO1xuIl19
